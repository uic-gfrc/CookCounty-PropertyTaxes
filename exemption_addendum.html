<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Property Taxes in Cook County - Exemption Addendum</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./incentive_report_content.html" rel="next">
<link href="./exemption_report_2021.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Property Taxes in Cook County</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/AleaWM/CookCounty-PropertyTaxes.git"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./exemption_report_2021.html">Reports</a></li><li class="breadcrumb-item"><a href="./exemption_addendum.html"><span class="chapter-title">Exemption Addendum</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Background Information</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Reports</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exemption_report_2021.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Exemptions in Cook County - Tax Year 2021</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exemption_addendum.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Exemption Addendum</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./incentive_report_content.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Incentive Classifications</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Additional Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exemption_report_2023update.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Exemptions in Cook County - Tax Year 2023</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#which-taxpayers-benefit-the-most-from-homestead-exemptions" id="toc-which-taxpayers-benefit-the-most-from-homestead-exemptions" class="nav-link active" data-scroll-target="#which-taxpayers-benefit-the-most-from-homestead-exemptions">Which taxpayers benefit the most from homestead exemptions?</a>
  <ul class="collapse">
  <li><a href="#table-1.-comparison-of-tax-bills-for-median-assessed-value-av-class-2-properties-in-selected-municpalities-under-the-status-quo-and-alternative-scenario" id="toc-table-1.-comparison-of-tax-bills-for-median-assessed-value-av-class-2-properties-in-selected-municpalities-under-the-status-quo-and-alternative-scenario" class="nav-link" data-scroll-target="#table-1.-comparison-of-tax-bills-for-median-assessed-value-av-class-2-properties-in-selected-municpalities-under-the-status-quo-and-alternative-scenario">Table 1. Comparison of Tax Bills for Median Assessed Value (AV) Class 2 Properties in Selected Municpalities under the Status Quo and Alternative Scenario</a></li>
  <li><a href="#figure-1.-examples-of-actual-tax-bills" id="toc-figure-1.-examples-of-actual-tax-bills" class="nav-link" data-scroll-target="#figure-1.-examples-of-actual-tax-bills">Figure 1. Examples of Actual Tax Bills</a></li>
  <li><a href="#figure-2.-value-of-median-residential-property-indifferent-to-elimination-of-ghe" id="toc-figure-2.-value-of-median-residential-property-indifferent-to-elimination-of-ghe" class="nav-link" data-scroll-target="#figure-2.-value-of-median-residential-property-indifferent-to-elimination-of-ghe">Figure 2. Value of Median Residential Property Indifferent to Elimination of GHE</a></li>
  </ul></li>
  <li><a href="#how-progressive-are-exemptions" id="toc-how-progressive-are-exemptions" class="nav-link" data-scroll-target="#how-progressive-are-exemptions">How progressive are exemptions?</a>
  <ul class="collapse">
  <li><a href="#figure-3.-ratio-of-tax-bills-to-av-for-25th-and-75th-percentile-av-class-2-properties-with-10000-ghe" id="toc-figure-3.-ratio-of-tax-bills-to-av-for-25th-and-75th-percentile-av-class-2-properties-with-10000-ghe" class="nav-link" data-scroll-target="#figure-3.-ratio-of-tax-bills-to-av-for-25th-and-75th-percentile-av-class-2-properties-with-10000-ghe">Figure 3. Ratio of Tax Bills to AV for 25th and 75th Percentile AV Class 2 Properties with $10,000 GHE</a></li>
  </ul></li>
  <li><a href="#what-would-happen-if-the-ghe-value-were-increased" id="toc-what-would-happen-if-the-ghe-value-were-increased" class="nav-link" data-scroll-target="#what-would-happen-if-the-ghe-value-were-increased">What would happen if the GHE value were increased?</a>
  <ul class="collapse">
  <li><a href="#figure-4.-effect-of-changing-the-ghe-on-progressivity" id="toc-figure-4.-effect-of-changing-the-ghe-on-progressivity" class="nav-link" data-scroll-target="#figure-4.-effect-of-changing-the-ghe-on-progressivity">Figure 4. Effect of Changing the GHE on Progressivity</a></li>
  <li><a href="#table-3.-revenue-neutral-tax-rates" id="toc-table-3.-revenue-neutral-tax-rates" class="nav-link" data-scroll-target="#table-3.-revenue-neutral-tax-rates">Table 3. Revenue Neutral Tax Rates</a></li>
  <li><a href="#figure-5.-ghe-value-and-revenue-neutral-tax-rates" id="toc-figure-5.-ghe-value-and-revenue-neutral-tax-rates" class="nav-link" data-scroll-target="#figure-5.-ghe-value-and-revenue-neutral-tax-rates">Figure 5. GHE Value and Revenue Neutral Tax Rates</a></li>
  </ul></li>
  <li><a href="#paying-for-the-inequitable-effects-of-exemptions" id="toc-paying-for-the-inequitable-effects-of-exemptions" class="nav-link" data-scroll-target="#paying-for-the-inequitable-effects-of-exemptions">Paying for the inequitable effects of exemptions</a>
  <ul class="collapse">
  <li><a href="#figure-6.-exemptions-by-value-in-class-8-municipalities" id="toc-figure-6.-exemptions-by-value-in-class-8-municipalities" class="nav-link" data-scroll-target="#figure-6.-exemptions-by-value-in-class-8-municipalities">Figure 6. Exemptions by Value in Class 8 Municipalities</a></li>
  <li><a href="#figure-7.-exemption-share-in-class-8-municipalities" id="toc-figure-7.-exemption-share-in-class-8-municipalities" class="nav-link" data-scroll-target="#figure-7.-exemption-share-in-class-8-municipalities">Figure 7. Exemption Share in Class 8 Municipalities</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./exemption_report_2021.html">Reports</a></li><li class="breadcrumb-item"><a href="./exemption_addendum.html"><span class="chapter-title">Exemption Addendum</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">Exemption Addendum</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ptaxsim)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">"C:/Users/aleaw/"</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>taxyear <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">2021</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>taxyear <span class="ot">=</span> <span class="fu">as.data.frame</span>(taxyear)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../scripts/helper_tc_muninames.R"</span>) </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>tc_muninames <span class="ot">&lt;-</span> tc_muninames <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>tax_code_rate)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#ptaxsim_db_conn &lt;- DBI::dbConnect(RSQLite::SQLite(), "./ptaxsim.db/ptaxsim-2023.0.0.db")</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(file_path)){</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>   ptaxsim_db_conn <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">"C:/Users/aleaw/OneDrive/Documents/PhD Fall 2021 - Spring 2022/Merriman RA/ptax/ptaxsim.db/ptaxsim-2023.0.0.db"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    ptaxsim_db_conn <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">"./ptaxsim.db/ptaxsim-2023.0.0.db"</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>current_dir <span class="ot">=</span> <span class="fu">getwd</span>()</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"Website"</span>, current_dir)) {</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  dots <span class="ot">=</span> <span class="st">"../"</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  dots <span class="ot">=</span> <span class="st">"./"</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dots, <span class="st">"Necessary_Files/class_dict_singlefamcodes.csv"</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>class_dict <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">class_code =</span> <span class="fu">as.character</span>(class_code)) <span class="co"># change variable type to character so the join works.</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dots, <span class="st">"inputs/ccao_loa.csv"</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>ccao_loa <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">class_code =</span> <span class="fu">as.character</span>(class_code))</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>eq_factor <span class="ot">=</span> <span class="fl">3.0027</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># get all tax codes and tax rates</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>tax_codes <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbGetQuery</span>(</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    ptaxsim_db_conn, </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue_sql</span>(<span class="st">"</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="st">             SELECT DISTINCT tax_code_num, tax_code_rate</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM tax_code</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="st">             WHERE year = 2021</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="st">             "</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>             , </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>             <span class="at">.con =</span> ptaxsim_db_conn)) <span class="sc">|&gt;</span> </span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tax_code_rate =</span> tax_code_rate <span class="sc">/</span> <span class="dv">100</span>)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co"># get percent of eav that goes to a TIF:</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>tif_distribution <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbGetQuery</span>(</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    ptaxsim_db_conn, </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue_sql</span>(<span class="st">"</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="st">             SELECT DISTINCT* </span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM tif_distribution</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="st">             WHERE year = 2021</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="st">             "</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>             , </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>             <span class="at">.con =</span> ptaxsim_db_conn)) <span class="sc">%&gt;%</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(tax_code_rate, agency_num)) <span class="sc">|&gt;</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tax_code_distribution_pct =</span> tax_code_distribution_pct <span class="sc">/</span> <span class="dv">100</span>)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="co"># All PINs - get AV and exemption amounts -----------------------------</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Include ALL PINs for calculating muni level composite rates:</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>cook_pins <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbGetQuery</span>(</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    ptaxsim_db_conn, </span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue_sql</span>(<span class="st">"</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="st">             SELECT DISTINCT* </span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM pin </span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="st">             WHERE year = 2021</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a><span class="st">             "</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>             , </span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>             <span class="at">.con =</span> ptaxsim_db_conn)) </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="co"># create some variables that we need:</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>muni_rates <span class="ot">&lt;-</span> cook_pins <span class="sc">|&gt;</span> </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tax_codes) <span class="sc">|&gt;</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tc_muninames) <span class="sc">|&gt;</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tif_distribution) <span class="sc">|&gt;</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">tax_code_distribution_pct =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(tax_code_distribution_pct), <span class="dv">0</span>, tax_code_distribution_pct),</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">in_tif =</span> <span class="fu">ifelse</span>(tax_code_num <span class="sc">%in%</span> tif_distribution<span class="sc">$</span>tax_code_num, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_HO_exe =</span> <span class="fu">ifelse</span>(exe_homeowner <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_other_exe =</span> <span class="fu">ifelse</span>(exe_senior <span class="sc">+</span> exe_freeze <span class="sc">+</span> exe_longtime_homeowner <span class="sc">+</span> exe_disabled <span class="sc">+</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>                             exe_vet_returning <span class="sc">+</span> exe_vet_dis_lt50 <span class="sc">+</span> exe_vet_dis_50_69 <span class="sc">+</span> exe_vet_dis_ge70 <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span> ),</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_tax_to_tif =</span> tax_bill_total <span class="sc">*</span>  tax_code_distribution_pct,   <span class="co"># TIF revenue</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_tax_to_dist =</span> tax_bill_total <span class="sc">-</span> final_tax_to_tif,      <span class="co"># local government revenue</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>   <span class="at">all_exemptions =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"exe_"</span>))),</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>     <span class="at">tif_increment_eav =</span> final_tax_to_tif <span class="sc">/</span> tax_code_rate,</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>     <span class="at">nontif_eav_preexe =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> tif_increment_eav,</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>     <span class="at">nontif_eav_postexe =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> tif_increment_eav <span class="sc">-</span> all_exemptions,</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">current_taxbase =</span> final_tax_to_dist <span class="sc">/</span> tax_code_rate, <span class="co"># should match nontif_eav_postexe amount</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">eav_postexemptions =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> all_exemptions, <span class="co"># ignores tif distribution</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">eav_preexemptions =</span> av_clerk<span class="sc">*</span>eq_factor, <span class="co"># ignores tif distribution</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">av =</span> av_clerk)  <span class="sc">|&gt;</span> <span class="co"># av used for calculations is the final av value from the clerk's office</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name)<span class="sc">|&gt;</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">tax_bill_total =</span> <span class="fu">sum</span>(tax_bill_total), <span class="co"># TIF and local government revenue</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">tif_increment_eav =</span> <span class="fu">sum</span>(tif_increment_eav, <span class="at">na.rm=</span>T),  <span class="co"># should be sum of frozen EAV</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">muni_taxed_eav =</span> <span class="fu">sum</span>(nontif_eav_postexe, <span class="at">na.rm=</span>T),  <span class="co"># non-TIF and non-exempt EAV taxed by government agencies</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">muni_exempt_eav_from_GHE =</span> <span class="fu">sum</span>(exe_homeowner, <span class="at">na.rm=</span>T),</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">muni_levy =</span> <span class="fu">sum</span>(final_tax_to_dist, <span class="at">na.rm=</span>T),</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">muni_min_rate =</span> <span class="fu">min</span>(tax_code_rate),</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">muni_median_rate =</span> <span class="fu">median</span>(tax_code_rate),</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">muni_avg_rate =</span> <span class="fu">mean</span>(tax_code_rate, <span class="at">na.rm=</span>T),</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">muni_max_rate =</span> <span class="fu">max</span>(tax_code_rate),</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_tax_to_dist =</span> <span class="fu">sum</span>(final_tax_to_dist, <span class="at">na.rm=</span>T),</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_tax_to_tif =</span> <span class="fu">sum</span>(final_tax_to_tif, <span class="at">na.rm=</span>T)) <span class="sc">|&gt;</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">muni_hyp_taxbase =</span> muni_taxed_eav <span class="sc">+</span> muni_exempt_eav_from_GHE,   </span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>         <span class="at">muni_hyp_taxrate =</span>  muni_levy <span class="sc">/</span> muni_hyp_taxbase)</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a><span class="do">## Tax code level "levies" and tax bases ----------------</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>tax_code_change <span class="ot">&lt;-</span> cook_pins <span class="sc">|&gt;</span>  </span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tax_codes) <span class="sc">|&gt;</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tc_muninames) <span class="sc">|&gt;</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tif_distribution) <span class="sc">|&gt;</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">tax_code_distribution_pct =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(tax_code_distribution_pct), <span class="dv">0</span>, tax_code_distribution_pct),</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">in_tif =</span> <span class="fu">ifelse</span>(tax_code_num <span class="sc">%in%</span> tif_distribution<span class="sc">$</span>tax_code_num, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_HO_exe =</span> <span class="fu">ifelse</span>(exe_homeowner <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_other_exe =</span> <span class="fu">ifelse</span>(exe_senior <span class="sc">+</span> exe_freeze <span class="sc">+</span> exe_longtime_homeowner <span class="sc">+</span> exe_disabled <span class="sc">+</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>                             exe_vet_returning <span class="sc">+</span> exe_vet_dis_lt50 <span class="sc">+</span> exe_vet_dis_50_69 <span class="sc">+</span> </span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>                             exe_vet_dis_ge70 <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span> ),</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_exemptions =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"exe_"</span>))),</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_tax_to_tif =</span> tax_bill_total <span class="sc">*</span>  tax_code_distribution_pct<span class="sc">/</span><span class="dv">100</span>,</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_tax_to_dist =</span> tax_bill_total <span class="sc">-</span> final_tax_to_tif,</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">tif_increment_eav =</span> final_tax_to_tif <span class="sc">/</span> tax_code_rate,</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">nontif_eav_preexe =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> tif_increment_eav,</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>     <span class="at">nontif_eav_postexe =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> tif_increment_eav <span class="sc">-</span> all_exemptions,</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">eav_postexemptions =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> all_exemptions,</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">eav_preexemptions =</span> av_clerk<span class="sc">*</span>eq_factor,</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_bill =</span> final_tax_to_tif <span class="sc">+</span> final_tax_to_dist</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name, tax_code_num, tax_code_rate) <span class="sc">|&gt;</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">tc_pc =</span> <span class="fu">n</span>(),</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">tc_tax_bill_total =</span> <span class="fu">sum</span>(tax_bill_total), <span class="co"># TIF and local government revenue at tax code level</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>    <span class="at">tc_eav_inTIF =</span> <span class="fu">sum</span>(tif_increment_eav, <span class="at">na.rm=</span>T),  <span class="co"># should be sum of frozen EAV</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>    <span class="at">tc_taxed_eav =</span> <span class="fu">sum</span>(nontif_eav_postexe, <span class="at">na.rm=</span>T),  <span class="co"># non-TIF and non-exempt EAV taxed by government agencies</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">tc_exempt_eav_from_GHE =</span> <span class="fu">sum</span>(exe_homeowner, <span class="at">na.rm=</span>T),</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">tc_final_tax_to_dist =</span> <span class="fu">sum</span>(final_tax_to_dist, <span class="at">na.rm=</span>T),</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>    <span class="at">tc_final_tax_to_tif =</span> <span class="fu">sum</span>(final_tax_to_tif, <span class="at">na.rm=</span>T)) <span class="sc">|&gt;</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tc_hyp_taxbase =</span> tc_taxed_eav <span class="sc">+</span> tc_exempt_eav_from_GHE,   </span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>         <span class="at">tc_hyp_taxrate =</span>  tc_final_tax_to_dist <span class="sc">/</span> tc_hyp_taxbase)</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify Class 2 Residential PINs ------------- </span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>c2pins <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbGetQuery</span>(</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>  ptaxsim_db_conn, </span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue_sql</span>(<span class="st">"</span></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a><span class="st">             SELECT DISTINCT* </span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a><span class="st">             FROM pin </span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a><span class="st">             WHERE class &gt; 199 AND class &lt; 300</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a><span class="st">             AND year = 2021</span></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a><span class="st">             "</span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>           , </span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>           <span class="at">.con =</span> ptaxsim_db_conn))</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>c2pins <span class="ot">&lt;-</span> c2pins <span class="sc">|&gt;</span> </span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">has_HO_exe =</span> <span class="fu">ifelse</span>( exe_homeowner <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>         <span class="at">has_other_exe =</span> <span class="fu">ifelse</span>(exe_senior <span class="sc">+</span> exe_freeze <span class="sc">+</span> exe_longtime_homeowner <span class="sc">+</span> exe_disabled <span class="sc">+</span> exe_vet_returning <span class="sc">+</span> exe_vet_dis_lt50 <span class="sc">+</span> exe_vet_dis_50_69 <span class="sc">+</span> exe_vet_dis_ge70 <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tax_codes) <span class="sc">|&gt;</span></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tc_muninames) <span class="sc">%&gt;%</span></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">av =</span> av_clerk) <span class="sc">|&gt;</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tax_code_change) <span class="sc">|&gt;</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tif_distribution) <span class="sc">|&gt;</span></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">tax_code_distribution_pct =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(tax_code_distribution_pct), <span class="dv">0</span>, tax_code_distribution_pct),</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">in_tif =</span> <span class="fu">ifelse</span>(tax_code_num <span class="sc">%in%</span> tif_distribution<span class="sc">$</span>tax_code_num, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_HO_exe =</span> <span class="fu">ifelse</span>(exe_homeowner <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_other_exe =</span> <span class="fu">ifelse</span>(exe_senior <span class="sc">+</span> exe_freeze <span class="sc">+</span> exe_longtime_homeowner <span class="sc">+</span> exe_disabled <span class="sc">+</span></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>                             exe_vet_returning <span class="sc">+</span> exe_vet_dis_lt50 <span class="sc">+</span> exe_vet_dis_50_69 <span class="sc">+</span> </span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>                             exe_vet_dis_ge70 <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span> ),</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_exemptions =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"exe_"</span>))),</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_tax_to_tif =</span> tax_bill_total <span class="sc">*</span>  tax_code_distribution_pct<span class="sc">/</span><span class="dv">100</span>,</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_tax_to_dist =</span> tax_bill_total<span class="sc">-</span>final_tax_to_tif,</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>    <span class="at">tif_increment_eav =</span> final_tax_to_tif <span class="sc">/</span> tax_code_rate,</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">nontif_eav_preexe =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> tif_increment_eav,</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>    <span class="at">nontif_eav_postexe =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> tif_increment_eav <span class="sc">-</span> all_exemptions,</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>    <span class="at">eav_postexemptions =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> all_exemptions,</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>    <span class="at">eav_preexemptions =</span> av_clerk<span class="sc">*</span>eq_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>q <span class="ot">=</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>, .<span class="dv">9</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ranks properties that are considered C2 properties in order of AV for each Muni</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>muni_quartiles <span class="ot">&lt;-</span> c2pins <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(av) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count_pins =</span> <span class="fu">n</span>(), </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(av),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">quant10 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(av, <span class="at">probs =</span> q[<span class="dv">1</span>])), </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">quant25 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(av, <span class="at">probs =</span> q[<span class="dv">2</span>])), </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">quant50 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(av, <span class="at">probs =</span> q[<span class="dv">3</span>])),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">quant75 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(av, <span class="at">probs =</span> q[<span class="dv">4</span>])),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">quant90 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(av, <span class="at">probs =</span> q[<span class="dv">5</span>])),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(av)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">%&gt;%</span> </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(quant50))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Class 2 Descriptive Stats </span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>C2_munistats <span class="ot">&lt;-</span> c2pins <span class="sc">%&gt;%</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">&gt;</span> <span class="dv">199</span> <span class="sc">&amp;</span> class <span class="sc">&lt;</span> <span class="dv">300</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name)  <span class="sc">%&gt;%</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(av) <span class="sc">%&gt;%</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_eav =</span> <span class="fu">round</span>(<span class="fu">median</span>(eav_postexemptions)), </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_av =</span> <span class="fu">round</span>(<span class="fu">median</span>(av)), </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_av =</span> <span class="fu">round</span>(<span class="fu">mean</span>(av)),</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_eav =</span> <span class="fu">round</span>(<span class="fu">mean</span>(eav_postexemptions)),</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">C2_pins_in_muni =</span> <span class="fu">n</span>(),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">C2_current_exemptions =</span> <span class="fu">sum</span>(all_exemptions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">C2_HO_exemps =</span> <span class="fu">sum</span>(exe_homeowner, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co"># All Class 2 Properties</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>munis_ranked <span class="ot">&lt;-</span> c2pins  <span class="sc">%&gt;%</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(muni_quartiles, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"clean_name"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>   av <span class="sc">&gt;</span> (quant10<span class="dv">-500</span>) <span class="sc">&amp;</span> (av<span class="sc">&lt;</span>quant10<span class="sc">+</span><span class="dv">500</span>) <span class="sc">~</span> <span class="st">"q10"</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    av <span class="sc">&gt;</span> (quant25<span class="dv">-500</span>) <span class="sc">&amp;</span> (av<span class="sc">&lt;</span>quant25<span class="sc">+</span><span class="dv">500</span>) <span class="sc">~</span> <span class="st">"q25"</span>,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    av <span class="sc">&gt;</span> (quant50<span class="dv">-500</span>) <span class="sc">&amp;</span> (av<span class="sc">&lt;</span>quant50<span class="sc">+</span><span class="dv">500</span>) <span class="sc">~</span> <span class="st">"q50"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    av <span class="sc">&gt;</span> (quant75<span class="dv">-500</span>) <span class="sc">&amp;</span> (av<span class="sc">&lt;</span>quant75<span class="sc">+</span><span class="dv">500</span>) <span class="sc">~</span> <span class="st">"q75"</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    av <span class="sc">&gt;</span> (quant90<span class="dv">-500</span>) <span class="sc">&amp;</span> (av<span class="sc">&lt;</span>quant90<span class="sc">+</span><span class="dv">500</span>) <span class="sc">~</span> <span class="st">"q90"</span>)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(clean_name, rank, av, pin, class, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="which-taxpayers-benefit-the-most-from-homestead-exemptions" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="which-taxpayers-benefit-the-most-from-homestead-exemptions">Which taxpayers benefit the most from homestead exemptions?</h2>
<section id="table-1.-comparison-of-tax-bills-for-median-assessed-value-av-class-2-properties-in-selected-municpalities-under-the-status-quo-and-alternative-scenario" class="level3">
<h3 class="anchored" data-anchor-id="table-1.-comparison-of-tax-bills-for-median-assessed-value-av-class-2-properties-in-selected-municpalities-under-the-status-quo-and-alternative-scenario">Table 1. Comparison of Tax Bills for Median Assessed Value (AV) Class 2 Properties in Selected Municpalities under the Status Quo and Alternative Scenario</h3>
<p>Assessed Value is used to identify the quartile breaks within each municipality for single-family properties. These break points will then be used to look at how the tax bill changes for properties with AVs at the 25th percentile, 50th percentile, and 75th percentile.</p>
<p>The assessed value and original equalized assessed values come from the <code>pin</code> data table within PTAXSIM. This table also has every type of exemption that the property received and the amount of EAV that was exempt due to the exemption.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tax_bill_change_HO <span class="ot">&lt;-</span> c2pins <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(av <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(av) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eq_av =</span> av_clerk<span class="sc">*</span>eq_factor,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_current =</span> (eav_postexemptions<span class="sc">*</span>tax_code_rate),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_noexemps =</span>  tc_hyp_taxrate<span class="sc">*</span>(eav_postexemptions<span class="sc">+</span>exe_homeowner),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_change =</span> bill_noexemps <span class="sc">-</span> bill_current) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name, has_HO_exe) <span class="sc">%&gt;%</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_AV =</span> <span class="fu">median</span>(av),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_EAV =</span> <span class="fu">median</span>(eav_postexemptions),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_bill_cur =</span> <span class="fu">round</span>(<span class="fu">median</span>(bill_current)),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_bill_new =</span> <span class="fu">round</span>(<span class="fu">median</span>(bill_noexemps)),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_change =</span> <span class="fu">round</span>(<span class="fu">median</span>(bill_change)),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">pincount=</span><span class="fu">n</span>(),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">perceived_savings =</span> <span class="fu">median</span>(exe_homeowner<span class="sc">*</span>tax_code_rate)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>tax_bill_change_HO <span class="sc">|&gt;</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Phoenix"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Riverdale"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-taxbillchange" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-taxbillchange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.1: <strong>Figure 2</strong> The median property was found for all Class 2 properties and used to calculate the hypothetical tax bill change for those that do and do not claim the GHE. It is important to note that almost all municipalities have a median AV for those that do claim the GHE that is quite different from those that do not claim the GHE.
</figcaption>
<div aria-describedby="tbl-taxbillchange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["clean_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["has_HO_exe"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["median_AV"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["median_EAV"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["median_bill_cur"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["median_bill_new"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["median_change"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["pincount"],"name":[8],"type":["int"],"align":["right"]},{"label":["perceived_savings"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"Park Forest","2":"0","3":"5704","4":"17125.9","5":"7511","6":"5308","7":"-2203","8":"1840","9":"0.0"},{"1":"Park Forest","2":"1","3":"6968","4":"7611.8","5":"3311","6":"5397","7":"1954","8":"3436","9":"4394.3"},{"1":"Phoenix","2":"0","3":"2000","4":"6006.9","5":"1799","6":"1232","7":"-566","8":"522","9":"0.0"},{"1":"Phoenix","2":"1","3":"3668","4":"884.7","5":"265","6":"2051","7":"1636","8":"474","9":"2995.4"},{"1":"Riverdale","2":"0","3":"5534","4":"16616.9","5":"5201","6":"3268","7":"-1257","8":"1544","9":"0.0"},{"1":"Riverdale","2":"1","3":"6056","4":"6635.0","5":"2082","6":"3229","7":"1197","8":"2391","9":"3137.5"},{"1":"Winnetka","2":"0","3":"71071","4":"213404.9","5":"18652","6":"18206","7":"-448","8":"1316","9":"0.0"},{"1":"Winnetka","2":"1","3":"85823","4":"245685.9","5":"21252","6":"21583","7":"326","8":"3162","9":"864.3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
<p><em>The table created from the code calculates the median AV for those with exemptions and those without exemptions. Usually these values are significantly different. In the Report, the table was simplified to show the save assessed value for both types of homeowners (See image of table pasted below).</em></p>
<p><img src="images/clipboard-3760892845.png" class="img-fluid"></p>
<p><em>Notes: AV = Assessed Value. Tax Calculator reduction refers to the section of the tax bill received by property tax payers (See Figure 1). It does not take into account changes in property tax rates due to the larger taxbase that would come from having a larger tax base. Figures in columns titled Current Bill, Tax Bill without GHE, and Tax Calculator Reduction in Tax Liability are estimated using an average of the properties with AV within $1,000 of the municipality median in order to enlarge the number of observations therefore do not precisely represent the median figure.</em></p>
</section>
<section id="figure-1.-examples-of-actual-tax-bills" class="level3">
<h3 class="anchored" data-anchor-id="figure-1.-examples-of-actual-tax-bills">Figure 1. Examples of Actual Tax Bills</h3>
<p><strong>Park Forest vs.&nbsp;Winnetka</strong></p>
<p><img src="images/clipboard-3418026779.png" class="img-fluid" width="300"></p>
<p><img src="images/clipboard-3189035135.png" class="img-fluid" width="300"></p>
</section>
<section id="figure-2.-value-of-median-residential-property-indifferent-to-elimination-of-ghe" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="figure-2.-value-of-median-residential-property-indifferent-to-elimination-of-ghe">Figure 2. Value of Median Residential Property Indifferent to Elimination of GHE</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>muni_breakeven_points <span class="ot">&lt;-</span> c2pins <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(muni_rates) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(exe_homeowner <span class="sc">==</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(exe_senior <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>           exe_freeze <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>           exe_longtime_homeowner <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>           exe_disabled <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>           exe_vet_returning <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>           exe_vet_dis_lt50 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>           exe_vet_dis_50_69 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>           exe_vet_dis_ge70 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>           exe_abate <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_AV =</span> <span class="fu">median</span>(av),     <span class="co"># median class 2 AV for properties that did claim the GHE but not other exemptions</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_current =</span> <span class="fu">mean</span>(eav_postexemptions <span class="sc">*</span> tax_code_rate), <span class="co"># money collected by non-TIF agencies</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_noGHE =</span> <span class="fu">mean</span>(tc_hyp_taxrate <span class="sc">*</span> (eav_postexemptions<span class="sc">+</span>exe_homeowner)), <span class="co"># this uses tax code tax rate</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_change =</span> <span class="fu">mean</span>(tax_code_rate <span class="sc">-</span> tc_hyp_taxrate),   <span class="co"># avg tax code level rate change </span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">muni_avg_rate_change =</span> <span class="fu">mean</span>(muni_avg_rate <span class="sc">-</span> muni_hyp_taxrate),</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">nobillchange_propertyEAV =</span> <span class="fu">round</span>(<span class="fu">mean</span>(exe_homeowner <span class="sc">*</span> </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>                                            (tax_code_rate <span class="sc">/</span> (tax_code_rate<span class="sc">-</span>tc_hyp_taxrate)))), <span class="co">#   </span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">nobillchange_propertyEAV_muni =</span> <span class="fu">round</span>(<span class="fu">mean</span>(exe_homeowner <span class="sc">*</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>                                                 (muni_avg_rate<span class="sc">/</span>(muni_avg_rate<span class="sc">-</span>muni_hyp_taxrate) )))</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nochange_av =</span> nobillchange_propertyEAV <span class="sc">/</span> eq_factor,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">nochange_av_muni =</span> nobillchange_propertyEAV_muni<span class="sc">/</span> eq_factor,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>         ) </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>muni_breakeven_points <span class="sc">%&gt;%</span>       </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>,<span class="st">"Park Forest"</span>, <span class="st">"Phoenix"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Winnetka"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>median_AV, <span class="at">x =</span> clean_name)) <span class="sc">+</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y=</span>median_AV <span class="sc">+</span> <span class="dv">3000</span>, <span class="at">label =</span> <span class="fu">round</span>(median_AV) ) ) <span class="sc">+</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>,<span class="st">"Park Forest"</span>, <span class="st">"Phoenix"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Winnetka"</span>)) <span class="sc">+</span> </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Median Residential AV"</span>, <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Median Residential Property Assessed Value - All Class 2 property Types"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exemption_addendum_files/figure-html/create-muni_breakeven_points-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>muni_breakeven_points <span class="sc">%&gt;%</span>       </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>,<span class="st">"Park Forest"</span>, <span class="st">"Phoenix"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Winnetka"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>nochange_av, <span class="at">x =</span> clean_name)) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y=</span>nochange_av <span class="sc">+</span> <span class="dv">3000</span>, <span class="at">label =</span> <span class="fu">round</span>(nochange_av)) ) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>, <span class="st">"Park Forest"</span>, <span class="st">"Phoenix"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Winnetka"</span>)) <span class="sc">+</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Breakeven Point - AV"</span>, <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Residential Property AV Breakeven Point"</span>, </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Residential properties above these values would have their bills decrease if the GHE were eliminated</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="st">       (if they had claimed the GHE before)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exemption_addendum_files/figure-html/create-muni_breakeven_points-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|include: false</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Doesn't make bars / doesn't work. idk why ?? I don't need it, I just don't know why it doesn't work. </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>muni_breakeven_points <span class="sc">%&gt;%</span>       </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>,<span class="st">"Park Forest"</span>, <span class="st">"Phoenix"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Winnetka"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>nochange_av_muni, <span class="at">x =</span> clean_name)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y=</span>nochange_av_muni <span class="sc">+</span> <span class="dv">3000</span>, <span class="at">label =</span> <span class="fu">round</span>(nochange_av_muni)) ) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>, <span class="st">"Park Forest"</span>, <span class="st">"Phoenix"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Winnetka"</span>)) <span class="sc">+</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Breakeven Point - AV"</span>, <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Residential Property AV Breakeven Point"</span>, </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Residential properties above these values would have their bills decrease if the GHE were eliminated</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="st">       (if they had claimed the GHE before)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exemption_addendum_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>muni_breakeven_points <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># filter(nochange_av &lt; 300000) %&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>nochange_av, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> median_AV, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">label=</span>clean_name</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>             )) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_smooth(method = "lm" )+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> (nochange_av<span class="dv">-5000</span>), <span class="at">x =</span> (median_AV)), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">" Breakeven Point"</span>, </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Median AV - Class 2 Properties in Municipality"</span>, </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># title = "Some highly valued homes would have lower tax bills if the GHE were eliminated", </span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>       <span class="co">#caption = "The breakeven point is the assessed values at which a major class 2 </span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>     <span class="co">#  property would not have their taxbill change if the GHE were eliminated."</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-breakevenToAV-notfiltered" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-breakevenToAV-notfiltered-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Includes all municipalities
</figcaption>
<div aria-describedby="fig-breakevenToAV-notfiltered-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="exemption_addendum_files/figure-html/fig-breakevenToAV-notfiltered-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div></div></div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>muni_breakeven_points <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nochange_av <span class="sc">&lt;</span> <span class="dv">300000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>nochange_av, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> median_AV, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">label=</span>clean_name</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>             )) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> (muni_breakeven_points <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Riverdale"</span>,<span class="st">"Dolton"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> nochange_av, <span class="at">x =</span> median_AV, <span class="at">color =</span> <span class="st">"red"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">data =</span> (muni_breakeven_points <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> (nochange_av), <span class="at">x =</span> (median_AV)), <span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">170000</span>) ) <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">170000</span>) ) <span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Municipalities' Median AV &amp; Breakeven Point </span><span class="sc">\n</span><span class="st">Class 2 Properties Only"</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Breakeven Point"</span>, </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Median AV"</span>, </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a> <span class="co"># caption = "The breakeven point is the assessed values at which a major class 2 property would not have their taxbill change if the </span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a> <span class="co"># GHE were eliminated. Excludes outliers: University Park, Bedford Park, McCook, Hodgkins, and Rosemont. Class 2 properties that had</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a> <span class="co"># claimed the GHE would have lower taxbills even if the GHE were removed if the AV is above the breakeven point."</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a> ) <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave("breakevenpoint.svg", bg = "transparent")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-Figure2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-Figure2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.2: Breakeven Point 
</figcaption>
<div aria-describedby="fig-Figure2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="exemption_addendum_files/figure-html/fig-Figure2-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="how-progressive-are-exemptions" class="level2">
<h2 class="anchored" data-anchor-id="how-progressive-are-exemptions">How progressive are exemptions?</h2>
<section id="figure-3.-ratio-of-tax-bills-to-av-for-25th-and-75th-percentile-av-class-2-properties-with-10000-ghe" class="level3">
<h3 class="anchored" data-anchor-id="figure-3.-ratio-of-tax-bills-to-av-for-25th-and-75th-percentile-av-class-2-properties-with-10000-ghe">Figure 3. Ratio of Tax Bills to AV for 25th and 75th Percentile AV Class 2 Properties with $10,000 GHE</h3>
<p>For the different exemption scenarios, we created new exemption variables for alternate exemption amounts that can be subtracted from a properties equalized AV.</p>
<ul>
<li>ex. For <code>exe_neg10</code> all exemption amounts are equal to zero.</li>
<li>For <code>exe_0</code>, This variable should be the same as the current tax system since we did not add or remove any exempt EAV to the PIN. If the EAV for a PIN is less than 10000 EAV and they did claim the general homestead exemption, then their exempt EAV is equal to their EAV.</li>
<li>If the exempt EAV allowable for the GHE was increased to 20,000 EAV, then the variable <code>exe_plus10</code> is used.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cook_pins <span class="ot">&lt;-</span> cook_pins <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(class_dict, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"class"</span> <span class="ot">=</span> <span class="st">"class_code"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">has_HO_exe =</span> <span class="fu">ifelse</span>( exe_homeowner <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">has_other_exe =</span> <span class="fu">ifelse</span>(exe_senior <span class="sc">+</span> exe_freeze <span class="sc">+</span> exe_longtime_homeowner <span class="sc">+</span> exe_disabled <span class="sc">+</span> exe_vet_returning <span class="sc">+</span> exe_vet_dis_lt50 <span class="sc">+</span> exe_vet_dis_50_69 <span class="sc">+</span> exe_vet_dis_ge70 <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tax_codes) <span class="sc">|&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tc_muninames) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">av =</span> av_clerk) <span class="sc">|&gt;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tax_code_change) <span class="sc">|&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tif_distribution) <span class="sc">|&gt;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">tax_code_distribution_pct =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(tax_code_distribution_pct), <span class="dv">0</span>, tax_code_distribution_pct),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">in_tif =</span> <span class="fu">ifelse</span>(tax_code_num <span class="sc">%in%</span> tif_distribution<span class="sc">$</span>tax_code_num, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_HO_exe =</span> <span class="fu">ifelse</span>(exe_homeowner <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_other_exe =</span> <span class="fu">ifelse</span>(exe_senior <span class="sc">+</span> exe_freeze <span class="sc">+</span> exe_longtime_homeowner <span class="sc">+</span> exe_disabled <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                             exe_vet_returning <span class="sc">+</span> exe_vet_dis_lt50 <span class="sc">+</span> exe_vet_dis_50_69 <span class="sc">+</span> </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                             exe_vet_dis_ge70 <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span> ),</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_exemptions =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"exe_"</span>))),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_tax_to_tif =</span> tax_bill_total <span class="sc">*</span>  tax_code_distribution_pct,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">final_tax_to_dist =</span> tax_bill_total<span class="sc">-</span>final_tax_to_tif,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">tif_increment_eav =</span> final_tax_to_tif <span class="sc">/</span> tax_code_rate,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">nontif_eav_preexe =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> tif_increment_eav,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">nontif_eav_postexe =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> tif_increment_eav <span class="sc">-</span> all_exemptions,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">eav_postexemptions =</span> av_clerk<span class="sc">*</span>eq_factor <span class="sc">-</span> all_exemptions,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">eav_preexemptions =</span> av_clerk<span class="sc">*</span>eq_factor) <span class="sc">|&gt;</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create variables for alternate exemption amounts that can be subtracted from a properties equalized AV</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">eav =</span> eav_preexemptions,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">exe_neg10 =</span> <span class="dv">0</span>,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># exe_0 implies no additional or removed EAV. Current tax system. </span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_0 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">10000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">10000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">10000</span>, <span class="dv">0</span> )),  <span class="co"># no change in current exemptions</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus10 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">20000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">20000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">20000</span>, <span class="dv">0</span> )),</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus20 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">30000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">30000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">30000</span>, <span class="dv">0</span> ) ),</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus30 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">40000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">40000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">40000</span>, <span class="dv">0</span>) ),</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus40 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">50000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">50000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">50000</span>, <span class="dv">0</span>) ),</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">mil_home =</span> <span class="fu">ifelse</span>(major_class_code <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> av<span class="sc">*</span><span class="dv">10</span> <span class="sc">&gt;</span> <span class="dv">1000000</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="co"># all pins in munis fully within cook county that are some form of single-family, detached home</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>singfam_pins <span class="ot">&lt;-</span> cook_pins <span class="sc">%&gt;%</span> </span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Option2 <span class="sc">==</span> <span class="st">"Single-Family"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculates tax rates for all exemption scenarios.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>scenario_calcs <span class="ot">&lt;-</span> cook_pins <span class="sc">%&gt;%</span>    </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(nicknames) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">MuniLevy =</span> <span class="fu">sum</span>(final_tax_to_dist, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># amount billed by munis with current exemptions in place</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">current_nonTIF_EAV_post_exemps =</span> <span class="fu">sum</span>(final_tax_to_dist<span class="sc">/</span>(tax_code_rate), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">current_TIF_increment_EAV =</span> <span class="fu">sum</span>(final_tax_to_tif<span class="sc">/</span>(tax_code_rate), <span class="at">na.rm=</span><span class="cn">TRUE</span>),  </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">current_Exempt_EAV =</span> <span class="fu">sum</span>(all_exemptions, <span class="at">na.rm=</span>T), </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">current_GHE =</span> <span class="fu">sum</span>(exe_homeowner, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total_EAV =</span> <span class="fu">sum</span>(all_exemptions<span class="sc">+</span>(final_tax_to_dist<span class="sc">+</span>final_tax_to_tif)<span class="sc">/</span>(tax_code_rate), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">exe_neg10 =</span> <span class="fu">sum</span>(exe_neg10),</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">exe_0 =</span> <span class="fu">sum</span>(exe_0), <span class="co"># no change, for comparison</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">exe_plus10 =</span> <span class="fu">sum</span>(exe_plus10),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">exe_plus20 =</span> <span class="fu">sum</span>(exe_plus20),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">exe_plus30 =</span> <span class="fu">sum</span>(exe_plus30),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">exe_plus40 =</span> <span class="fu">sum</span>(exe_plus40),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">mil_home =</span> <span class="fu">sum</span>(mil_home)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove all GHE (up to 10,000 EAV added back to base per PIN), </span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add exe_homeowner back to taxable base</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neg10_taxable_eav =</span> Total_EAV <span class="sc">-</span> current_TIF_increment_EAV <span class="sc">-</span> current_Exempt_EAV <span class="sc">+</span> current_GHE,    <span class="co"># adds GHE exempt EAV back to taxable base and decreases tax rates</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">plus10_taxable_eav =</span> Total_EAV <span class="sc">-</span> current_TIF_increment_EAV <span class="sc">-</span> current_Exempt_EAV <span class="sc">+</span> current_GHE <span class="sc">-</span> exe_plus10, <span class="co"># will increase tax rates</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">plus20_taxable_eav =</span> Total_EAV <span class="sc">-</span> current_TIF_increment_EAV <span class="sc">-</span> current_Exempt_EAV <span class="sc">+</span> current_GHE <span class="sc">-</span> exe_plus20,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">plus30_taxable_eav =</span> Total_EAV <span class="sc">-</span> current_TIF_increment_EAV <span class="sc">-</span> current_Exempt_EAV <span class="sc">+</span> current_GHE <span class="sc">-</span> exe_plus30,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">plus40_taxable_eav =</span> Total_EAV <span class="sc">-</span> current_TIF_increment_EAV <span class="sc">-</span> current_Exempt_EAV <span class="sc">+</span> current_GHE <span class="sc">-</span> exe_plus40,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">scenario_noexemptions_taxable_eav =</span> Total_EAV <span class="sc">-</span> current_TIF_increment_EAV) <span class="sc">%&gt;%</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tr_neg10 =</span> MuniLevy <span class="sc">/</span> neg10_taxable_eav,</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">tr_nochange =</span> MuniLevy <span class="sc">/</span> current_nonTIF_EAV_post_exemps,</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">tr_plus10 =</span> MuniLevy <span class="sc">/</span> plus10_taxable_eav,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">tr_plus20 =</span> MuniLevy <span class="sc">/</span> plus20_taxable_eav,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">tr_plus30 =</span> MuniLevy <span class="sc">/</span> plus30_taxable_eav,</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">tr_plus40 =</span> MuniLevy <span class="sc">/</span> plus40_taxable_eav, </span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">tax_rate_current =</span> MuniLevy<span class="sc">/</span>current_nonTIF_EAV_post_exemps,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">taxrate_noexemps =</span> MuniLevy <span class="sc">/</span>(Total_EAV <span class="sc">-</span> current_TIF_increment_EAV  ),</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">taxrate_noTIFs =</span> MuniLevy <span class="sc">/</span> (Total_EAV <span class="sc">-</span> current_Exempt_EAV),</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">taxrate_noTIFs_orExemps =</span> MuniLevy <span class="sc">/</span> Total_EAV) <span class="sc">%&gt;%</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(clean_name, MuniLevy, tr_neg10<span class="sc">:</span>taxrate_noTIFs_orExemps, <span class="fu">everything</span>())</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>scenario_taxrates <span class="ot">&lt;-</span> scenario_calcs <span class="sc">%&gt;%</span>  </span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(clean_name, MuniLevy, tr_neg10<span class="sc">:</span>taxrate_noTIFs_orExemps) </span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>scenario_taxrates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["clean_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["MuniLevy"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["tr_neg10"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["tr_nochange"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["tr_plus10"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["tr_plus20"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["tr_plus30"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["tr_plus40"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["tax_rate_current"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["taxrate_noexemps"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["taxrate_noTIFs"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["taxrate_noTIFs_orExemps"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"Alsip","2":"82912362","3":"0.12074","4":"0.12910","5":"0.13858","6":"0.14840","7":"0.15895","8":"0.16829","9":"0.12910","10":"0.11638","11":"0.12846","12":"0.11586"},{"1":"Arlington Heights","2":"318867166","3":"0.09539","4":"0.10219","5":"0.10947","6":"0.11797","7":"0.12725","8":"0.13745","9":"0.10219","10":"0.09232","11":"0.10108","12":"0.09141"},{"1":"Barrington","2":"28233988","3":"0.07901","4":"0.08231","5":"0.08595","6":"0.08989","7":"0.09418","8":"0.09877","9":"0.08231","10":"0.07784","11":"0.07886","12":"0.07475"},{"1":"Barrington Hills","2":"18119321","3":"0.08748","4":"0.08994","5":"0.09260","6":"0.09538","7":"0.09834","8":"0.10149","9":"0.08994","10":"0.08676","11":"0.08994","12":"0.08676"},{"1":"Bartlett","2":"48673634","3":"0.11502","4":"0.12718","5":"0.14232","6":"0.16091","7":"0.18336","8":"0.21220","9":"0.12718","10":"0.11203","11":"0.12577","12":"0.11093"},{"1":"Bedford Park","2":"61782087","3":"0.13218","4":"0.13267","5":"0.13321","6":"0.13370","7":"0.13412","8":"0.13440","9":"0.13267","10":"0.13174","11":"0.11214","12":"0.11147"},{"1":"Bellwood","2":"43462343","3":"0.14704","4":"0.17334","5":"0.21261","6":"0.27088","7":"0.36248","8":"0.47535","9":"0.17334","10":"0.13082","11":"0.14947","12":"0.11675"},{"1":"Bensenville","2":"3051324","3":"0.11728","4":"0.11728","5":"0.11728","6":"0.11728","7":"0.11728","8":"0.11728","9":"0.11728","10":"0.11728","11":"0.11728","12":"0.11728"},{"1":"Berkeley","2":"15478048","3":"0.12793","4":"0.14550","5":"0.16908","6":"0.20123","7":"0.24790","8":"0.32077","9":"0.14550","10":"0.11938","11":"0.13805","12":"0.11432"},{"1":"Berwyn","2":"110743355","3":"0.12301","4":"0.13932","5":"0.16107","6":"0.18975","7":"0.22925","8":"0.28327","9":"0.13932","10":"0.11527","11":"0.13353","12":"0.11128"},{"1":"Blue Island","2":"37380047","3":"0.13347","4":"0.15387","5":"0.18423","6":"0.21579","7":"0.23995","8":"0.25086","9":"0.15387","10":"0.12654","11":"0.14211","12":"0.11848"},{"1":"Bridgeview","2":"65367898","3":"0.12244","4":"0.13072","5":"0.13988","6":"0.15010","7":"0.16117","8":"0.17221","9":"0.13072","10":"0.11796","11":"0.12215","12":"0.11094"},{"1":"Broadview","2":"35526068","3":"0.11419","4":"0.12179","5":"0.13070","6":"0.14041","7":"0.15125","8":"0.16188","9":"0.12179","10":"0.10896","11":"0.11836","12":"0.10620"},{"1":"Brookfield","2":"52708328","3":"0.11107","4":"0.12489","5":"0.14688","6":"0.17428","7":"0.20981","8":"0.25809","9":"0.12489","10":"0.10525","11":"0.12319","12":"0.10404"},{"1":"Buffalo Grove","2":"41555847","3":"0.10458","4":"0.11766","5":"0.13434","6":"0.15513","7":"0.18047","8":"0.20907","9":"0.11766","10":"0.09857","11":"0.11764","12":"0.09855"},{"1":"Burbank","2":"61440287","3":"0.10772","4":"0.12289","5":"0.14618","6":"0.17558","7":"0.21544","8":"0.26788","9":"0.12289","10":"0.10031","11":"0.12014","12":"0.09847"},{"1":"Burnham","2":"11043707","3":"0.20224","4":"0.24203","5":"0.29504","6":"0.34693","7":"0.35605","8":"0.35733","9":"0.24203","10":"0.19258","11":"0.24203","12":"0.19258"},{"1":"Burr Ridge","2":"31615416","3":"0.07056","4":"0.07274","5":"0.07485","6":"0.07720","7":"0.07970","8":"0.08234","9":"0.07274","10":"0.06931","11":"0.07274","12":"0.06931"},{"1":"Calumet City","2":"92389551","3":"0.21455","4":"0.26069","5":"0.32749","6":"0.37970","7":"0.40724","8":"0.41342","9":"0.26069","10":"0.20214","11":"0.25411","12":"0.19816"},{"1":"Calumet Park","2":"14930049","3":"0.16780","4":"0.20626","5":"0.26688","6":"0.30180","7":"0.30572","8":"0.30656","9":"0.20626","10":"0.15568","11":"0.19657","12":"0.15010"},{"1":"Chicago","2":"6507764993","3":"0.06463","4":"0.06730","5":"0.07011","6":"0.07301","7":"0.07593","8":"0.07879","9":"0.06730","10":"0.06286","11":"0.05678","12":"0.05358"},{"1":"Chicago Heights","2":"74084309","3":"0.18261","4":"0.21198","5":"0.24848","6":"0.28126","7":"0.29709","8":"0.30143","9":"0.21198","10":"0.17415","11":"0.20380","12":"0.16859"},{"1":"Chicago Ridge","2":"40017825","3":"0.11490","4":"0.12470","5":"0.13652","6":"0.14752","7":"0.15782","8":"0.16720","9":"0.12470","10":"0.11068","11":"0.11848","12":"0.10575"},{"1":"Cicero","2":"107267298","3":"0.12523","4":"0.14376","5":"0.16903","6":"0.20341","7":"0.24882","8":"0.29690","9":"0.14376","10":"0.11703","11":"0.11783","12":"0.09925"},{"1":"Country Club Hills","2":"46062456","3":"0.20075","4":"0.24620","5":"0.31165","6":"0.40197","7":"0.47706","8":"0.52061","9":"0.24620","10":"0.18593","11":"0.19151","12":"0.15294"},{"1":"Countryside","2":"26840052","3":"0.07568","4":"0.07906","5":"0.08286","6":"0.08656","7":"0.08992","8":"0.09330","9":"0.07906","10":"0.07367","11":"0.07717","12":"0.07203"},{"1":"Crestwood","2":"37853089","3":"0.09884","4":"0.10934","5":"0.12216","6":"0.13466","7":"0.14538","8":"0.15557","9":"0.10934","10":"0.09402","11":"0.10439","12":"0.09033"},{"1":"Deer Park","2":"60653","3":"0.09443","4":"0.10786","5":"0.12575","6":"0.15075","7":"0.18817","8":"0.24614","9":"0.10786","10":"0.09443","11":"0.10786","12":"0.09443"},{"1":"Deerfield","2":"15897803","3":"0.08804","4":"0.08804","5":"0.08804","6":"0.08804","7":"0.08804","8":"0.08804","9":"0.08804","10":"0.08804","11":"0.08804","12":"0.08804"},{"1":"Des Plaines","2":"220562134","3":"0.09370","4":"0.10087","5":"0.10908","6":"0.11859","7":"0.12921","8":"0.14050","9":"0.10087","10":"0.09015","11":"0.09884","12":"0.08852"},{"1":"Dixmoor","2":"5804969","3":"0.15651","4":"0.17747","5":"0.19716","6":"0.19924","7":"0.20001","8":"0.20017","9":"0.17747","10":"0.15189","11":"0.14331","12":"0.12615"},{"1":"Dolton","2":"54759049","3":"0.19952","4":"0.24854","5":"0.32415","6":"0.41442","7":"0.46628","8":"0.47185","9":"0.24854","10":"0.18413","11":"0.24001","12":"0.17941"},{"1":"East Dundee","2":"115284","3":"0.08951","4":"0.08951","5":"0.08951","6":"0.08951","7":"0.08951","8":"0.08951","9":"0.08951","10":"0.08951","11":"0.02381","12":"0.02381"},{"1":"East Hazelcrest","2":"4354214","3":"0.18515","4":"0.21274","5":"0.24556","6":"0.26659","7":"0.28142","8":"0.28757","9":"0.21274","10":"0.17558","11":"0.20069","12":"0.16729"},{"1":"Elgin","2":"51071519","3":"0.10294","4":"0.11514","5":"0.13003","6":"0.14908","7":"0.17138","8":"0.19173","9":"0.11514","10":"0.09972","11":"0.11302","12":"0.09813"},{"1":"Elk Grove Village","2":"195476739","3":"0.09072","4":"0.09485","5":"0.09937","6":"0.10423","7":"0.10932","8":"0.11445","9":"0.09485","10":"0.08868","11":"0.08058","12":"0.07608"},{"1":"Elmwood Park","2":"59798234","3":"0.11154","4":"0.12509","5":"0.14246","6":"0.16355","7":"0.19016","8":"0.22533","9":"0.12509","10":"0.10511","11":"0.12392","12":"0.10428"},{"1":"Evanston","2":"286370378","3":"0.08494","4":"0.08897","5":"0.09296","6":"0.09747","7":"0.10227","8":"0.10724","9":"0.08897","10":"0.08310","11":"0.08770","12":"0.08199"},{"1":"Evergreen Park","2":"57574114","3":"0.11478","4":"0.12921","5":"0.15367","6":"0.18178","7":"0.21629","8":"0.25554","9":"0.12921","10":"0.10944","11":"0.12490","12":"0.10633"},{"1":"Flossmoor","2":"40979223","3":"0.15877","4":"0.17917","5":"0.20631","6":"0.24043","7":"0.28572","8":"0.34105","9":"0.17917","10":"0.15166","11":"0.17917","12":"0.15166"},{"1":"Ford Heights","2":"3637274","3":"0.21643","4":"0.24563","5":"0.25190","6":"0.25330","7":"0.25472","8":"0.25611","9":"0.24563","10":"0.21190","11":"0.22268","12":"0.19460"},{"1":"Forest Park","2":"44985251","3":"0.10456","4":"0.11255","5":"0.12193","6":"0.13172","7":"0.14176","8":"0.15199","9":"0.11255","10":"0.10099","11":"0.10682","12":"0.09635"},{"1":"Forestview","2":"9135466","3":"0.12063","4":"0.12434","5":"0.12829","6":"0.13249","7":"0.13698","8":"0.14147","9":"0.12434","10":"0.11861","11":"0.12434","12":"0.11861"},{"1":"Frankfort","2":"2648","3":"0.08411","4":"0.08411","5":"0.08411","6":"0.08411","7":"0.08411","8":"0.08411","9":"0.08411","10":"0.08411","11":"0.08411","12":"0.08411"},{"1":"Franklin Park","2":"105254344","3":"0.12273","4":"0.12917","5":"0.13771","6":"0.14591","7":"0.15412","8":"0.16183","9":"0.12917","10":"0.11994","11":"0.12239","12":"0.11407"},{"1":"Glencoe","2":"85958741","3":"0.09282","4":"0.09527","5":"0.09803","6":"0.10086","7":"0.10386","8":"0.10701","9":"0.09527","10":"0.09194","11":"0.09527","12":"0.09194"},{"1":"Glenview","2":"256446664","3":"0.08011","4":"0.08366","5":"0.08725","6":"0.09131","7":"0.09572","8":"0.10041","9":"0.08366","10":"0.07830","11":"0.08288","12":"0.07762"},{"1":"Glenwood","2":"18626804","3":"0.14966","4":"0.18585","5":"0.24067","6":"0.32320","7":"0.42456","8":"0.46936","9":"0.18585","10":"0.13771","11":"0.15578","12":"0.12048"},{"1":"Golf","2":"3844801","3":"0.09084","4":"0.09401","5":"0.09757","6":"0.10133","7":"0.10538","8":"0.10978","9":"0.09401","10":"0.08992","11":"0.09401","12":"0.08992"},{"1":"Hanover Park","2":"33751243","3":"0.10742","4":"0.12185","5":"0.14099","6":"0.16681","7":"0.20146","8":"0.24449","9":"0.12185","10":"0.10267","11":"0.11464","12":"0.09751"},{"1":"Harvey","2":"54702333","3":"0.22836","4":"0.27265","5":"0.30180","6":"0.30740","7":"0.30948","8":"0.31032","9":"0.27265","10":"0.22193","11":"0.26075","12":"0.21398"},{"1":"Harwood Heights","2":"24491107","3":"0.08379","4":"0.08987","5":"0.09710","6":"0.10544","7":"0.11512","8":"0.12618","9":"0.08987","10":"0.07931","11":"0.08987","12":"0.07931"},{"1":"Hazelcrest","2":"32777058","3":"0.19325","4":"0.24252","5":"0.30799","6":"0.39064","7":"0.44716","8":"0.47415","9":"0.24252","10":"0.17746","11":"0.23910","12":"0.17562"},{"1":"Hickory Hills","2":"36704985","3":"0.10796","4":"0.12059","5":"0.13667","6":"0.15691","7":"0.18198","8":"0.21316","9":"0.12059","10":"0.10202","11":"0.12004","12":"0.10163"},{"1":"Hillside","2":"32416612","3":"0.12381","4":"0.13356","5":"0.14617","6":"0.15977","7":"0.17459","8":"0.19171","9":"0.13356","10":"0.11844","11":"0.11812","12":"0.10614"},{"1":"Hinsdale","2":"15603683","3":"0.07341","4":"0.07518","5":"0.07714","6":"0.07915","7":"0.08127","8":"0.08349","9":"0.07518","10":"0.07283","11":"0.07518","12":"0.07283"},{"1":"Hodgkins","2":"22771780","3":"0.09952","4":"0.10009","5":"0.10069","6":"0.10128","7":"0.10179","8":"0.10229","9":"0.10009","10":"0.09921","11":"0.09398","12":"0.09321"},{"1":"Hoffman Estates","2":"176739846","3":"0.10011","4":"0.10810","5":"0.11718","6":"0.12760","7":"0.13934","8":"0.15260","9":"0.10810","10":"0.09723","11":"0.10653","12":"0.09596"},{"1":"Homer Glen","2":"16657","3":"0.08717","4":"0.08717","5":"0.08717","6":"0.08717","7":"0.08717","8":"0.08717","9":"0.08717","10":"0.08717","11":"0.08717","12":"0.08717"},{"1":"Hometown","2":"5802972","3":"0.09900","4":"0.12562","5":"0.17534","6":"0.27995","7":"0.38188","8":"0.40811","9":"0.12562","10":"0.08992","11":"0.12562","12":"0.08992"},{"1":"Homewood","2":"62279846","3":"0.14253","4":"0.16420","5":"0.19281","6":"0.22796","7":"0.26995","8":"0.30631","9":"0.16420","10":"0.13554","11":"0.16083","12":"0.13324"},{"1":"Indian Head Park","2":"12798421","3":"0.07638","4":"0.08358","5":"0.09236","6":"0.10301","7":"0.11567","8":"0.13082","9":"0.08358","10":"0.07170","11":"0.08358","12":"0.07170"},{"1":"Inverness","2":"42403142","3":"0.09082","4":"0.09571","5":"0.10121","6":"0.10735","7":"0.11426","8":"0.12213","9":"0.09571","10":"0.08893","11":"0.09571","12":"0.08893"},{"1":"Justice","2":"20118242","3":"0.10113","4":"0.11398","5":"0.13087","6":"0.15260","7":"0.18048","8":"0.21320","9":"0.11398","10":"0.09474","11":"0.10737","12":"0.09013"},{"1":"Kenilworth","2":"29078705","3":"0.09636","4":"0.09840","5":"0.10061","6":"0.10288","7":"0.10524","8":"0.10772","9":"0.09840","10":"0.09564","11":"0.09805","12":"0.09531"},{"1":"La Grange","2":"71394125","3":"0.08805","4":"0.09283","5":"0.09845","6":"0.10459","7":"0.11126","8":"0.11847","9":"0.09283","10":"0.08601","11":"0.09283","12":"0.08601"},{"1":"La Grange Park","2":"40448865","3":"0.09197","4":"0.10023","5":"0.10953","6":"0.12093","7":"0.13467","8":"0.15156","9":"0.10023","10":"0.08793","11":"0.09834","12":"0.08647"},{"1":"Lansing","2":"76223792","3":"0.17165","4":"0.20548","5":"0.25731","6":"0.31527","7":"0.36030","8":"0.38318","9":"0.20548","10":"0.16157","11":"0.18728","12":"0.15010"},{"1":"Lemont","2":"56317953","3":"0.07331","4":"0.07838","5":"0.08430","6":"0.09110","7":"0.09901","8":"0.10826","9":"0.07838","10":"0.07117","11":"0.07717","12":"0.07018"},{"1":"Lincolnwood","2":"66630138","3":"0.09203","4":"0.09662","5":"0.10314","6":"0.10972","7":"0.11710","8":"0.12494","9":"0.09662","10":"0.08935","11":"0.09483","12":"0.08781"},{"1":"Lynwood","2":"20702003","3":"0.12123","4":"0.13704","5":"0.15664","6":"0.18150","7":"0.20982","8":"0.23485","9":"0.13704","10":"0.11577","11":"0.13475","12":"0.11413"},{"1":"Lyons","2":"22559131","3":"0.10342","4":"0.11516","5":"0.13040","6":"0.14866","7":"0.17126","8":"0.19086","9":"0.11516","10":"0.09836","11":"0.10817","12":"0.09321"},{"1":"Markham","2":"31690147","3":"0.21475","4":"0.26520","5":"0.33262","6":"0.35973","7":"0.37341","8":"0.37905","9":"0.26520","10":"0.20295","11":"0.23527","12":"0.18494"},{"1":"Matteson","2":"80437210","3":"0.16396","4":"0.18188","5":"0.20411","6":"0.23005","7":"0.25782","8":"0.28019","9":"0.18188","10":"0.15797","11":"0.17428","12":"0.15221"},{"1":"Maywood","2":"47329213","3":"0.16008","4":"0.18855","5":"0.23120","6":"0.29323","7":"0.38598","8":"0.48911","9":"0.18855","10":"0.14232","11":"0.17112","12":"0.13216"},{"1":"Mc Cook","2":"14215294","3":"0.12849","4":"0.12907","5":"0.12966","6":"0.13025","7":"0.13082","8":"0.13138","9":"0.12907","10":"0.12802","11":"0.08618","12":"0.08571"},{"1":"Melrose Park","2":"79116621","3":"0.11111","4":"0.11649","5":"0.12292","6":"0.12963","7":"0.13675","8":"0.14350","9":"0.11649","10":"0.10789","11":"0.10533","12":"0.09825"},{"1":"Merrionette Park","2":"5565724","3":"0.10294","4":"0.11158","5":"0.12129","6":"0.13244","7":"0.14148","8":"0.14434","9":"0.11158","10":"0.09994","11":"0.11158","12":"0.09994"},{"1":"Midlothian","2":"30867012","3":"0.12713","4":"0.15027","5":"0.18298","6":"0.23131","7":"0.29618","8":"0.32919","9":"0.15027","10":"0.12020","11":"0.14429","12":"0.11635"},{"1":"Morton Grove","2":"92003041","3":"0.09663","4":"0.10471","5":"0.11600","6":"0.12873","7":"0.14383","8":"0.16057","9":"0.10471","10":"0.09168","11":"0.09804","12":"0.08652"},{"1":"Mt Prospect","2":"189915921","3":"0.09560","4":"0.10294","5":"0.11151","6":"0.12137","7":"0.13243","8":"0.14462","9":"0.10294","10":"0.09190","11":"0.10220","12":"0.09131"},{"1":"Niles","2":"123945115","3":"0.08604","4":"0.09139","5":"0.09741","6":"0.10417","7":"0.11162","8":"0.11942","9":"0.09139","10":"0.08218","11":"0.08796","12":"0.07939"},{"1":"Norridge","2":"44175206","3":"0.07994","4":"0.08656","5":"0.09455","6":"0.10400","7":"0.11541","8":"0.12910","9":"0.08656","10":"0.07464","11":"0.08656","12":"0.07464"},{"1":"North Lake","2":"56121114","3":"0.12719","4":"0.13540","5":"0.14438","6":"0.15401","7":"0.16462","8":"0.17306","9":"0.13540","10":"0.12358","11":"0.13540","12":"0.12358"},{"1":"North Riverside","2":"26085529","3":"0.09449","4":"0.10126","5":"0.10936","6":"0.11862","7":"0.12941","8":"0.14194","9":"0.10126","10":"0.09062","11":"0.10126","12":"0.09062"},{"1":"Northbrook","2":"224186692","3":"0.08130","4":"0.08451","5":"0.08798","6":"0.09173","7":"0.09580","8":"0.10013","9":"0.08451","10":"0.07968","11":"0.08408","12":"0.07930"},{"1":"Northfield","2":"46022507","3":"0.07879","4":"0.08123","5":"0.08403","6":"0.08693","7":"0.09000","8":"0.09326","9":"0.08123","10":"0.07765","11":"0.08123","12":"0.07765"},{"1":"Oak Brook","2":"56975","3":"0.06003","4":"0.06337","5":"0.06711","6":"0.07131","7":"0.07606","8":"0.08151","9":"0.06337","10":"0.05904","11":"0.06337","12":"0.05904"},{"1":"Oak Forest","2":"67592806","3":"0.12362","4":"0.14359","5":"0.17140","6":"0.21074","7":"0.26731","8":"0.34692","9":"0.14359","10":"0.11666","11":"0.14033","12":"0.11450"},{"1":"Oak Lawn","2":"146321245","3":"0.10641","4":"0.12084","5":"0.14284","6":"0.16774","7":"0.19641","8":"0.23126","9":"0.12084","10":"0.10000","11":"0.11797","12":"0.09802"},{"1":"Oak Park","2":"233683848","3":"0.11691","4":"0.12502","5":"0.13377","6":"0.14389","7":"0.15495","8":"0.16709","9":"0.12502","10":"0.11370","11":"0.12502","12":"0.11370"},{"1":"Olympia Fields","2":"22966525","3":"0.16217","4":"0.18358","5":"0.20623","6":"0.23862","7":"0.28160","8":"0.33483","9":"0.18358","10":"0.15218","11":"0.17263","12":"0.14458"},{"1":"Orland Hills","2":"15819923","3":"0.09523","4":"0.10613","5":"0.11998","6":"0.13787","7":"0.16162","8":"0.18961","9":"0.10613","10":"0.09219","11":"0.10613","12":"0.09219"},{"1":"Orland Park","2":"227093403","3":"0.09130","4":"0.09850","5":"0.10699","6":"0.11698","7":"0.12861","8":"0.14164","9":"0.09850","10":"0.08761","11":"0.09790","12":"0.08714"},{"1":"Palatine","2":"205193385","3":"0.09922","4":"0.10835","5":"0.11934","6":"0.13209","7":"0.14622","8":"0.16186","9":"0.10835","10":"0.09612","11":"0.10214","12":"0.09120"},{"1":"Palos Heights","2":"47206202","3":"0.09992","4":"0.11005","5":"0.12255","6":"0.13817","7":"0.15817","8":"0.18329","9":"0.11005","10":"0.09431","11":"0.10778","12":"0.09263"},{"1":"Palos Hills","2":"40339637","3":"0.09682","4":"0.11086","5":"0.12980","6":"0.15478","7":"0.18588","8":"0.21876","9":"0.11086","10":"0.08976","11":"0.11086","12":"0.08976"},{"1":"Palos Park","2":"22261859","3":"0.08680","4":"0.09253","5":"0.09930","6":"0.10699","7":"0.11593","8":"0.12616","9":"0.09253","10":"0.08372","11":"0.09253","12":"0.08372"},{"1":"Park Forest","2":"36750160","3":"0.29988","4":"0.41331","5":"0.58439","6":"0.71149","7":"0.74369","8":"0.75471","9":"0.41331","10":"0.26635","11":"0.37984","12":"0.25204"},{"1":"Park Ridge","2":"167110348","3":"0.09459","4":"0.10115","5":"0.10911","6":"0.11811","7":"0.12849","8":"0.14028","9":"0.10115","10":"0.09116","11":"0.09809","12":"0.08867"},{"1":"Phoenix","2":"1609624","3":"0.17387","4":"0.29811","5":"0.44844","6":"0.49706","7":"0.51765","8":"0.52648","9":"0.29811","10":"0.16180","11":"0.17354","12":"0.11644"},{"1":"Posen","2":"7589639","3":"0.11305","4":"0.13850","5":"0.19004","6":"0.24182","7":"0.29352","8":"0.30999","9":"0.13850","10":"0.10706","11":"0.10814","12":"0.08798"},{"1":"Prospect Heights","2":"47171514","3":"0.10354","4":"0.11378","5":"0.12578","6":"0.13805","7":"0.15076","8":"0.16496","9":"0.11378","10":"0.09935","11":"0.11347","12":"0.09912"},{"1":"Richton Park","2":"26505197","3":"0.15688","4":"0.18744","5":"0.22985","6":"0.28147","7":"0.33923","8":"0.38553","9":"0.18744","10":"0.14910","11":"0.16230","12":"0.13274"},{"1":"River Forest","2":"61427768","3":"0.09829","4":"0.10357","5":"0.10957","6":"0.11605","7":"0.12306","8":"0.13064","9":"0.10357","10":"0.09596","11":"0.10223","12":"0.09480"},{"1":"River Grove","2":"27784718","3":"0.11713","4":"0.12970","5":"0.14580","6":"0.16407","7":"0.18460","8":"0.20850","9":"0.12970","10":"0.11210","11":"0.11929","12":"0.10424"},{"1":"Riverdale","2":"29493341","3":"0.24920","4":"0.30656","5":"0.37439","6":"0.38354","7":"0.38597","8":"0.38653","9":"0.30656","10":"0.23892","11":"0.30656","12":"0.23892"},{"1":"Riverside","2":"39017825","3":"0.11321","4":"0.12256","5":"0.13376","6":"0.14692","7":"0.16247","8":"0.18136","9":"0.12256","10":"0.10883","11":"0.12256","12":"0.10883"},{"1":"Robbins","2":"6682454","3":"0.12806","4":"0.14963","5":"0.17117","6":"0.17780","7":"0.18038","8":"0.18136","9":"0.14963","10":"0.12252","11":"0.14153","12":"0.11703"},{"1":"Rolling Meadows","2":"96210874","3":"0.10298","4":"0.11043","5":"0.11910","6":"0.12859","7":"0.13821","8":"0.14888","9":"0.11043","10":"0.09999","11":"0.10560","12":"0.09602"},{"1":"Roselle","2":"10546320","3":"0.09532","4":"0.10486","5":"0.11698","6":"0.13194","7":"0.15079","8":"0.17167","9":"0.10486","10":"0.09194","11":"0.10286","12":"0.09040"},{"1":"Rosemont","2":"64640637","3":"0.10350","4":"0.10431","5":"0.10538","6":"0.10630","7":"0.10712","8":"0.10776","9":"0.10431","10":"0.10312","11":"0.07543","12":"0.07481"},{"1":"Sauk Village","2":"11793113","3":"0.13696","4":"0.17078","5":"0.20153","6":"0.21323","7":"0.22253","8":"0.22883","9":"0.17078","10":"0.13228","11":"0.10691","12":"0.09044"},{"1":"Schaumburg","2":"369142884","3":"0.09601","4":"0.10114","5":"0.10660","6":"0.11274","7":"0.11920","8":"0.12516","9":"0.10114","10":"0.09373","11":"0.09602","12":"0.08931"},{"1":"Schiller Park","2":"46797715","3":"0.11976","4":"0.12766","5":"0.13716","6":"0.14670","7":"0.15597","8":"0.16564","9":"0.12766","10":"0.11583","11":"0.12381","12":"0.11265"},{"1":"Skokie","2":"261463704","3":"0.09387","4":"0.09944","5":"0.10723","6":"0.11528","7":"0.12415","8":"0.13314","9":"0.09944","10":"0.09055","11":"0.09700","12":"0.08852"},{"1":"South Barrington","2":"38429917","3":"0.08348","4":"0.08611","5":"0.08891","6":"0.09190","7":"0.09509","8":"0.09852","9":"0.08611","10":"0.08258","11":"0.08611","12":"0.08258"},{"1":"South Chicago Heights","2":"9094028","3":"0.12000","4":"0.13619","5":"0.15782","6":"0.17397","7":"0.17999","8":"0.18232","9":"0.13619","10":"0.11564","11":"0.12447","12":"0.10708"},{"1":"South Holland","2":"75645046","3":"0.16830","4":"0.19503","5":"0.23169","6":"0.28142","7":"0.33821","8":"0.36830","9":"0.19503","10":"0.15751","11":"0.18720","12":"0.15236"},{"1":"Steger","2":"6473565","3":"0.10440","4":"0.12665","5":"0.17051","6":"0.20263","7":"0.22295","8":"0.23843","9":"0.12665","10":"0.09787","11":"0.12206","12":"0.09511"},{"1":"Stickney","2":"15902286","3":"0.11058","4":"0.12424","5":"0.14401","6":"0.16813","7":"0.19876","8":"0.23488","9":"0.12424","10":"0.10407","11":"0.11579","12":"0.09808"},{"1":"Stone Park","2":"8556697","3":"0.14864","4":"0.16375","5":"0.18440","6":"0.20586","7":"0.22779","8":"0.24823","9":"0.16375","10":"0.14115","11":"0.16005","12":"0.13839"},{"1":"Streamwood","2":"95881219","3":"0.10772","4":"0.12155","5":"0.13942","6":"0.16309","7":"0.19501","8":"0.23208","9":"0.12155","10":"0.10352","11":"0.12051","12":"0.10277"},{"1":"Summit","2":"22487803","3":"0.12543","4":"0.13802","5":"0.15442","6":"0.17294","7":"0.19180","8":"0.20800","9":"0.13802","10":"0.11953","11":"0.12651","12":"0.11081"},{"1":"Thornton","2":"10533272","3":"0.17925","4":"0.20401","5":"0.23719","6":"0.26697","7":"0.27139","8":"0.27252","9":"0.20401","10":"0.17119","11":"0.20029","12":"0.16857"},{"1":"Tinley Park","2":"148751057","3":"0.11210","4":"0.12661","5":"0.14540","6":"0.17012","7":"0.20264","8":"0.24358","9":"0.12661","10":"0.10618","11":"0.12405","12":"0.10437"},{"1":"University Park","2":"619610","3":"0.20926","4":"0.20997","5":"0.21069","6":"0.21141","7":"0.21213","8":"0.21282","9":"0.20997","10":"0.20926","11":"0.20997","12":"0.20926"},{"1":"Westchester","2":"53641712","3":"0.08645","4":"0.09522","5":"0.10668","6":"0.12074","7":"0.13868","8":"0.16175","9":"0.09522","10":"0.08150","11":"0.09452","12":"0.08099"},{"1":"Western Springs","2":"62688157","3":"0.07651","4":"0.08024","5":"0.08465","6":"0.08939","7":"0.09467","8":"0.10060","9":"0.08024","10":"0.07504","11":"0.07934","12":"0.07426"},{"1":"Wheeling","2":"129544495","3":"0.11349","4":"0.12229","5":"0.13246","6":"0.14393","7":"0.15615","8":"0.16766","9":"0.12229","10":"0.10975","11":"0.10993","12":"0.09969"},{"1":"Willow Springs","2":"18115271","3":"0.08860","4":"0.09787","5":"0.11066","6":"0.12548","7":"0.14308","8":"0.16433","9":"0.09787","10":"0.08423","11":"0.08994","12":"0.07829"},{"1":"Wilmette","2":"165080888","3":"0.08297","4":"0.08623","5":"0.08982","6":"0.09368","7":"0.09787","8":"0.10237","9":"0.08623","10":"0.08160","11":"0.08623","12":"0.08160"},{"1":"Winnetka","2":"117850744","3":"0.08451","4":"0.08644","5":"0.08852","6":"0.09067","7":"0.09293","8":"0.09528","9":"0.08644","10":"0.08385","11":"0.08644","12":"0.08385"},{"1":"Worth","2":"22855832","3":"0.11510","4":"0.13249","5":"0.15643","6":"0.18544","7":"0.22388","8":"0.26856","9":"0.13249","10":"0.10800","11":"0.13203","12":"0.10769"},{"1":"NA","2":"231730085","3":"0.08428","4":"0.09172","5":"0.10075","6":"0.11120","7":"0.12251","8":"0.13440","9":"0.09172","10":"0.08058","11":"0.09172","12":"0.08058"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>munis_billchange <span class="ot">&lt;-</span> munis_ranked <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(scenario_taxrates) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">eav =</span> eav_preexemptions,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">exe_neg10 =</span> <span class="dv">0</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>      <span class="co"># exe_0 implies no additional or removed EAV. Current tax system. </span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_0 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">10000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">10000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">10000</span>, <span class="dv">0</span> )),  <span class="co"># no change in current exemptions</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus10 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">20000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">20000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">20000</span>, <span class="dv">0</span> )),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus20 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">30000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">30000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">30000</span>, <span class="dv">0</span> ) ),</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus30 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">40000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">40000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">40000</span>, <span class="dv">0</span>) ),</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus40 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">50000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">50000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">50000</span>, <span class="dv">0</span>) ),</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">mil_home =</span> <span class="fu">ifelse</span>(av<span class="sc">*</span><span class="dv">10</span> <span class="sc">&gt;</span> <span class="dv">1000000</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># current bill = current tax rate * portion of levy billed</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">equalized_AV =</span> av_clerk<span class="sc">*</span>eq_factor,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>   <span class="co"># ## Made negative tax bills!! ## #</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">bill_neg10 =</span> tr_neg10<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions<span class="sc">+</span> exe_homeowner <span class="sc">-</span>exe_neg10),</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_current =</span> tax_code_rate<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions),</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus10 =</span>  tr_plus10<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions<span class="sc">+</span> exe_homeowner <span class="sc">-</span>exe_plus10),</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus20 =</span> tr_plus20<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions<span class="sc">+</span> exe_homeowner <span class="sc">-</span>exe_plus20),</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus30 =</span> tr_plus20<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions<span class="sc">+</span> exe_homeowner <span class="sc">-</span>exe_plus30),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus40 =</span> tr_plus20<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions<span class="sc">+</span> exe_homeowner <span class="sc">-</span>exe_plus40),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ## make bills $1 if they had been negative.</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_neg10 =</span> <span class="fu">ifelse</span>(bill_neg10 <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_neg10),</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_current =</span> <span class="fu">ifelse</span>(bill_current <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_current),</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus10 =</span> <span class="fu">ifelse</span>(bill_plus10 <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_plus10),</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus20 =</span> <span class="fu">ifelse</span>(bill_plus20 <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_plus20),</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus30 =</span> <span class="fu">ifelse</span>(bill_plus30 <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_plus30),</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus40 =</span> <span class="fu">ifelse</span>(bill_plus40 <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_plus40),</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>         )<span class="sc">%&gt;%</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_ghe0 =</span> <span class="fu">ifelse</span>(bill_neg10 <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_current =</span> <span class="fu">ifelse</span>(bill_current <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_ghe20 =</span> <span class="fu">ifelse</span>(bill_plus10 <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_ghe30 =</span> <span class="fu">ifelse</span>(bill_plus20 <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_ghe40 =</span> <span class="fu">ifelse</span>(bill_plus30 <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_ghe50 =</span> <span class="fu">ifelse</span>(bill_plus40 <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name, rank, has_HO_exe) <span class="sc">%&gt;%</span> </span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_AV =</span> <span class="fu">round</span>(<span class="fu">median</span>(av)),</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_EAV =</span> <span class="fu">round</span>(<span class="fu">median</span>(eav)),</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_neg10 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_neg10, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_cur =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_current, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_plus10 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_plus10, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_plus20 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_plus20, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_plus30 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_plus30, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_plus40 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_plus40, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">tr_neg10 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tr_neg10<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>), </span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">cur_comp_TC_rate =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tax_code_rate<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">tr_plus10 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tr_plus10<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">tr_plus20 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tr_plus20<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>            <span class="at">tr_plus30 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tr_plus30<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">tr_plus40 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tr_plus40<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">pincount=</span><span class="fu">n</span>(),</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_ghe0 =</span> <span class="fu">sum</span>(zerodol_bills_ghe0),           </span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_current =</span> <span class="fu">sum</span>(zerodol_bills_current),</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_ghe20 =</span> <span class="fu">sum</span>(zerodol_bills_ghe20),</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_ghe30 =</span> <span class="fu">sum</span>(zerodol_bills_ghe30),</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_ghe40 =</span> <span class="fu">sum</span>(zerodol_bills_ghe40),</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_ghe50 =</span> <span class="fu">sum</span>(zerodol_bills_ghe50),</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clean_name =</span> <span class="fu">ifelse</span>(clean_name <span class="sc">==</span> <span class="st">"Hazelcrest"</span>, <span class="st">"Hazel Crest"</span>, clean_name)) <span class="sc">%&gt;%</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(has_HO_exe, rank)</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>ratios <span class="ot">&lt;-</span> munis_billchange <span class="sc">%&gt;%</span> </span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(has_HO_exe <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span>  <span class="sc">!</span><span class="fu">is.na</span>(rank)) <span class="sc">%&gt;%</span> <span class="co"># claimed exemption in 2021</span></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">currbill_to_AV_25 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q25"</span>, mean_bill_cur<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">currbill_to_AV_75 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q75"</span>, mean_bill_cur<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">currbill_to_AV_25 =</span> <span class="fu">max</span>(currbill_to_AV_25, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>            <span class="at">currbill_to_AV_75 =</span> <span class="fu">max</span>(currbill_to_AV_75, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">muni_ratio_25to75 =</span> currbill_to_AV_25<span class="sc">/</span>currbill_to_AV_75) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(muni_ratio_25to75 <span class="sc">&gt;</span> <span class="fl">0.01</span>)</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ratios, <span class="fu">aes</span>(<span class="at">y =</span> currbill_to_AV_25, <span class="at">x =</span> currbill_to_AV_75, <span class="at">label =</span> clean_name)) <span class="sc">+</span> </span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> ratios, <span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">data =</span> (ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> currbill_to_AV_25, <span class="at">x =</span> currbill_to_AV_75), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">point.padding =</span> <span class="dv">0</span>, <span class="co"># additional padding around each point</span></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="co"># draw all line segments</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> (ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> currbill_to_AV_25, <span class="at">x =</span> currbill_to_AV_75, <span class="at">color =</span> <span class="st">"red"</span>), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>), </span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>), </span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>), </span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="cn">NA</span>) ) <span class="sc">+</span></span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">"Tax Burden as a Share of AV </span><span class="sc">\n</span><span class="st">(25th Percentile)"</span>, <span class="at">x=</span><span class="st">"Tax Burden as a Share of AV </span><span class="sc">\n</span><span class="st">(75th Percentile)"</span>, <span class="at">subtitle =</span> <span class="st">"Current Tax System, GHE = 10,000 EAV"</span>) <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exemption_addendum_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cook_pins <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(av <span class="sc">&lt;</span> <span class="dv">300000</span>) <span class="sc">%&gt;%</span> <span class="co"># just to see the histogram better</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>av)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>)  <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook County Class 2 Residential PIN Distribution of AV"</span>, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Assessed Value ($)"</span>, <span class="at">y=</span><span class="st">"# of Pins"</span>, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Dropped PINs with AVs over $300,000 for better visual of histogram bins."</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>singfam_pins <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(av <span class="sc">&lt;</span> <span class="dv">300000</span>) <span class="sc">%&gt;%</span> <span class="co"># just to see the histogram better</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>av)) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>)  <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook County Single-Family PIN Distribution of AV"</span>, </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Assessed Value ($)"</span>, <span class="at">y=</span><span class="st">"# of Pins"</span>, </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Dropped PINs with AVs over $300,000 for better visual of histogram bins."</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>dollar)<span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption><strong>Distribution of Assessed Values: Class 2 Properties vs Single-Family Properties</strong> There is a difference in the assessed values depending on if you use all 200 level properties or only a subset of them. All figures and tables were created for both options when writing the report as a robustness check.</figcaption>
<p><img src="exemption_addendum_files/figure-html/pindistribution-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption><strong>Distribution of Assessed Values: Class 2 Properties vs Single-Family Properties</strong> There is a difference in the assessed values depending on if you use all 200 level properties or only a subset of them. All figures and tables were created for both options when writing the report as a robustness check.</figcaption>
<p><img src="exemption_addendum_files/figure-html/pindistribution-2.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="what-would-happen-if-the-ghe-value-were-increased" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="what-would-happen-if-the-ghe-value-were-increased">What would happen if the GHE value were increased?</h2>
<section id="figure-4.-effect-of-changing-the-ghe-on-progressivity" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="figure-4.-effect-of-changing-the-ghe-on-progressivity">Figure 4. Effect of Changing the GHE on Progressivity</h3>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ratios <span class="ot">&lt;-</span> munis_billchange <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(has_HO_exe <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span>  <span class="sc">!</span><span class="fu">is.na</span>(rank)) <span class="sc">%&gt;%</span> <span class="co"># claimed exemption in 2021</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">currbill_to_AV_25 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q25"</span>, mean_bill_neg10<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">currbill_to_AV_75 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q75"</span>, mean_bill_neg10<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">GHE_0_bill_to_AV_25 =</span> <span class="fu">max</span>(currbill_to_AV_25, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">GHE_0_bill_to_AV_75 =</span> <span class="fu">max</span>(currbill_to_AV_75, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">muni_ratio_25to75 =</span> GHE_0_bill_to_AV_25<span class="sc">/</span>GHE_0_bill_to_AV_75) </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ratios, <span class="fu">aes</span>(<span class="at">y =</span> GHE_0_bill_to_AV_25, <span class="at">x =</span> GHE_0_bill_to_AV_75, <span class="at">label =</span> clean_name)) <span class="sc">+</span> </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">data =</span> (ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> GHE_0_bill_to_AV_25, <span class="at">x =</span> GHE_0_bill_to_AV_75, <span class="at">label =</span> clean_name), <span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> (ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> GHE_0_bill_to_AV_25, <span class="at">x =</span> GHE_0_bill_to_AV_75, <span class="at">color =</span> <span class="st">"red"</span>), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GHE = $0 EAV"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>ratios<span class="ot">&lt;-</span> munis_billchange <span class="sc">%&gt;%</span> </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(has_HO_exe <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span>  <span class="sc">!</span><span class="fu">is.na</span>(rank)) <span class="sc">%&gt;%</span> <span class="co"># claimed exemption in 2021</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">currbill_to_AV_25 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q25"</span>, mean_bill_cur<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">currbill_to_AV_75 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q75"</span>, mean_bill_cur<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">currbill_to_AV_25 =</span> <span class="fu">max</span>(currbill_to_AV_25, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">currbill_to_AV_75 =</span> <span class="fu">max</span>(currbill_to_AV_75, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">muni_ratio_25to75 =</span> currbill_to_AV_25<span class="sc">/</span>currbill_to_AV_75) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(muni_ratio_25to75 <span class="sc">&gt;</span> <span class="fl">0.01</span>)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ratios, <span class="fu">aes</span>(<span class="at">y =</span> currbill_to_AV_25, <span class="at">x =</span> currbill_to_AV_75, <span class="at">label =</span> clean_name)) <span class="sc">+</span> </span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> ratios, <span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">data =</span> (ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> currbill_to_AV_25, <span class="at">x =</span> currbill_to_AV_75), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">point.padding =</span> <span class="dv">0</span>, <span class="co"># additional padding around each point</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="co"># draw all line segments</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> (ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> currbill_to_AV_25, <span class="at">x =</span> currbill_to_AV_75, <span class="at">color =</span> <span class="st">"red"</span>), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GHE = $10,000 EAV (Current)"</span>, <span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>)</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>new_ratios<span class="ot">&lt;-</span> munis_billchange <span class="sc">%&gt;%</span> </span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(has_HO_exe <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span>  <span class="sc">!</span><span class="fu">is.na</span>(rank)) <span class="sc">%&gt;%</span> <span class="co"># claimed exemption in 2021</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">newbill_to_AV_25 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q25"</span>, mean_bill_plus10<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">newbill_to_AV_75 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q75"</span>, mean_bill_plus10<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">newbill_to_AV_25 =</span> <span class="fu">max</span>(newbill_to_AV_25, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>            <span class="at">newbill_to_AV_75 =</span> <span class="fu">max</span>(newbill_to_AV_75, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">muni_ratio_25to75 =</span> newbill_to_AV_25<span class="sc">/</span>newbill_to_AV_75) <span class="sc">%&gt;%</span> </span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(muni_ratio_25to75 <span class="sc">&gt;</span> <span class="fl">0.01</span>)</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> new_ratios, <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75, <span class="at">label =</span> clean_name)) <span class="sc">+</span> </span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> new_ratios, <span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">data =</span> (new_ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">point.padding =</span> <span class="dv">0</span>, <span class="co"># additional padding around each point</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="co"># draw all line segments</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> (new_ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75, <span class="at">color =</span> <span class="st">"red"</span>), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GHE = $20,000 EAV"</span>, <span class="at">x=</span> <span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>)</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>new_ratios<span class="ot">&lt;-</span> munis_billchange <span class="sc">%&gt;%</span> </span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(has_HO_exe <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span>  <span class="sc">!</span><span class="fu">is.na</span>(rank)) <span class="sc">%&gt;%</span> <span class="co"># claimed exemption in 2021</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">newbill_to_AV_25 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q25"</span>, mean_bill_plus20<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">newbill_to_AV_75 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q75"</span>, mean_bill_plus20<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">newbill_to_AV_25 =</span> <span class="fu">max</span>(newbill_to_AV_25, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>            <span class="at">newbill_to_AV_75 =</span> <span class="fu">max</span>(newbill_to_AV_75, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">muni_ratio_25to75 =</span> newbill_to_AV_25<span class="sc">/</span>newbill_to_AV_75) <span class="sc">%&gt;%</span> </span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(muni_ratio_25to75 <span class="sc">&gt;</span> <span class="fl">0.01</span>)</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> new_ratios, <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75, <span class="at">label =</span> clean_name)) <span class="sc">+</span> </span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">data =</span> (new_ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">point.padding =</span> <span class="dv">0</span>, <span class="co"># additional padding around each point</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="co"># draw all line segments</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> (new_ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75, <span class="at">color =</span> <span class="st">"red"</span>), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GHE = $30,000 EAV"</span>,</span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>new_ratios<span class="ot">&lt;-</span> munis_billchange <span class="sc">%&gt;%</span> </span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(has_HO_exe <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span>  <span class="sc">!</span><span class="fu">is.na</span>(rank)) <span class="sc">%&gt;%</span> <span class="co"># claimed exemption in 2021</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">newbill_to_AV_25 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q25"</span>, mean_bill_plus30<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">newbill_to_AV_75 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q75"</span>, mean_bill_plus30<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">newbill_to_AV_25 =</span> <span class="fu">max</span>(newbill_to_AV_25, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>            <span class="at">newbill_to_AV_75 =</span> <span class="fu">max</span>(newbill_to_AV_75, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">muni_ratio_25to75 =</span> newbill_to_AV_25<span class="sc">/</span>newbill_to_AV_75) <span class="sc">%&gt;%</span> </span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(muni_ratio_25to75 <span class="sc">&gt;</span> <span class="fl">0.01</span>)</span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> new_ratios, <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75, <span class="at">label =</span> clean_name)) <span class="sc">+</span> </span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">data =</span> (new_ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">point.padding =</span> <span class="dv">0</span>, <span class="co"># additional padding around each point</span></span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="co"># draw all line segments</span></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> (new_ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75, <span class="at">color =</span> <span class="st">"red"</span>), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GHE = $40,000 EAV"</span>, </span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">x=</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>new_ratios<span class="ot">&lt;-</span> munis_billchange <span class="sc">%&gt;%</span> </span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(has_HO_exe <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span>  <span class="sc">!</span><span class="fu">is.na</span>(rank)) <span class="sc">%&gt;%</span> <span class="co"># claimed exemption in 2021</span></span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">newbill_to_AV_25 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q25"</span>, mean_bill_plus40<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">newbill_to_AV_75 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q75"</span>, mean_bill_plus40<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">newbill_to_AV_25 =</span> <span class="fu">max</span>(newbill_to_AV_25, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>            <span class="at">newbill_to_AV_75 =</span> <span class="fu">max</span>(newbill_to_AV_75, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">muni_ratio_25to75 =</span> newbill_to_AV_25<span class="sc">/</span>newbill_to_AV_75) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(muni_ratio_25to75 <span class="sc">&gt;</span> <span class="fl">0.01</span>)</span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> new_ratios, <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75, <span class="at">label =</span> clean_name)) <span class="sc">+</span> </span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">data =</span> (new_ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">point.padding =</span> <span class="dv">0</span>, <span class="co"># additional padding around each point</span></span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="co"># draw all line segments</span></span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> (new_ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> newbill_to_AV_25, <span class="at">x =</span> newbill_to_AV_75, <span class="at">color =</span> <span class="st">"red"</span>), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GHE = $50,000"</span>, </span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell column-page quarto-layout-panel" data-layout-ncol="3" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="exemption_addendum_files/figure-html/casestudies-inred-MC2props-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="exemption_addendum_files/figure-html/casestudies-inred-MC2props-2.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="exemption_addendum_files/figure-html/casestudies-inred-MC2props-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="exemption_addendum_files/figure-html/casestudies-inred-MC2props-4.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="exemption_addendum_files/figure-html/casestudies-inred-MC2props-5.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="exemption_addendum_files/figure-html/casestudies-inred-MC2props-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
<section id="table-3.-revenue-neutral-tax-rates" class="level3">
<h3 class="anchored" data-anchor-id="table-3.-revenue-neutral-tax-rates">Table 3. Revenue Neutral Tax Rates</h3>
<p><strong>Revenue Neutral Tax Rates (Percent) for Select Municipalities as a Function of GHE Value</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>scenario_taxrates <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>, <span class="st">"Dolton"</span>, <span class="st">"Glencoe"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Municipality =</span> clean_name,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"0 GHE"</span> <span class="ot">=</span> tr_neg10,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"10,000 GHE (Current)"</span> <span class="ot">=</span> tr_nochange,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"20,000 GHE"</span> <span class="ot">=</span> tr_plus10,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">"30,000 GHE"</span> <span class="ot">=</span> tr_plus20,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">"40,000 GHE"</span> <span class="ot">=</span> tr_plus30,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">"50,000 GHE"</span> <span class="ot">=</span> tr_plus40)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Municipality"],"name":[1],"type":["chr"],"align":["left"]},{"label":["0 GHE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["10,000 GHE (Current)"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["20,000 GHE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["30,000 GHE"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["40,000 GHE"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["50,000 GHE"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"Chicago","2":"0.06463","3":"0.06730","4":"0.07011","5":"0.07301","6":"0.07593","7":"0.07879"},{"1":"Dolton","2":"0.19952","3":"0.24854","4":"0.32415","5":"0.41442","6":"0.46628","7":"0.47185"},{"1":"Glencoe","2":"0.09282","3":"0.09527","4":"0.09803","5":"0.10086","6":"0.10386","7":"0.10701"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="figure-5.-ghe-value-and-revenue-neutral-tax-rates" class="level3">
<h3 class="anchored" data-anchor-id="figure-5.-ghe-value-and-revenue-neutral-tax-rates">Figure 5. GHE Value and Revenue Neutral Tax Rates</h3>
<p><strong>Relationship of GHE Value and Revenue Neutral Tax Rates in Chicago, Dolton, and Glencoe</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>scenario_taxrates <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>, <span class="st">"Dolton"</span>, <span class="st">"Glencoe"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Municipality =</span> clean_name,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"0 GHE"</span> <span class="ot">=</span> tr_neg10,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"10,000 GHE</span><span class="sc">\n</span><span class="st">(Current)"</span> <span class="ot">=</span> tr_nochange,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"20,000 GHE"</span> <span class="ot">=</span> tr_plus10,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">"30,000 GHE"</span> <span class="ot">=</span> tr_plus20,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">"40,000 GHE"</span> <span class="ot">=</span> tr_plus30,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">"50,000 GHE"</span> <span class="ot">=</span> tr_plus40) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">0 GHE</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">50,000 GHE</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Scenarios"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Scenarios, <span class="at">y =</span> value, <span class="at">group =</span> Municipality, <span class="at">color =</span> Municipality)) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tax Rates for GHE Scenarios"</span>, <span class="at">x =</span> <span class="st">"GHE Amount"</span>, <span class="at">y =</span> <span class="st">"Tax Rate"</span>) <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exemption_addendum_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="paying-for-the-inequitable-effects-of-exemptions" class="level2">
<h2 class="anchored" data-anchor-id="paying-for-the-inequitable-effects-of-exemptions">Paying for the inequitable effects of exemptions</h2>
<section id="figure-6.-exemptions-by-value-in-class-8-municipalities" class="level3">
<h3 class="anchored" data-anchor-id="figure-6.-exemptions-by-value-in-class-8-municipalities">Figure 6. Exemptions by Value in Class 8 Municipalities</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cook_pins <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Homeowner =</span> <span class="fu">sum</span>(exe_homeowner),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Senior =</span> <span class="fu">sum</span>(exe_senior),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Senior Freeze</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(exe_freeze),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>   <span class="co"># exe_longtime_homeowner = sum(exe_longtime_homeowner),</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other =</span> <span class="fu">sum</span>(exe_disabled),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Blue Island"</span>, <span class="st">"Markham"</span>, <span class="st">"Matteson"</span>, <span class="st">"Park Forest"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Homeowner<span class="sc">:</span>Other), <span class="at">names_to =</span> <span class="st">"Exemption Type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>clean_name, <span class="at">y =</span> value, <span class="at">fill =</span> <span class="st">`</span><span class="at">Exemption Type</span><span class="st">`</span>), <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="st">"Exempt EAV"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exemption_addendum_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figure-7.-exemption-share-in-class-8-municipalities" class="level3">
<h3 class="anchored" data-anchor-id="figure-7.-exemption-share-in-class-8-municipalities">Figure 7. Exemption Share in Class 8 Municipalities</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cook_pins <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_exemptions =</span> <span class="fu">sum</span>(all_exemptions),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">eq_av =</span> <span class="fu">sum</span>(av_clerk<span class="sc">*</span>eq_factor),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tif_increment_eav =</span> <span class="fu">sum</span>(tif_increment_eav)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">taxable_eav =</span> eq_av <span class="sc">-</span> tif_increment_eav <span class="sc">-</span> all_exemptions) <span class="sc">|&gt;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Blue Island"</span>, <span class="st">"Markham"</span>, <span class="st">"Matteson"</span>, <span class="st">"Park Forest"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(all_exemptions<span class="sc">:</span>taxable_eav), <span class="at">names_to =</span> <span class="st">"exe_type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(exe_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"taxable_eav"</span>, <span class="st">"all_exemptions"</span>))<span class="sc">|&gt;</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>clean_name, <span class="at">y =</span> value, <span class="at">fill =</span> exe_type), <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span> </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="st">"Non-TIF Increment EAV in Municipality"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="exemption_addendum_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./exemption_report_2021.html" class="pagination-link" aria-label="Exemptions in Cook County - Tax Year 2021">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Exemptions in Cook County - Tax Year 2021</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./incentive_report_content.html" class="pagination-link" aria-label="Incentive Classifications">
        <span class="nav-page-text"><span class="chapter-title">Incentive Classifications</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb18" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Exemption Addendum"</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="an">ubtitle:</span><span class="co"> "Supporting Content for Extended Analysis of Selected Benefits and Costs of Homestead Exemptions in Illinois"</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, warning=FALSE, message=FALSE}</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: TRUE</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="in">library(ptaxsim)</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="in">library(DBI)</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="in">library(httr)</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="in">library(jsonlite)</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="in">library(glue)</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="in">library(DT)</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(warning = FALSE, message = FALSE)</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="in">file_path &lt;- "C:/Users/aleaw/" </span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="in">taxyear &lt;-c(2021)</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="in">taxyear = as.data.frame(taxyear)</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="in">source("../scripts/helper_tc_muninames.R") </span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="in">tc_muninames &lt;- tc_muninames |&gt; select(-tax_code_rate)</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="in">#ptaxsim_db_conn &lt;- DBI::dbConnect(RSQLite::SQLite(), "./ptaxsim.db/ptaxsim-2023.0.0.db")</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="in">if (file.exists(file_path)){</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="in">   ptaxsim_db_conn &lt;- DBI::dbConnect(RSQLite::SQLite(), "C:/Users/aleaw/OneDrive/Documents/PhD Fall 2021 - Spring 2022/Merriman RA/ptax/ptaxsim.db/ptaxsim-2023.0.0.db")</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="in">} else {</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="in">    ptaxsim_db_conn &lt;- DBI::dbConnect(RSQLite::SQLite(), "./ptaxsim.db/ptaxsim-2023.0.0.db")</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a><span class="in">current_dir = getwd()</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a><span class="in">if (grepl("Website", current_dir)) {</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="in">  dots = "../"</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a><span class="in">} else {</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a><span class="in">  dots = "./"</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a><span class="in">path &lt;- paste0(dots, "Necessary_Files/class_dict_singlefamcodes.csv")</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a><span class="in">class_dict &lt;- read_csv(path) %&gt;% </span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(class_code = as.character(class_code)) # change variable type to character so the join works.</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a><span class="in">path &lt;- paste0(dots, "inputs/ccao_loa.csv")</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a><span class="in">ccao_loa &lt;- read_csv(path) %&gt;% </span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(class_code = as.character(class_code))</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a><span class="in">eq_factor = 3.0027</span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a><span class="in"># get all tax codes and tax rates</span></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a><span class="in">tax_codes &lt;- DBI::dbGetQuery(</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a><span class="in">    ptaxsim_db_conn, </span></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a><span class="in">    glue_sql("</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a><span class="in">             SELECT DISTINCT tax_code_num, tax_code_rate</span></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a><span class="in">             FROM tax_code</span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a><span class="in">             WHERE year = 2021</span></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a><span class="in">             "</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a><span class="in">             , </span></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a><span class="in">             .con = ptaxsim_db_conn)) |&gt; </span></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tax_code_rate = tax_code_rate / 100)</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a><span class="in"># get percent of eav that goes to a TIF:</span></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a><span class="in">tif_distribution &lt;- DBI::dbGetQuery(</span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a><span class="in">    ptaxsim_db_conn, </span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a><span class="in">    glue_sql("</span></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a><span class="in">             SELECT DISTINCT* </span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a><span class="in">             FROM tif_distribution</span></span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a><span class="in">             WHERE year = 2021</span></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a><span class="in">             "</span></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a><span class="in">             , </span></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a><span class="in">             .con = ptaxsim_db_conn)) %&gt;%</span></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(tax_code_rate, agency_num)) |&gt;</span></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tax_code_distribution_pct = tax_code_distribution_pct / 100)</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a><span class="in"># All PINs - get AV and exemption amounts -----------------------------</span></span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a><span class="in"># Include ALL PINs for calculating muni level composite rates:</span></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a><span class="in">cook_pins &lt;- DBI::dbGetQuery(</span></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a><span class="in">    ptaxsim_db_conn, </span></span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a><span class="in">    glue_sql("</span></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a><span class="in">             SELECT DISTINCT* </span></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a><span class="in">             FROM pin </span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a><span class="in">             WHERE year = 2021</span></span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a><span class="in">             "</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a><span class="in">             , </span></span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a><span class="in">             .con = ptaxsim_db_conn)) </span></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a><span class="in"># create some variables that we need:</span></span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a><span class="in">muni_rates &lt;- cook_pins |&gt; </span></span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tax_codes) |&gt;</span></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tc_muninames) |&gt;</span></span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tif_distribution) |&gt;</span></span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a><span class="in">    tax_code_distribution_pct = ifelse(is.na(tax_code_distribution_pct), 0, tax_code_distribution_pct),</span></span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a><span class="in">    in_tif = ifelse(tax_code_num %in% tif_distribution$tax_code_num, 1, 0),</span></span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a><span class="in">    has_HO_exe = ifelse(exe_homeowner &gt; 0, 1, 0),</span></span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a><span class="in">    has_other_exe = ifelse(exe_senior + exe_freeze + exe_longtime_homeowner + exe_disabled +</span></span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a><span class="in">                             exe_vet_returning + exe_vet_dis_lt50 + exe_vet_dis_50_69 + exe_vet_dis_ge70 &gt; 0, 1, 0 ),</span></span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a><span class="in">    final_tax_to_tif = tax_bill_total *  tax_code_distribution_pct,   # TIF revenue</span></span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a><span class="in">    final_tax_to_dist = tax_bill_total - final_tax_to_tif,      # local government revenue</span></span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a><span class="in">   all_exemptions = rowSums(across(starts_with("exe_"))),</span></span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a><span class="in">     tif_increment_eav = final_tax_to_tif / tax_code_rate,</span></span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a><span class="in">     nontif_eav_preexe = av_clerk*eq_factor - tif_increment_eav,</span></span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a><span class="in">     nontif_eav_postexe = av_clerk*eq_factor - tif_increment_eav - all_exemptions,</span></span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a><span class="in">    current_taxbase = final_tax_to_dist / tax_code_rate, # should match nontif_eav_postexe amount</span></span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a><span class="in">    eav_postexemptions = av_clerk*eq_factor - all_exemptions, # ignores tif distribution</span></span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a><span class="in">    eav_preexemptions = av_clerk*eq_factor, # ignores tif distribution</span></span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(av = av_clerk)  |&gt; # av used for calculations is the final av value from the clerk's office</span></span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(clean_name)|&gt;</span></span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(</span></span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a><span class="in">    tax_bill_total = sum(tax_bill_total), # TIF and local government revenue</span></span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a><span class="in">    tif_increment_eav = sum(tif_increment_eav, na.rm=T),  # should be sum of frozen EAV</span></span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a><span class="in">    muni_taxed_eav = sum(nontif_eav_postexe, na.rm=T),  # non-TIF and non-exempt EAV taxed by government agencies</span></span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a><span class="in">    muni_exempt_eav_from_GHE = sum(exe_homeowner, na.rm=T),</span></span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a><span class="in">    muni_levy = sum(final_tax_to_dist, na.rm=T),</span></span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a><span class="in">    muni_min_rate = min(tax_code_rate),</span></span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a><span class="in">    muni_median_rate = median(tax_code_rate),</span></span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a><span class="in">    muni_avg_rate = mean(tax_code_rate, na.rm=T),</span></span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a><span class="in">    muni_max_rate = max(tax_code_rate),</span></span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a><span class="in">    final_tax_to_dist = sum(final_tax_to_dist, na.rm=T),</span></span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a><span class="in">    final_tax_to_tif = sum(final_tax_to_tif, na.rm=T)) |&gt;</span></span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(muni_hyp_taxbase = muni_taxed_eav + muni_exempt_eav_from_GHE,   </span></span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a><span class="in">         muni_hyp_taxrate =  muni_levy / muni_hyp_taxbase)</span></span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a><span class="in">## Tax code level "levies" and tax bases ----------------</span></span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a><span class="in">tax_code_change &lt;- cook_pins |&gt;  </span></span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tax_codes) |&gt;</span></span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tc_muninames) |&gt;</span></span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tif_distribution) |&gt;</span></span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a><span class="in">    tax_code_distribution_pct = ifelse(is.na(tax_code_distribution_pct), 0, tax_code_distribution_pct),</span></span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a><span class="in">    in_tif = ifelse(tax_code_num %in% tif_distribution$tax_code_num, 1, 0),</span></span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a><span class="in">    has_HO_exe = ifelse(exe_homeowner &gt; 0, 1, 0),</span></span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a><span class="in">    has_other_exe = ifelse(exe_senior + exe_freeze + exe_longtime_homeowner + exe_disabled +</span></span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a><span class="in">                             exe_vet_returning + exe_vet_dis_lt50 + exe_vet_dis_50_69 + </span></span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a><span class="in">                             exe_vet_dis_ge70 &gt; 0, 1, 0 ),</span></span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a><span class="in">    all_exemptions = rowSums(across(starts_with("exe_"))),</span></span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a><span class="in">    final_tax_to_tif = tax_bill_total *  tax_code_distribution_pct/100,</span></span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a><span class="in">    final_tax_to_dist = tax_bill_total - final_tax_to_tif,</span></span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a><span class="in">    tif_increment_eav = final_tax_to_tif / tax_code_rate,</span></span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a><span class="in">    nontif_eav_preexe = av_clerk*eq_factor - tif_increment_eav,</span></span>
<span id="cb18-161"><a href="#cb18-161" aria-hidden="true" tabindex="-1"></a><span class="in">     nontif_eav_postexe = av_clerk*eq_factor - tif_increment_eav - all_exemptions,</span></span>
<span id="cb18-162"><a href="#cb18-162" aria-hidden="true" tabindex="-1"></a><span class="in">    eav_postexemptions = av_clerk*eq_factor - all_exemptions,</span></span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true" tabindex="-1"></a><span class="in">    eav_preexemptions = av_clerk*eq_factor,</span></span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true" tabindex="-1"></a><span class="in">    total_bill = final_tax_to_tif + final_tax_to_dist</span></span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(clean_name, tax_code_num, tax_code_rate) |&gt;</span></span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(</span></span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true" tabindex="-1"></a><span class="in">    tc_pc = n(),</span></span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true" tabindex="-1"></a><span class="in">    tc_tax_bill_total = sum(tax_bill_total), # TIF and local government revenue at tax code level</span></span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true" tabindex="-1"></a><span class="in">    tc_eav_inTIF = sum(tif_increment_eav, na.rm=T),  # should be sum of frozen EAV</span></span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true" tabindex="-1"></a><span class="in">    tc_taxed_eav = sum(nontif_eav_postexe, na.rm=T),  # non-TIF and non-exempt EAV taxed by government agencies</span></span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true" tabindex="-1"></a><span class="in">    tc_exempt_eav_from_GHE = sum(exe_homeowner, na.rm=T),</span></span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true" tabindex="-1"></a><span class="in">    tc_final_tax_to_dist = sum(final_tax_to_dist, na.rm=T),</span></span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true" tabindex="-1"></a><span class="in">    tc_final_tax_to_tif = sum(final_tax_to_tif, na.rm=T)) |&gt;</span></span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tc_hyp_taxbase = tc_taxed_eav + tc_exempt_eav_from_GHE,   </span></span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true" tabindex="-1"></a><span class="in">         tc_hyp_taxrate =  tc_final_tax_to_dist / tc_hyp_taxbase)</span></span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-178"><a href="#cb18-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-179"><a href="#cb18-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-180"><a href="#cb18-180" aria-hidden="true" tabindex="-1"></a><span class="in"># Identify Class 2 Residential PINs ------------- </span></span>
<span id="cb18-181"><a href="#cb18-181" aria-hidden="true" tabindex="-1"></a><span class="in">c2pins &lt;- DBI::dbGetQuery(</span></span>
<span id="cb18-182"><a href="#cb18-182" aria-hidden="true" tabindex="-1"></a><span class="in">  ptaxsim_db_conn, </span></span>
<span id="cb18-183"><a href="#cb18-183" aria-hidden="true" tabindex="-1"></a><span class="in">  glue_sql("</span></span>
<span id="cb18-184"><a href="#cb18-184" aria-hidden="true" tabindex="-1"></a><span class="in">             SELECT DISTINCT* </span></span>
<span id="cb18-185"><a href="#cb18-185" aria-hidden="true" tabindex="-1"></a><span class="in">             FROM pin </span></span>
<span id="cb18-186"><a href="#cb18-186" aria-hidden="true" tabindex="-1"></a><span class="in">             WHERE class &gt; 199 AND class &lt; 300</span></span>
<span id="cb18-187"><a href="#cb18-187" aria-hidden="true" tabindex="-1"></a><span class="in">             AND year = 2021</span></span>
<span id="cb18-188"><a href="#cb18-188" aria-hidden="true" tabindex="-1"></a><span class="in">             "</span></span>
<span id="cb18-189"><a href="#cb18-189" aria-hidden="true" tabindex="-1"></a><span class="in">           , </span></span>
<span id="cb18-190"><a href="#cb18-190" aria-hidden="true" tabindex="-1"></a><span class="in">           .con = ptaxsim_db_conn))</span></span>
<span id="cb18-191"><a href="#cb18-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-192"><a href="#cb18-192" aria-hidden="true" tabindex="-1"></a><span class="in">c2pins &lt;- c2pins |&gt; </span></span>
<span id="cb18-193"><a href="#cb18-193" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(has_HO_exe = ifelse( exe_homeowner &gt; 0, 1, 0),</span></span>
<span id="cb18-194"><a href="#cb18-194" aria-hidden="true" tabindex="-1"></a><span class="in">         has_other_exe = ifelse(exe_senior + exe_freeze + exe_longtime_homeowner + exe_disabled + exe_vet_returning + exe_vet_dis_lt50 + exe_vet_dis_50_69 + exe_vet_dis_ge70 &gt; 0, 1, 0 )) %&gt;% </span></span>
<span id="cb18-195"><a href="#cb18-195" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tax_codes) |&gt;</span></span>
<span id="cb18-196"><a href="#cb18-196" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tc_muninames) %&gt;%</span></span>
<span id="cb18-197"><a href="#cb18-197" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(av = av_clerk) |&gt;</span></span>
<span id="cb18-198"><a href="#cb18-198" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tax_code_change) |&gt;</span></span>
<span id="cb18-199"><a href="#cb18-199" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tif_distribution) |&gt;</span></span>
<span id="cb18-200"><a href="#cb18-200" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb18-201"><a href="#cb18-201" aria-hidden="true" tabindex="-1"></a><span class="in">    tax_code_distribution_pct = ifelse(is.na(tax_code_distribution_pct), 0, tax_code_distribution_pct),</span></span>
<span id="cb18-202"><a href="#cb18-202" aria-hidden="true" tabindex="-1"></a><span class="in">    in_tif = ifelse(tax_code_num %in% tif_distribution$tax_code_num, 1, 0),</span></span>
<span id="cb18-203"><a href="#cb18-203" aria-hidden="true" tabindex="-1"></a><span class="in">    has_HO_exe = ifelse(exe_homeowner &gt; 0, 1, 0),</span></span>
<span id="cb18-204"><a href="#cb18-204" aria-hidden="true" tabindex="-1"></a><span class="in">    has_other_exe = ifelse(exe_senior + exe_freeze + exe_longtime_homeowner + exe_disabled +</span></span>
<span id="cb18-205"><a href="#cb18-205" aria-hidden="true" tabindex="-1"></a><span class="in">                             exe_vet_returning + exe_vet_dis_lt50 + exe_vet_dis_50_69 + </span></span>
<span id="cb18-206"><a href="#cb18-206" aria-hidden="true" tabindex="-1"></a><span class="in">                             exe_vet_dis_ge70 &gt; 0, 1, 0 ),</span></span>
<span id="cb18-207"><a href="#cb18-207" aria-hidden="true" tabindex="-1"></a><span class="in">    all_exemptions = rowSums(across(starts_with("exe_"))),</span></span>
<span id="cb18-208"><a href="#cb18-208" aria-hidden="true" tabindex="-1"></a><span class="in">    final_tax_to_tif = tax_bill_total *  tax_code_distribution_pct/100,</span></span>
<span id="cb18-209"><a href="#cb18-209" aria-hidden="true" tabindex="-1"></a><span class="in">    final_tax_to_dist = tax_bill_total-final_tax_to_tif,</span></span>
<span id="cb18-210"><a href="#cb18-210" aria-hidden="true" tabindex="-1"></a><span class="in">    tif_increment_eav = final_tax_to_tif / tax_code_rate,</span></span>
<span id="cb18-211"><a href="#cb18-211" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb18-212"><a href="#cb18-212" aria-hidden="true" tabindex="-1"></a><span class="in">    nontif_eav_preexe = av_clerk*eq_factor - tif_increment_eav,</span></span>
<span id="cb18-213"><a href="#cb18-213" aria-hidden="true" tabindex="-1"></a><span class="in">    nontif_eav_postexe = av_clerk*eq_factor - tif_increment_eav - all_exemptions,</span></span>
<span id="cb18-214"><a href="#cb18-214" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb18-215"><a href="#cb18-215" aria-hidden="true" tabindex="-1"></a><span class="in">    eav_postexemptions = av_clerk*eq_factor - all_exemptions,</span></span>
<span id="cb18-216"><a href="#cb18-216" aria-hidden="true" tabindex="-1"></a><span class="in">    eav_preexemptions = av_clerk*eq_factor)</span></span>
<span id="cb18-217"><a href="#cb18-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-218"><a href="#cb18-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-219"><a href="#cb18-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-222"><a href="#cb18-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-223"><a href="#cb18-223" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: medianproperty-bymuni</span></span>
<span id="cb18-224"><a href="#cb18-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-225"><a href="#cb18-225" aria-hidden="true" tabindex="-1"></a>q <span class="ot">=</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>, .<span class="dv">9</span>)</span>
<span id="cb18-226"><a href="#cb18-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-227"><a href="#cb18-227" aria-hidden="true" tabindex="-1"></a><span class="do">## ranks properties that are considered C2 properties in order of AV for each Muni</span></span>
<span id="cb18-228"><a href="#cb18-228" aria-hidden="true" tabindex="-1"></a>muni_quartiles <span class="ot">&lt;-</span> c2pins <span class="sc">%&gt;%</span></span>
<span id="cb18-229"><a href="#cb18-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb18-230"><a href="#cb18-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(av) <span class="sc">%&gt;%</span></span>
<span id="cb18-231"><a href="#cb18-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count_pins =</span> <span class="fu">n</span>(), </span>
<span id="cb18-232"><a href="#cb18-232" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(av),</span>
<span id="cb18-233"><a href="#cb18-233" aria-hidden="true" tabindex="-1"></a>            <span class="at">quant10 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(av, <span class="at">probs =</span> q[<span class="dv">1</span>])), </span>
<span id="cb18-234"><a href="#cb18-234" aria-hidden="true" tabindex="-1"></a>            <span class="at">quant25 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(av, <span class="at">probs =</span> q[<span class="dv">2</span>])), </span>
<span id="cb18-235"><a href="#cb18-235" aria-hidden="true" tabindex="-1"></a>            <span class="at">quant50 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(av, <span class="at">probs =</span> q[<span class="dv">3</span>])),</span>
<span id="cb18-236"><a href="#cb18-236" aria-hidden="true" tabindex="-1"></a>            <span class="at">quant75 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(av, <span class="at">probs =</span> q[<span class="dv">4</span>])),</span>
<span id="cb18-237"><a href="#cb18-237" aria-hidden="true" tabindex="-1"></a>            <span class="at">quant90 =</span> <span class="fu">round</span>(<span class="fu">quantile</span>(av, <span class="at">probs =</span> q[<span class="dv">5</span>])),</span>
<span id="cb18-238"><a href="#cb18-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-239"><a href="#cb18-239" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(av)</span>
<span id="cb18-240"><a href="#cb18-240" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">%&gt;%</span> </span>
<span id="cb18-241"><a href="#cb18-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(quant50))</span>
<span id="cb18-242"><a href="#cb18-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-243"><a href="#cb18-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-244"><a href="#cb18-244" aria-hidden="true" tabindex="-1"></a><span class="co"># Class 2 Descriptive Stats </span></span>
<span id="cb18-245"><a href="#cb18-245" aria-hidden="true" tabindex="-1"></a>C2_munistats <span class="ot">&lt;-</span> c2pins <span class="sc">%&gt;%</span> </span>
<span id="cb18-246"><a href="#cb18-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">&gt;</span> <span class="dv">199</span> <span class="sc">&amp;</span> class <span class="sc">&lt;</span> <span class="dv">300</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-247"><a href="#cb18-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name)  <span class="sc">%&gt;%</span></span>
<span id="cb18-248"><a href="#cb18-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(av) <span class="sc">%&gt;%</span></span>
<span id="cb18-249"><a href="#cb18-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb18-250"><a href="#cb18-250" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_eav =</span> <span class="fu">round</span>(<span class="fu">median</span>(eav_postexemptions)), </span>
<span id="cb18-251"><a href="#cb18-251" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_av =</span> <span class="fu">round</span>(<span class="fu">median</span>(av)), </span>
<span id="cb18-252"><a href="#cb18-252" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_av =</span> <span class="fu">round</span>(<span class="fu">mean</span>(av)),</span>
<span id="cb18-253"><a href="#cb18-253" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_eav =</span> <span class="fu">round</span>(<span class="fu">mean</span>(eav_postexemptions)),</span>
<span id="cb18-254"><a href="#cb18-254" aria-hidden="true" tabindex="-1"></a>    <span class="at">C2_pins_in_muni =</span> <span class="fu">n</span>(),</span>
<span id="cb18-255"><a href="#cb18-255" aria-hidden="true" tabindex="-1"></a>    <span class="at">C2_current_exemptions =</span> <span class="fu">sum</span>(all_exemptions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-256"><a href="#cb18-256" aria-hidden="true" tabindex="-1"></a>    <span class="at">C2_HO_exemps =</span> <span class="fu">sum</span>(exe_homeowner, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-257"><a href="#cb18-257" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb18-258"><a href="#cb18-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-259"><a href="#cb18-259" aria-hidden="true" tabindex="-1"></a><span class="co"># All Class 2 Properties</span></span>
<span id="cb18-260"><a href="#cb18-260" aria-hidden="true" tabindex="-1"></a>munis_ranked <span class="ot">&lt;-</span> c2pins  <span class="sc">%&gt;%</span></span>
<span id="cb18-261"><a href="#cb18-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(muni_quartiles, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"clean_name"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-262"><a href="#cb18-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-263"><a href="#cb18-263" aria-hidden="true" tabindex="-1"></a>   av <span class="sc">&gt;</span> (quant10<span class="dv">-500</span>) <span class="sc">&amp;</span> (av<span class="sc">&lt;</span>quant10<span class="sc">+</span><span class="dv">500</span>) <span class="sc">~</span> <span class="st">"q10"</span>,</span>
<span id="cb18-264"><a href="#cb18-264" aria-hidden="true" tabindex="-1"></a>    av <span class="sc">&gt;</span> (quant25<span class="dv">-500</span>) <span class="sc">&amp;</span> (av<span class="sc">&lt;</span>quant25<span class="sc">+</span><span class="dv">500</span>) <span class="sc">~</span> <span class="st">"q25"</span>,</span>
<span id="cb18-265"><a href="#cb18-265" aria-hidden="true" tabindex="-1"></a>    av <span class="sc">&gt;</span> (quant50<span class="dv">-500</span>) <span class="sc">&amp;</span> (av<span class="sc">&lt;</span>quant50<span class="sc">+</span><span class="dv">500</span>) <span class="sc">~</span> <span class="st">"q50"</span>,</span>
<span id="cb18-266"><a href="#cb18-266" aria-hidden="true" tabindex="-1"></a>    av <span class="sc">&gt;</span> (quant75<span class="dv">-500</span>) <span class="sc">&amp;</span> (av<span class="sc">&lt;</span>quant75<span class="sc">+</span><span class="dv">500</span>) <span class="sc">~</span> <span class="st">"q75"</span>,</span>
<span id="cb18-267"><a href="#cb18-267" aria-hidden="true" tabindex="-1"></a>    av <span class="sc">&gt;</span> (quant90<span class="dv">-500</span>) <span class="sc">&amp;</span> (av<span class="sc">&lt;</span>quant90<span class="sc">+</span><span class="dv">500</span>) <span class="sc">~</span> <span class="st">"q90"</span>)</span>
<span id="cb18-268"><a href="#cb18-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-269"><a href="#cb18-269" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb18-270"><a href="#cb18-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(clean_name, rank, av, pin, class, <span class="fu">everything</span>())</span>
<span id="cb18-271"><a href="#cb18-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-274"><a href="#cb18-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-275"><a href="#cb18-275" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb18-276"><a href="#cb18-276" aria-hidden="true" tabindex="-1"></a><span class="co"># #| tbl-cap: "Median AV Class 2 property by Municipality"</span></span>
<span id="cb18-277"><a href="#cb18-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-278"><a href="#cb18-278" aria-hidden="true" tabindex="-1"></a>C2_munistats <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(nicknames) <span class="sc">%&gt;%</span></span>
<span id="cb18-279"><a href="#cb18-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(clean_name, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(agency_name, agency_number))</span>
<span id="cb18-280"><a href="#cb18-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-281"><a href="#cb18-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-282"><a href="#cb18-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-283"><a href="#cb18-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-284"><a href="#cb18-284" aria-hidden="true" tabindex="-1"></a><span class="fu">## Which taxpayers benefit the most from homestead exemptions?</span></span>
<span id="cb18-285"><a href="#cb18-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-286"><a href="#cb18-286" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 1. Comparison of Tax Bills for Median Assessed Value (AV) Class 2 Properties in Selected Municpalities under the Status Quo and Alternative Scenario</span></span>
<span id="cb18-287"><a href="#cb18-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-288"><a href="#cb18-288" aria-hidden="true" tabindex="-1"></a>Assessed Value is used to identify the quartile breaks within each municipality for single-family properties. These break points will then be used to look at how the tax bill changes for properties with AVs at the 25th percentile, 50th percentile, and 75th percentile.</span>
<span id="cb18-289"><a href="#cb18-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-290"><a href="#cb18-290" aria-hidden="true" tabindex="-1"></a>The assessed value and original equalized assessed values come from the <span class="in">`pin`</span> data table within PTAXSIM. This table also has every type of exemption that the property received and the amount of EAV that was exempt due to the exemption.</span>
<span id="cb18-291"><a href="#cb18-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-294"><a href="#cb18-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-295"><a href="#cb18-295" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-taxbillchange</span></span>
<span id="cb18-296"><a href="#cb18-296" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "**Figure 2** The median property was found for all Class 2 properties and used to calculate the hypothetical tax bill change for those that do and do not claim the GHE. It is important to note that almost all municipalities have a median AV for those that do claim the GHE that is quite different from those that do not claim the GHE."</span></span>
<span id="cb18-297"><a href="#cb18-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-298"><a href="#cb18-298" aria-hidden="true" tabindex="-1"></a>tax_bill_change_HO <span class="ot">&lt;-</span> c2pins <span class="sc">%&gt;%</span> </span>
<span id="cb18-299"><a href="#cb18-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(av <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-300"><a href="#cb18-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(av) <span class="sc">%&gt;%</span></span>
<span id="cb18-301"><a href="#cb18-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eq_av =</span> av_clerk<span class="sc">*</span>eq_factor,</span>
<span id="cb18-302"><a href="#cb18-302" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_current =</span> (eav_postexemptions<span class="sc">*</span>tax_code_rate),</span>
<span id="cb18-303"><a href="#cb18-303" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_noexemps =</span>  tc_hyp_taxrate<span class="sc">*</span>(eav_postexemptions<span class="sc">+</span>exe_homeowner),</span>
<span id="cb18-304"><a href="#cb18-304" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_change =</span> bill_noexemps <span class="sc">-</span> bill_current) <span class="sc">%&gt;%</span></span>
<span id="cb18-305"><a href="#cb18-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name, has_HO_exe) <span class="sc">%&gt;%</span> </span>
<span id="cb18-306"><a href="#cb18-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_AV =</span> <span class="fu">median</span>(av),</span>
<span id="cb18-307"><a href="#cb18-307" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_EAV =</span> <span class="fu">median</span>(eav_postexemptions),</span>
<span id="cb18-308"><a href="#cb18-308" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_bill_cur =</span> <span class="fu">round</span>(<span class="fu">median</span>(bill_current)),</span>
<span id="cb18-309"><a href="#cb18-309" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_bill_new =</span> <span class="fu">round</span>(<span class="fu">median</span>(bill_noexemps)),</span>
<span id="cb18-310"><a href="#cb18-310" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_change =</span> <span class="fu">round</span>(<span class="fu">median</span>(bill_change)),</span>
<span id="cb18-311"><a href="#cb18-311" aria-hidden="true" tabindex="-1"></a>            <span class="at">pincount=</span><span class="fu">n</span>(),</span>
<span id="cb18-312"><a href="#cb18-312" aria-hidden="true" tabindex="-1"></a>            <span class="at">perceived_savings =</span> <span class="fu">median</span>(exe_homeowner<span class="sc">*</span>tax_code_rate)</span>
<span id="cb18-313"><a href="#cb18-313" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-314"><a href="#cb18-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-315"><a href="#cb18-315" aria-hidden="true" tabindex="-1"></a>tax_bill_change_HO <span class="sc">|&gt;</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Phoenix"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Riverdale"</span>))</span>
<span id="cb18-316"><a href="#cb18-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-317"><a href="#cb18-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-318"><a href="#cb18-318" aria-hidden="true" tabindex="-1"></a>_The table created from the code calculates the median AV for those with exemptions and those without exemptions. Usually these values are significantly different. In the Report, the table was simplified to show the save assessed value for both types of homeowners (See image of table pasted below)._ </span>
<span id="cb18-319"><a href="#cb18-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-320"><a href="#cb18-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-321"><a href="#cb18-321" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/clipboard-3760892845.png)</span></span>
<span id="cb18-322"><a href="#cb18-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-323"><a href="#cb18-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-324"><a href="#cb18-324" aria-hidden="true" tabindex="-1"></a>_Notes: AV = Assessed Value. "Tax Calculator" reduction refers to the section of the tax bill received by property tax payers (See Figure 1). It does not take into account changes in property tax rates due to the larger taxbase that would come from having a larger tax base. Figures in columns titled Current Bill, Tax Bill without GHE, and "Tax Calculator" Reduction in Tax Liability are estimated using an average of the properties with AV within $1,000 of the municipality median in order to enlarge the number of observations therefore do not precisely represent the median figure._ </span>
<span id="cb18-325"><a href="#cb18-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-326"><a href="#cb18-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-327"><a href="#cb18-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-328"><a href="#cb18-328" aria-hidden="true" tabindex="-1"></a><span class="fu">### Figure 1. Examples of Actual Tax Bills</span></span>
<span id="cb18-329"><a href="#cb18-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-330"><a href="#cb18-330" aria-hidden="true" tabindex="-1"></a>**Park Forest vs. Winnetka**</span>
<span id="cb18-331"><a href="#cb18-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-332"><a href="#cb18-332" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/clipboard-3418026779.png)</span>{width="300"}</span>
<span id="cb18-333"><a href="#cb18-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-334"><a href="#cb18-334" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/clipboard-3189035135.png)</span>{width="300"}</span>
<span id="cb18-335"><a href="#cb18-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-336"><a href="#cb18-336" aria-hidden="true" tabindex="-1"></a><span class="fu">### Figure 2. Value of Median Residential Property Indifferent to Elimination of GHE</span></span>
<span id="cb18-337"><a href="#cb18-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-338"><a href="#cb18-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-339"><a href="#cb18-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r create-muni_breakeven_points}</span></span>
<span id="cb18-340"><a href="#cb18-340" aria-hidden="true" tabindex="-1"></a><span class="in">muni_breakeven_points &lt;- c2pins |&gt;</span></span>
<span id="cb18-341"><a href="#cb18-341" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(muni_rates) |&gt;</span></span>
<span id="cb18-342"><a href="#cb18-342" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(exe_homeowner == 10000) %&gt;% </span></span>
<span id="cb18-343"><a href="#cb18-343" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(exe_senior == 0 &amp; </span></span>
<span id="cb18-344"><a href="#cb18-344" aria-hidden="true" tabindex="-1"></a><span class="in">           exe_freeze == 0 &amp; </span></span>
<span id="cb18-345"><a href="#cb18-345" aria-hidden="true" tabindex="-1"></a><span class="in">           exe_longtime_homeowner == 0 &amp; </span></span>
<span id="cb18-346"><a href="#cb18-346" aria-hidden="true" tabindex="-1"></a><span class="in">           exe_disabled == 0 &amp; </span></span>
<span id="cb18-347"><a href="#cb18-347" aria-hidden="true" tabindex="-1"></a><span class="in">           exe_vet_returning == 0 &amp; </span></span>
<span id="cb18-348"><a href="#cb18-348" aria-hidden="true" tabindex="-1"></a><span class="in">           exe_vet_dis_lt50 == 0 &amp; </span></span>
<span id="cb18-349"><a href="#cb18-349" aria-hidden="true" tabindex="-1"></a><span class="in">           exe_vet_dis_50_69 == 0 &amp; </span></span>
<span id="cb18-350"><a href="#cb18-350" aria-hidden="true" tabindex="-1"></a><span class="in">           exe_vet_dis_ge70 == 0 &amp; </span></span>
<span id="cb18-351"><a href="#cb18-351" aria-hidden="true" tabindex="-1"></a><span class="in">           exe_abate == 0) %&gt;%</span></span>
<span id="cb18-352"><a href="#cb18-352" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb18-353"><a href="#cb18-353" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(clean_name) %&gt;%</span></span>
<span id="cb18-354"><a href="#cb18-354" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(</span></span>
<span id="cb18-355"><a href="#cb18-355" aria-hidden="true" tabindex="-1"></a><span class="in">    median_AV = median(av),     # median class 2 AV for properties that did claim the GHE but not other exemptions</span></span>
<span id="cb18-356"><a href="#cb18-356" aria-hidden="true" tabindex="-1"></a><span class="in">    bill_current = mean(eav_postexemptions * tax_code_rate), # money collected by non-TIF agencies</span></span>
<span id="cb18-357"><a href="#cb18-357" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb18-358"><a href="#cb18-358" aria-hidden="true" tabindex="-1"></a><span class="in">    bill_noGHE = mean(tc_hyp_taxrate * (eav_postexemptions+exe_homeowner)), # this uses tax code tax rate</span></span>
<span id="cb18-359"><a href="#cb18-359" aria-hidden="true" tabindex="-1"></a><span class="in">    rate_change = mean(tax_code_rate - tc_hyp_taxrate),   # avg tax code level rate change </span></span>
<span id="cb18-360"><a href="#cb18-360" aria-hidden="true" tabindex="-1"></a><span class="in">    muni_avg_rate_change = mean(muni_avg_rate - muni_hyp_taxrate),</span></span>
<span id="cb18-361"><a href="#cb18-361" aria-hidden="true" tabindex="-1"></a><span class="in">    nobillchange_propertyEAV = round(mean(exe_homeowner * </span></span>
<span id="cb18-362"><a href="#cb18-362" aria-hidden="true" tabindex="-1"></a><span class="in">                                            (tax_code_rate / (tax_code_rate-tc_hyp_taxrate)))), #   </span></span>
<span id="cb18-363"><a href="#cb18-363" aria-hidden="true" tabindex="-1"></a><span class="in">    nobillchange_propertyEAV_muni = round(mean(exe_homeowner *</span></span>
<span id="cb18-364"><a href="#cb18-364" aria-hidden="true" tabindex="-1"></a><span class="in">                                                 (muni_avg_rate/(muni_avg_rate-muni_hyp_taxrate) )))</span></span>
<span id="cb18-365"><a href="#cb18-365" aria-hidden="true" tabindex="-1"></a><span class="in">  ) |&gt; </span></span>
<span id="cb18-366"><a href="#cb18-366" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(nochange_av = nobillchange_propertyEAV / eq_factor,</span></span>
<span id="cb18-367"><a href="#cb18-367" aria-hidden="true" tabindex="-1"></a><span class="in">         nochange_av_muni = nobillchange_propertyEAV_muni/ eq_factor,</span></span>
<span id="cb18-368"><a href="#cb18-368" aria-hidden="true" tabindex="-1"></a><span class="in">         ) </span></span>
<span id="cb18-369"><a href="#cb18-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-370"><a href="#cb18-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-371"><a href="#cb18-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-372"><a href="#cb18-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-373"><a href="#cb18-373" aria-hidden="true" tabindex="-1"></a><span class="in">muni_breakeven_points %&gt;%       </span></span>
<span id="cb18-374"><a href="#cb18-374" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(clean_name %in% c("Chicago","Park Forest", "Phoenix", "Riverdale", "Winnetka")) |&gt;</span></span>
<span id="cb18-375"><a href="#cb18-375" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=median_AV, x = clean_name)) +</span></span>
<span id="cb18-376"><a href="#cb18-376" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col()+</span></span>
<span id="cb18-377"><a href="#cb18-377" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_text(aes(y=median_AV + 3000, label = round(median_AV) ) ) +</span></span>
<span id="cb18-378"><a href="#cb18-378" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(labels = scales::dollar) +</span></span>
<span id="cb18-379"><a href="#cb18-379" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic() +</span></span>
<span id="cb18-380"><a href="#cb18-380" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(label = c("Chicago","Park Forest", "Phoenix", "Riverdale", "Winnetka")) + </span></span>
<span id="cb18-381"><a href="#cb18-381" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y = "Median Residential AV", x = "", </span></span>
<span id="cb18-382"><a href="#cb18-382" aria-hidden="true" tabindex="-1"></a><span class="in">       title = "Median Residential Property Assessed Value - All Class 2 property Types")</span></span>
<span id="cb18-383"><a href="#cb18-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-384"><a href="#cb18-384" aria-hidden="true" tabindex="-1"></a><span class="in">muni_breakeven_points %&gt;%       </span></span>
<span id="cb18-385"><a href="#cb18-385" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(clean_name %in% c("Chicago","Park Forest", "Phoenix", "Riverdale", "Winnetka")) |&gt;</span></span>
<span id="cb18-386"><a href="#cb18-386" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y=nochange_av, x = clean_name)) +</span></span>
<span id="cb18-387"><a href="#cb18-387" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col() +</span></span>
<span id="cb18-388"><a href="#cb18-388" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text(aes(y=nochange_av + 3000, label = round(nochange_av)) ) +</span></span>
<span id="cb18-389"><a href="#cb18-389" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(labels = scales::dollar) +</span></span>
<span id="cb18-390"><a href="#cb18-390" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic() +</span></span>
<span id="cb18-391"><a href="#cb18-391" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(label = c("Chicago", "Park Forest", "Phoenix", "Riverdale", "Winnetka")) + </span></span>
<span id="cb18-392"><a href="#cb18-392" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y = "Breakeven Point - AV", x = "", </span></span>
<span id="cb18-393"><a href="#cb18-393" aria-hidden="true" tabindex="-1"></a><span class="in">  title = "Residential Property AV Breakeven Point", </span></span>
<span id="cb18-394"><a href="#cb18-394" aria-hidden="true" tabindex="-1"></a><span class="in">  caption = "Residential properties above these values would have their bills decrease if the GHE were eliminated</span></span>
<span id="cb18-395"><a href="#cb18-395" aria-hidden="true" tabindex="-1"></a><span class="in">       (if they had claimed the GHE before)")</span></span>
<span id="cb18-396"><a href="#cb18-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-397"><a href="#cb18-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-398"><a href="#cb18-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-401"><a href="#cb18-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-402"><a href="#cb18-402" aria-hidden="true" tabindex="-1"></a><span class="co">#|include: false</span></span>
<span id="cb18-403"><a href="#cb18-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-404"><a href="#cb18-404" aria-hidden="true" tabindex="-1"></a><span class="do">## Doesn't make bars / doesn't work. idk why ?? I don't need it, I just don't know why it doesn't work. </span></span>
<span id="cb18-405"><a href="#cb18-405" aria-hidden="true" tabindex="-1"></a>muni_breakeven_points <span class="sc">%&gt;%</span>       </span>
<span id="cb18-406"><a href="#cb18-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>,<span class="st">"Park Forest"</span>, <span class="st">"Phoenix"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Winnetka"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-407"><a href="#cb18-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>nochange_av_muni, <span class="at">x =</span> clean_name)) <span class="sc">+</span></span>
<span id="cb18-408"><a href="#cb18-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb18-409"><a href="#cb18-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y=</span>nochange_av_muni <span class="sc">+</span> <span class="dv">3000</span>, <span class="at">label =</span> <span class="fu">round</span>(nochange_av_muni)) ) <span class="sc">+</span></span>
<span id="cb18-410"><a href="#cb18-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb18-411"><a href="#cb18-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb18-412"><a href="#cb18-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>, <span class="st">"Park Forest"</span>, <span class="st">"Phoenix"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Winnetka"</span>)) <span class="sc">+</span> </span>
<span id="cb18-413"><a href="#cb18-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Breakeven Point - AV"</span>, <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb18-414"><a href="#cb18-414" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Residential Property AV Breakeven Point"</span>, </span>
<span id="cb18-415"><a href="#cb18-415" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Residential properties above these values would have their bills decrease if the GHE were eliminated</span></span>
<span id="cb18-416"><a href="#cb18-416" aria-hidden="true" tabindex="-1"></a><span class="st">       (if they had claimed the GHE before)"</span>)</span>
<span id="cb18-417"><a href="#cb18-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-418"><a href="#cb18-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-419"><a href="#cb18-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-420"><a href="#cb18-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-423"><a href="#cb18-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-424"><a href="#cb18-424" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-breakevenToAV-notfiltered</span></span>
<span id="cb18-425"><a href="#cb18-425" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb18-426"><a href="#cb18-426" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Includes all municipalities"</span></span>
<span id="cb18-427"><a href="#cb18-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-428"><a href="#cb18-428" aria-hidden="true" tabindex="-1"></a>muni_breakeven_points <span class="sc">%&gt;%</span></span>
<span id="cb18-429"><a href="#cb18-429" aria-hidden="true" tabindex="-1"></a> <span class="co"># filter(nochange_av &lt; 300000) %&gt;%</span></span>
<span id="cb18-430"><a href="#cb18-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>nochange_av, </span>
<span id="cb18-431"><a href="#cb18-431" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> median_AV, </span>
<span id="cb18-432"><a href="#cb18-432" aria-hidden="true" tabindex="-1"></a>             <span class="at">label=</span>clean_name</span>
<span id="cb18-433"><a href="#cb18-433" aria-hidden="true" tabindex="-1"></a>             )) <span class="sc">+</span></span>
<span id="cb18-434"><a href="#cb18-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb18-435"><a href="#cb18-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb18-436"><a href="#cb18-436" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_smooth(method = "lm" )+</span></span>
<span id="cb18-437"><a href="#cb18-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> (nochange_av<span class="dv">-5000</span>), <span class="at">x =</span> (median_AV)), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb18-438"><a href="#cb18-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb18-439"><a href="#cb18-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb18-440"><a href="#cb18-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb18-441"><a href="#cb18-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb18-442"><a href="#cb18-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">" Breakeven Point"</span>, </span>
<span id="cb18-443"><a href="#cb18-443" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Median AV - Class 2 Properties in Municipality"</span>, </span>
<span id="cb18-444"><a href="#cb18-444" aria-hidden="true" tabindex="-1"></a>      <span class="co"># title = "Some highly valued homes would have lower tax bills if the GHE were eliminated", </span></span>
<span id="cb18-445"><a href="#cb18-445" aria-hidden="true" tabindex="-1"></a>       <span class="co">#caption = "The breakeven point is the assessed values at which a major class 2 </span></span>
<span id="cb18-446"><a href="#cb18-446" aria-hidden="true" tabindex="-1"></a>     <span class="co">#  property would not have their taxbill change if the GHE were eliminated."</span></span>
<span id="cb18-447"><a href="#cb18-447" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb18-448"><a href="#cb18-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-449"><a href="#cb18-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-452"><a href="#cb18-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-453"><a href="#cb18-453" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-Figure2</span></span>
<span id="cb18-454"><a href="#cb18-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Breakeven Point ... "</span></span>
<span id="cb18-455"><a href="#cb18-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-456"><a href="#cb18-456" aria-hidden="true" tabindex="-1"></a>muni_breakeven_points <span class="sc">%&gt;%</span></span>
<span id="cb18-457"><a href="#cb18-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nochange_av <span class="sc">&lt;</span> <span class="dv">300000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-458"><a href="#cb18-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>nochange_av, </span>
<span id="cb18-459"><a href="#cb18-459" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> median_AV, </span>
<span id="cb18-460"><a href="#cb18-460" aria-hidden="true" tabindex="-1"></a>             <span class="at">label=</span>clean_name</span>
<span id="cb18-461"><a href="#cb18-461" aria-hidden="true" tabindex="-1"></a>             )) <span class="sc">+</span></span>
<span id="cb18-462"><a href="#cb18-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb18-463"><a href="#cb18-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-464"><a href="#cb18-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb18-465"><a href="#cb18-465" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-466"><a href="#cb18-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> (muni_breakeven_points <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Riverdale"</span>,<span class="st">"Dolton"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> nochange_av, <span class="at">x =</span> median_AV, <span class="at">color =</span> <span class="st">"red"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-467"><a href="#cb18-467" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">data =</span> (muni_breakeven_points <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> (nochange_av), <span class="at">x =</span> (median_AV)), <span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb18-468"><a href="#cb18-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb18-469"><a href="#cb18-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb18-470"><a href="#cb18-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">170000</span>) ) <span class="sc">+</span></span>
<span id="cb18-471"><a href="#cb18-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">170000</span>) ) <span class="sc">+</span></span>
<span id="cb18-472"><a href="#cb18-472" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb18-473"><a href="#cb18-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-474"><a href="#cb18-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Municipalities' Median AV &amp; Breakeven Point </span><span class="sc">\n</span><span class="st">Class 2 Properties Only"</span>,</span>
<span id="cb18-475"><a href="#cb18-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Breakeven Point"</span>, </span>
<span id="cb18-476"><a href="#cb18-476" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Median AV"</span>, </span>
<span id="cb18-477"><a href="#cb18-477" aria-hidden="true" tabindex="-1"></a> <span class="co"># caption = "The breakeven point is the assessed values at which a major class 2 property would not have their taxbill change if the </span></span>
<span id="cb18-478"><a href="#cb18-478" aria-hidden="true" tabindex="-1"></a> <span class="co"># GHE were eliminated. Excludes outliers: University Park, Bedford Park, McCook, Hodgkins, and Rosemont. Class 2 properties that had</span></span>
<span id="cb18-479"><a href="#cb18-479" aria-hidden="true" tabindex="-1"></a> <span class="co"># claimed the GHE would have lower taxbills even if the GHE were removed if the AV is above the breakeven point."</span></span>
<span id="cb18-480"><a href="#cb18-480" aria-hidden="true" tabindex="-1"></a> ) <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span>
<span id="cb18-481"><a href="#cb18-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-482"><a href="#cb18-482" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave("breakevenpoint.svg", bg = "transparent")</span></span>
<span id="cb18-483"><a href="#cb18-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-484"><a href="#cb18-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-485"><a href="#cb18-485" aria-hidden="true" tabindex="-1"></a><span class="fu">## How progressive are exemptions?</span></span>
<span id="cb18-486"><a href="#cb18-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-487"><a href="#cb18-487" aria-hidden="true" tabindex="-1"></a><span class="fu">### Figure 3. Ratio of Tax Bills to AV for 25th and 75th Percentile AV Class 2 Properties with \$10,000 GHE</span></span>
<span id="cb18-488"><a href="#cb18-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-489"><a href="#cb18-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-490"><a href="#cb18-490" aria-hidden="true" tabindex="-1"></a>For the different exemption scenarios, we created new exemption variables for alternate exemption amounts that can be subtracted from a properties equalized AV.</span>
<span id="cb18-491"><a href="#cb18-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-492"><a href="#cb18-492" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>ex. For <span class="in">`exe_neg10`</span> all exemption amounts are equal to zero.</span>
<span id="cb18-493"><a href="#cb18-493" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For <span class="in">`exe_0`</span>, This variable should be the same as the current tax system since we did not add or remove any exempt EAV to the PIN. If the EAV for a PIN is less than 10000 EAV and they did claim the general homestead exemption, then their exempt EAV is equal to their EAV.</span>
<span id="cb18-494"><a href="#cb18-494" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If the exempt EAV allowable for the GHE was increased to 20,000 EAV, then the variable <span class="in">`exe_plus10`</span> is used.</span>
<span id="cb18-495"><a href="#cb18-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-496"><a href="#cb18-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r increase-exemptions-hypotheticals}</span></span>
<span id="cb18-497"><a href="#cb18-497" aria-hidden="true" tabindex="-1"></a><span class="in">cook_pins &lt;- cook_pins %&gt;% </span></span>
<span id="cb18-498"><a href="#cb18-498" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(class_dict, by = c("class" = "class_code")) %&gt;%</span></span>
<span id="cb18-499"><a href="#cb18-499" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(has_HO_exe = ifelse( exe_homeowner &gt; 0, 1, 0),</span></span>
<span id="cb18-500"><a href="#cb18-500" aria-hidden="true" tabindex="-1"></a><span class="in">         has_other_exe = ifelse(exe_senior + exe_freeze + exe_longtime_homeowner + exe_disabled + exe_vet_returning + exe_vet_dis_lt50 + exe_vet_dis_50_69 + exe_vet_dis_ge70 &gt; 0, 1, 0 )) %&gt;% </span></span>
<span id="cb18-501"><a href="#cb18-501" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tax_codes) |&gt;</span></span>
<span id="cb18-502"><a href="#cb18-502" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tc_muninames) %&gt;%</span></span>
<span id="cb18-503"><a href="#cb18-503" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(av = av_clerk) |&gt;</span></span>
<span id="cb18-504"><a href="#cb18-504" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tax_code_change) |&gt;</span></span>
<span id="cb18-505"><a href="#cb18-505" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tif_distribution) |&gt;</span></span>
<span id="cb18-506"><a href="#cb18-506" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb18-507"><a href="#cb18-507" aria-hidden="true" tabindex="-1"></a><span class="in">    tax_code_distribution_pct = ifelse(is.na(tax_code_distribution_pct), 0, tax_code_distribution_pct),</span></span>
<span id="cb18-508"><a href="#cb18-508" aria-hidden="true" tabindex="-1"></a><span class="in">    in_tif = ifelse(tax_code_num %in% tif_distribution$tax_code_num, 1, 0),</span></span>
<span id="cb18-509"><a href="#cb18-509" aria-hidden="true" tabindex="-1"></a><span class="in">    has_HO_exe = ifelse(exe_homeowner &gt; 0, 1, 0),</span></span>
<span id="cb18-510"><a href="#cb18-510" aria-hidden="true" tabindex="-1"></a><span class="in">    has_other_exe = ifelse(exe_senior + exe_freeze + exe_longtime_homeowner + exe_disabled +</span></span>
<span id="cb18-511"><a href="#cb18-511" aria-hidden="true" tabindex="-1"></a><span class="in">                             exe_vet_returning + exe_vet_dis_lt50 + exe_vet_dis_50_69 + </span></span>
<span id="cb18-512"><a href="#cb18-512" aria-hidden="true" tabindex="-1"></a><span class="in">                             exe_vet_dis_ge70 &gt; 0, 1, 0 ),</span></span>
<span id="cb18-513"><a href="#cb18-513" aria-hidden="true" tabindex="-1"></a><span class="in">    all_exemptions = rowSums(across(starts_with("exe_"))),</span></span>
<span id="cb18-514"><a href="#cb18-514" aria-hidden="true" tabindex="-1"></a><span class="in">    final_tax_to_tif = tax_bill_total *  tax_code_distribution_pct,</span></span>
<span id="cb18-515"><a href="#cb18-515" aria-hidden="true" tabindex="-1"></a><span class="in">    final_tax_to_dist = tax_bill_total-final_tax_to_tif,</span></span>
<span id="cb18-516"><a href="#cb18-516" aria-hidden="true" tabindex="-1"></a><span class="in">    tif_increment_eav = final_tax_to_tif / tax_code_rate,</span></span>
<span id="cb18-517"><a href="#cb18-517" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb18-518"><a href="#cb18-518" aria-hidden="true" tabindex="-1"></a><span class="in">    nontif_eav_preexe = av_clerk*eq_factor - tif_increment_eav,</span></span>
<span id="cb18-519"><a href="#cb18-519" aria-hidden="true" tabindex="-1"></a><span class="in">    nontif_eav_postexe = av_clerk*eq_factor - tif_increment_eav - all_exemptions,</span></span>
<span id="cb18-520"><a href="#cb18-520" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb18-521"><a href="#cb18-521" aria-hidden="true" tabindex="-1"></a><span class="in">    eav_postexemptions = av_clerk*eq_factor - all_exemptions,</span></span>
<span id="cb18-522"><a href="#cb18-522" aria-hidden="true" tabindex="-1"></a><span class="in">    eav_preexemptions = av_clerk*eq_factor) |&gt;</span></span>
<span id="cb18-523"><a href="#cb18-523" aria-hidden="true" tabindex="-1"></a><span class="in">  ## Create variables for alternate exemption amounts that can be subtracted from a properties equalized AV</span></span>
<span id="cb18-524"><a href="#cb18-524" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb18-525"><a href="#cb18-525" aria-hidden="true" tabindex="-1"></a><span class="in">    eav = eav_preexemptions,</span></span>
<span id="cb18-526"><a href="#cb18-526" aria-hidden="true" tabindex="-1"></a><span class="in">    exe_neg10 = 0,</span></span>
<span id="cb18-527"><a href="#cb18-527" aria-hidden="true" tabindex="-1"></a><span class="in">         </span></span>
<span id="cb18-528"><a href="#cb18-528" aria-hidden="true" tabindex="-1"></a><span class="in">      # exe_0 implies no additional or removed EAV. Current tax system. </span></span>
<span id="cb18-529"><a href="#cb18-529" aria-hidden="true" tabindex="-1"></a><span class="in">         exe_0 = ifelse(eav &lt; 10000 &amp; exe_homeowner!=0, eav, </span></span>
<span id="cb18-530"><a href="#cb18-530" aria-hidden="true" tabindex="-1"></a><span class="in">                             ifelse(eav&gt;10000 &amp; exe_homeowner!=0, 10000, 0 )),  # no change in current exemptions</span></span>
<span id="cb18-531"><a href="#cb18-531" aria-hidden="true" tabindex="-1"></a><span class="in">         exe_plus10 = ifelse(eav &lt; 20000 &amp; exe_homeowner!=0, eav, </span></span>
<span id="cb18-532"><a href="#cb18-532" aria-hidden="true" tabindex="-1"></a><span class="in">                             ifelse(eav&gt;20000 &amp; exe_homeowner!=0, 20000, 0 )),</span></span>
<span id="cb18-533"><a href="#cb18-533" aria-hidden="true" tabindex="-1"></a><span class="in">         exe_plus20 = ifelse(eav &lt; 30000 &amp; exe_homeowner!=0, eav, </span></span>
<span id="cb18-534"><a href="#cb18-534" aria-hidden="true" tabindex="-1"></a><span class="in">                             ifelse(eav&gt;30000 &amp; exe_homeowner!=0, 30000, 0 ) ),</span></span>
<span id="cb18-535"><a href="#cb18-535" aria-hidden="true" tabindex="-1"></a><span class="in">         exe_plus30 = ifelse(eav &lt; 40000 &amp; exe_homeowner!=0, eav, </span></span>
<span id="cb18-536"><a href="#cb18-536" aria-hidden="true" tabindex="-1"></a><span class="in">                             ifelse(eav&gt;40000 &amp; exe_homeowner!=0, 40000, 0) ),</span></span>
<span id="cb18-537"><a href="#cb18-537" aria-hidden="true" tabindex="-1"></a><span class="in">         exe_plus40 = ifelse(eav &lt; 50000 &amp; exe_homeowner!=0, eav, </span></span>
<span id="cb18-538"><a href="#cb18-538" aria-hidden="true" tabindex="-1"></a><span class="in">                             ifelse(eav&gt;50000 &amp; exe_homeowner!=0, 50000, 0) ),</span></span>
<span id="cb18-539"><a href="#cb18-539" aria-hidden="true" tabindex="-1"></a><span class="in">         mil_home = ifelse(major_class_code == 2 &amp; av*10 &gt; 1000000, 1, 0))</span></span>
<span id="cb18-540"><a href="#cb18-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-541"><a href="#cb18-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-542"><a href="#cb18-542" aria-hidden="true" tabindex="-1"></a><span class="in"># all pins in munis fully within cook county that are some form of single-family, detached home</span></span>
<span id="cb18-543"><a href="#cb18-543" aria-hidden="true" tabindex="-1"></a><span class="in">singfam_pins &lt;- cook_pins %&gt;% </span></span>
<span id="cb18-544"><a href="#cb18-544" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Option2 == "Single-Family")</span></span>
<span id="cb18-545"><a href="#cb18-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-546"><a href="#cb18-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-547"><a href="#cb18-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-548"><a href="#cb18-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-549"><a href="#cb18-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r scenario-calculations}</span></span>
<span id="cb18-550"><a href="#cb18-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-551"><a href="#cb18-551" aria-hidden="true" tabindex="-1"></a><span class="in"># Calculates tax rates for all exemption scenarios.</span></span>
<span id="cb18-552"><a href="#cb18-552" aria-hidden="true" tabindex="-1"></a><span class="in">scenario_calcs &lt;- cook_pins %&gt;%    </span></span>
<span id="cb18-553"><a href="#cb18-553" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(nicknames) %&gt;%</span></span>
<span id="cb18-554"><a href="#cb18-554" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(clean_name) %&gt;%</span></span>
<span id="cb18-555"><a href="#cb18-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-556"><a href="#cb18-556" aria-hidden="true" tabindex="-1"></a><span class="in">    summarize(MuniLevy = sum(final_tax_to_dist, na.rm = TRUE), # amount billed by munis with current exemptions in place</span></span>
<span id="cb18-557"><a href="#cb18-557" aria-hidden="true" tabindex="-1"></a><span class="in">            current_nonTIF_EAV_post_exemps = sum(final_tax_to_dist/(tax_code_rate), na.rm = TRUE),</span></span>
<span id="cb18-558"><a href="#cb18-558" aria-hidden="true" tabindex="-1"></a><span class="in">            current_TIF_increment_EAV = sum(final_tax_to_tif/(tax_code_rate), na.rm=TRUE),  </span></span>
<span id="cb18-559"><a href="#cb18-559" aria-hidden="true" tabindex="-1"></a><span class="in">            current_Exempt_EAV = sum(all_exemptions, na.rm=T), </span></span>
<span id="cb18-560"><a href="#cb18-560" aria-hidden="true" tabindex="-1"></a><span class="in">            current_GHE = sum(exe_homeowner, na.rm=TRUE),</span></span>
<span id="cb18-561"><a href="#cb18-561" aria-hidden="true" tabindex="-1"></a><span class="in">            Total_EAV = sum(all_exemptions+(final_tax_to_dist+final_tax_to_tif)/(tax_code_rate), na.rm = TRUE),</span></span>
<span id="cb18-562"><a href="#cb18-562" aria-hidden="true" tabindex="-1"></a><span class="in">            exe_neg10 = sum(exe_neg10),</span></span>
<span id="cb18-563"><a href="#cb18-563" aria-hidden="true" tabindex="-1"></a><span class="in">            exe_0 = sum(exe_0), # no change, for comparison</span></span>
<span id="cb18-564"><a href="#cb18-564" aria-hidden="true" tabindex="-1"></a><span class="in">            exe_plus10 = sum(exe_plus10),</span></span>
<span id="cb18-565"><a href="#cb18-565" aria-hidden="true" tabindex="-1"></a><span class="in">            exe_plus20 = sum(exe_plus20),</span></span>
<span id="cb18-566"><a href="#cb18-566" aria-hidden="true" tabindex="-1"></a><span class="in">            exe_plus30 = sum(exe_plus30),</span></span>
<span id="cb18-567"><a href="#cb18-567" aria-hidden="true" tabindex="-1"></a><span class="in">            exe_plus40 = sum(exe_plus40),</span></span>
<span id="cb18-568"><a href="#cb18-568" aria-hidden="true" tabindex="-1"></a><span class="in">            mil_home = sum(mil_home)</span></span>
<span id="cb18-569"><a href="#cb18-569" aria-hidden="true" tabindex="-1"></a><span class="in">            ) %&gt;%</span></span>
<span id="cb18-570"><a href="#cb18-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-571"><a href="#cb18-571" aria-hidden="true" tabindex="-1"></a><span class="in">  # remove all GHE (up to 10,000 EAV added back to base per PIN), </span></span>
<span id="cb18-572"><a href="#cb18-572" aria-hidden="true" tabindex="-1"></a><span class="in">  # add exe_homeowner back to taxable base</span></span>
<span id="cb18-573"><a href="#cb18-573" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(neg10_taxable_eav = Total_EAV - current_TIF_increment_EAV - current_Exempt_EAV + current_GHE,    # adds GHE exempt EAV back to taxable base and decreases tax rates</span></span>
<span id="cb18-574"><a href="#cb18-574" aria-hidden="true" tabindex="-1"></a><span class="in">         plus10_taxable_eav = Total_EAV - current_TIF_increment_EAV - current_Exempt_EAV + current_GHE - exe_plus10, # will increase tax rates</span></span>
<span id="cb18-575"><a href="#cb18-575" aria-hidden="true" tabindex="-1"></a><span class="in">         plus20_taxable_eav = Total_EAV - current_TIF_increment_EAV - current_Exempt_EAV + current_GHE - exe_plus20,</span></span>
<span id="cb18-576"><a href="#cb18-576" aria-hidden="true" tabindex="-1"></a><span class="in">         plus30_taxable_eav = Total_EAV - current_TIF_increment_EAV - current_Exempt_EAV + current_GHE - exe_plus30,</span></span>
<span id="cb18-577"><a href="#cb18-577" aria-hidden="true" tabindex="-1"></a><span class="in">         plus40_taxable_eav = Total_EAV - current_TIF_increment_EAV - current_Exempt_EAV + current_GHE - exe_plus40,</span></span>
<span id="cb18-578"><a href="#cb18-578" aria-hidden="true" tabindex="-1"></a><span class="in">         scenario_noexemptions_taxable_eav = Total_EAV - current_TIF_increment_EAV) %&gt;%</span></span>
<span id="cb18-579"><a href="#cb18-579" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb18-580"><a href="#cb18-580" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tr_neg10 = MuniLevy / neg10_taxable_eav,</span></span>
<span id="cb18-581"><a href="#cb18-581" aria-hidden="true" tabindex="-1"></a><span class="in">         tr_nochange = MuniLevy / current_nonTIF_EAV_post_exemps,</span></span>
<span id="cb18-582"><a href="#cb18-582" aria-hidden="true" tabindex="-1"></a><span class="in">         tr_plus10 = MuniLevy / plus10_taxable_eav,</span></span>
<span id="cb18-583"><a href="#cb18-583" aria-hidden="true" tabindex="-1"></a><span class="in">         tr_plus20 = MuniLevy / plus20_taxable_eav,</span></span>
<span id="cb18-584"><a href="#cb18-584" aria-hidden="true" tabindex="-1"></a><span class="in">         tr_plus30 = MuniLevy / plus30_taxable_eav,</span></span>
<span id="cb18-585"><a href="#cb18-585" aria-hidden="true" tabindex="-1"></a><span class="in">         tr_plus40 = MuniLevy / plus40_taxable_eav, </span></span>
<span id="cb18-586"><a href="#cb18-586" aria-hidden="true" tabindex="-1"></a><span class="in">         tax_rate_current = MuniLevy/current_nonTIF_EAV_post_exemps,</span></span>
<span id="cb18-587"><a href="#cb18-587" aria-hidden="true" tabindex="-1"></a><span class="in">         taxrate_noexemps = MuniLevy /(Total_EAV - current_TIF_increment_EAV  ),</span></span>
<span id="cb18-588"><a href="#cb18-588" aria-hidden="true" tabindex="-1"></a><span class="in">         taxrate_noTIFs = MuniLevy / (Total_EAV - current_Exempt_EAV),</span></span>
<span id="cb18-589"><a href="#cb18-589" aria-hidden="true" tabindex="-1"></a><span class="in">         taxrate_noTIFs_orExemps = MuniLevy / Total_EAV) %&gt;%</span></span>
<span id="cb18-590"><a href="#cb18-590" aria-hidden="true" tabindex="-1"></a><span class="in">  select(clean_name, MuniLevy, tr_neg10:taxrate_noTIFs_orExemps, everything())</span></span>
<span id="cb18-591"><a href="#cb18-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-592"><a href="#cb18-592" aria-hidden="true" tabindex="-1"></a><span class="in">scenario_taxrates &lt;- scenario_calcs %&gt;%  </span></span>
<span id="cb18-593"><a href="#cb18-593" aria-hidden="true" tabindex="-1"></a><span class="in">  select(clean_name, MuniLevy, tr_neg10:taxrate_noTIFs_orExemps) </span></span>
<span id="cb18-594"><a href="#cb18-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-595"><a href="#cb18-595" aria-hidden="true" tabindex="-1"></a><span class="in">scenario_taxrates</span></span>
<span id="cb18-596"><a href="#cb18-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-597"><a href="#cb18-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-600"><a href="#cb18-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-601"><a href="#cb18-601" aria-hidden="true" tabindex="-1"></a>munis_billchange <span class="ot">&lt;-</span> munis_ranked <span class="sc">%&gt;%</span> </span>
<span id="cb18-602"><a href="#cb18-602" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(scenario_taxrates) <span class="sc">%&gt;%</span></span>
<span id="cb18-603"><a href="#cb18-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-604"><a href="#cb18-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-605"><a href="#cb18-605" aria-hidden="true" tabindex="-1"></a>    <span class="at">eav =</span> eav_preexemptions,</span>
<span id="cb18-606"><a href="#cb18-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">exe_neg10 =</span> <span class="dv">0</span>,</span>
<span id="cb18-607"><a href="#cb18-607" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb18-608"><a href="#cb18-608" aria-hidden="true" tabindex="-1"></a>      <span class="co"># exe_0 implies no additional or removed EAV. Current tax system. </span></span>
<span id="cb18-609"><a href="#cb18-609" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_0 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">10000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb18-610"><a href="#cb18-610" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">10000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">10000</span>, <span class="dv">0</span> )),  <span class="co"># no change in current exemptions</span></span>
<span id="cb18-611"><a href="#cb18-611" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus10 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">20000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb18-612"><a href="#cb18-612" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">20000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">20000</span>, <span class="dv">0</span> )),</span>
<span id="cb18-613"><a href="#cb18-613" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus20 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">30000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb18-614"><a href="#cb18-614" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">30000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">30000</span>, <span class="dv">0</span> ) ),</span>
<span id="cb18-615"><a href="#cb18-615" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus30 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">40000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb18-616"><a href="#cb18-616" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">40000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">40000</span>, <span class="dv">0</span>) ),</span>
<span id="cb18-617"><a href="#cb18-617" aria-hidden="true" tabindex="-1"></a>         <span class="at">exe_plus40 =</span> <span class="fu">ifelse</span>(eav <span class="sc">&lt;</span> <span class="dv">50000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, eav, </span>
<span id="cb18-618"><a href="#cb18-618" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(eav<span class="sc">&gt;</span><span class="dv">50000</span> <span class="sc">&amp;</span> exe_homeowner<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">50000</span>, <span class="dv">0</span>) ),</span>
<span id="cb18-619"><a href="#cb18-619" aria-hidden="true" tabindex="-1"></a>         <span class="at">mil_home =</span> <span class="fu">ifelse</span>(av<span class="sc">*</span><span class="dv">10</span> <span class="sc">&gt;</span> <span class="dv">1000000</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-620"><a href="#cb18-620" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(,</span>
<span id="cb18-621"><a href="#cb18-621" aria-hidden="true" tabindex="-1"></a>    <span class="co"># current bill = current tax rate * portion of levy billed</span></span>
<span id="cb18-622"><a href="#cb18-622" aria-hidden="true" tabindex="-1"></a>         <span class="at">equalized_AV =</span> av_clerk<span class="sc">*</span>eq_factor,</span>
<span id="cb18-623"><a href="#cb18-623" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb18-624"><a href="#cb18-624" aria-hidden="true" tabindex="-1"></a>   <span class="co"># ## Made negative tax bills!! ## #</span></span>
<span id="cb18-625"><a href="#cb18-625" aria-hidden="true" tabindex="-1"></a>          <span class="at">bill_neg10 =</span> tr_neg10<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions<span class="sc">+</span> exe_homeowner <span class="sc">-</span>exe_neg10),</span>
<span id="cb18-626"><a href="#cb18-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-627"><a href="#cb18-627" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_current =</span> tax_code_rate<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions),</span>
<span id="cb18-628"><a href="#cb18-628" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus10 =</span>  tr_plus10<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions<span class="sc">+</span> exe_homeowner <span class="sc">-</span>exe_plus10),</span>
<span id="cb18-629"><a href="#cb18-629" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus20 =</span> tr_plus20<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions<span class="sc">+</span> exe_homeowner <span class="sc">-</span>exe_plus20),</span>
<span id="cb18-630"><a href="#cb18-630" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus30 =</span> tr_plus20<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions<span class="sc">+</span> exe_homeowner <span class="sc">-</span>exe_plus30),</span>
<span id="cb18-631"><a href="#cb18-631" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus40 =</span> tr_plus20<span class="sc">*</span>(equalized_AV<span class="sc">-</span>all_exemptions<span class="sc">+</span> exe_homeowner <span class="sc">-</span>exe_plus40),</span>
<span id="cb18-632"><a href="#cb18-632" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-633"><a href="#cb18-633" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ## make bills $1 if they had been negative.</span></span>
<span id="cb18-634"><a href="#cb18-634" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_neg10 =</span> <span class="fu">ifelse</span>(bill_neg10 <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_neg10),</span>
<span id="cb18-635"><a href="#cb18-635" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_current =</span> <span class="fu">ifelse</span>(bill_current <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_current),</span>
<span id="cb18-636"><a href="#cb18-636" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus10 =</span> <span class="fu">ifelse</span>(bill_plus10 <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_plus10),</span>
<span id="cb18-637"><a href="#cb18-637" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus20 =</span> <span class="fu">ifelse</span>(bill_plus20 <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_plus20),</span>
<span id="cb18-638"><a href="#cb18-638" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus30 =</span> <span class="fu">ifelse</span>(bill_plus30 <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_plus30),</span>
<span id="cb18-639"><a href="#cb18-639" aria-hidden="true" tabindex="-1"></a>         <span class="at">bill_plus40 =</span> <span class="fu">ifelse</span>(bill_plus40 <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, bill_plus40),</span>
<span id="cb18-640"><a href="#cb18-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-641"><a href="#cb18-641" aria-hidden="true" tabindex="-1"></a>         )<span class="sc">%&gt;%</span></span>
<span id="cb18-642"><a href="#cb18-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-643"><a href="#cb18-643" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_ghe0 =</span> <span class="fu">ifelse</span>(bill_neg10 <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb18-644"><a href="#cb18-644" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_current =</span> <span class="fu">ifelse</span>(bill_current <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb18-645"><a href="#cb18-645" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_ghe20 =</span> <span class="fu">ifelse</span>(bill_plus10 <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb18-646"><a href="#cb18-646" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_ghe30 =</span> <span class="fu">ifelse</span>(bill_plus20 <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb18-647"><a href="#cb18-647" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_ghe40 =</span> <span class="fu">ifelse</span>(bill_plus30 <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb18-648"><a href="#cb18-648" aria-hidden="true" tabindex="-1"></a>         <span class="at">zerodol_bills_ghe50 =</span> <span class="fu">ifelse</span>(bill_plus40 <span class="sc">&lt;</span> <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb18-649"><a href="#cb18-649" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-650"><a href="#cb18-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb18-651"><a href="#cb18-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name, rank, has_HO_exe) <span class="sc">%&gt;%</span> </span>
<span id="cb18-652"><a href="#cb18-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_AV =</span> <span class="fu">round</span>(<span class="fu">median</span>(av)),</span>
<span id="cb18-653"><a href="#cb18-653" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_EAV =</span> <span class="fu">round</span>(<span class="fu">median</span>(eav)),</span>
<span id="cb18-654"><a href="#cb18-654" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_neg10 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_neg10, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb18-655"><a href="#cb18-655" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_cur =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_current, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb18-656"><a href="#cb18-656" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_plus10 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_plus10, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb18-657"><a href="#cb18-657" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_plus20 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_plus20, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb18-658"><a href="#cb18-658" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_plus30 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_plus30, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb18-659"><a href="#cb18-659" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_bill_plus40 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_plus40, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb18-660"><a href="#cb18-660" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-661"><a href="#cb18-661" aria-hidden="true" tabindex="-1"></a>            <span class="at">tr_neg10 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tr_neg10<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>), </span>
<span id="cb18-662"><a href="#cb18-662" aria-hidden="true" tabindex="-1"></a>            <span class="at">cur_comp_TC_rate =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tax_code_rate<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb18-663"><a href="#cb18-663" aria-hidden="true" tabindex="-1"></a>            <span class="at">tr_plus10 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tr_plus10<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb18-664"><a href="#cb18-664" aria-hidden="true" tabindex="-1"></a>            <span class="at">tr_plus20 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tr_plus20<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb18-665"><a href="#cb18-665" aria-hidden="true" tabindex="-1"></a>            <span class="at">tr_plus30 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tr_plus30<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb18-666"><a href="#cb18-666" aria-hidden="true" tabindex="-1"></a>            <span class="at">tr_plus40 =</span> <span class="fu">round</span>(<span class="fu">mean</span>(tr_plus40<span class="sc">*</span><span class="dv">100</span>), <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb18-667"><a href="#cb18-667" aria-hidden="true" tabindex="-1"></a>            <span class="at">pincount=</span><span class="fu">n</span>(),</span>
<span id="cb18-668"><a href="#cb18-668" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_ghe0 =</span> <span class="fu">sum</span>(zerodol_bills_ghe0),           </span>
<span id="cb18-669"><a href="#cb18-669" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_current =</span> <span class="fu">sum</span>(zerodol_bills_current),</span>
<span id="cb18-670"><a href="#cb18-670" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_ghe20 =</span> <span class="fu">sum</span>(zerodol_bills_ghe20),</span>
<span id="cb18-671"><a href="#cb18-671" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_ghe30 =</span> <span class="fu">sum</span>(zerodol_bills_ghe30),</span>
<span id="cb18-672"><a href="#cb18-672" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_ghe40 =</span> <span class="fu">sum</span>(zerodol_bills_ghe40),</span>
<span id="cb18-673"><a href="#cb18-673" aria-hidden="true" tabindex="-1"></a>            <span class="at">zerodol_bills_ghe50 =</span> <span class="fu">sum</span>(zerodol_bills_ghe50),</span>
<span id="cb18-674"><a href="#cb18-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-675"><a href="#cb18-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-676"><a href="#cb18-676" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-677"><a href="#cb18-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clean_name =</span> <span class="fu">ifelse</span>(clean_name <span class="sc">==</span> <span class="st">"Hazelcrest"</span>, <span class="st">"Hazel Crest"</span>, clean_name)) <span class="sc">%&gt;%</span></span>
<span id="cb18-678"><a href="#cb18-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(has_HO_exe, rank)</span>
<span id="cb18-679"><a href="#cb18-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-680"><a href="#cb18-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-681"><a href="#cb18-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-682"><a href="#cb18-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-683"><a href="#cb18-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-684"><a href="#cb18-684" aria-hidden="true" tabindex="-1"></a>ratios <span class="ot">&lt;-</span> munis_billchange <span class="sc">%&gt;%</span> </span>
<span id="cb18-685"><a href="#cb18-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(has_HO_exe <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span>  <span class="sc">!</span><span class="fu">is.na</span>(rank)) <span class="sc">%&gt;%</span> <span class="co"># claimed exemption in 2021</span></span>
<span id="cb18-686"><a href="#cb18-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">currbill_to_AV_25 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q25"</span>, mean_bill_cur<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-687"><a href="#cb18-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">currbill_to_AV_75 =</span> <span class="fu">ifelse</span>(rank <span class="sc">==</span> <span class="st">"q75"</span>, mean_bill_cur<span class="sc">/</span>median_AV, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-688"><a href="#cb18-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span></span>
<span id="cb18-689"><a href="#cb18-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">currbill_to_AV_25 =</span> <span class="fu">max</span>(currbill_to_AV_25, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb18-690"><a href="#cb18-690" aria-hidden="true" tabindex="-1"></a>            <span class="at">currbill_to_AV_75 =</span> <span class="fu">max</span>(currbill_to_AV_75, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-691"><a href="#cb18-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">muni_ratio_25to75 =</span> currbill_to_AV_25<span class="sc">/</span>currbill_to_AV_75) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(muni_ratio_25to75 <span class="sc">&gt;</span> <span class="fl">0.01</span>)</span>
<span id="cb18-692"><a href="#cb18-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-693"><a href="#cb18-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-694"><a href="#cb18-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-695"><a href="#cb18-695" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ratios, <span class="fu">aes</span>(<span class="at">y =</span> currbill_to_AV_25, <span class="at">x =</span> currbill_to_AV_75, <span class="at">label =</span> clean_name)) <span class="sc">+</span> </span>
<span id="cb18-696"><a href="#cb18-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb18-697"><a href="#cb18-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> ratios, <span class="fu">aes</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb18-698"><a href="#cb18-698" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">data =</span> (ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> currbill_to_AV_25, <span class="at">x =</span> currbill_to_AV_75), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>, <span class="at">point.padding =</span> <span class="dv">0</span>, <span class="co"># additional padding around each point</span></span>
<span id="cb18-699"><a href="#cb18-699" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="co"># draw all line segments</span></span>
<span id="cb18-700"><a href="#cb18-700" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb18-701"><a href="#cb18-701" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> (ratios <span class="sc">%&gt;%</span> <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Park Forest"</span>, <span class="st">"Chicago"</span>, <span class="st">"Winnetka"</span>, <span class="st">"Glencoe"</span>, <span class="st">"Riverdale"</span>, <span class="st">"Dolton"</span>, <span class="st">"Markham"</span>, <span class="st">"Chicago Heights"</span>, <span class="st">"Hazel Crest"</span>, <span class="st">"Phoenix"</span>))), <span class="fu">aes</span>(<span class="at">y =</span> currbill_to_AV_25, <span class="at">x =</span> currbill_to_AV_75, <span class="at">color =</span> <span class="st">"red"</span>), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb18-702"><a href="#cb18-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-703"><a href="#cb18-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb18-704"><a href="#cb18-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>), </span>
<span id="cb18-705"><a href="#cb18-705" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>), </span>
<span id="cb18-706"><a href="#cb18-706" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>), </span>
<span id="cb18-707"><a href="#cb18-707" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb18-708"><a href="#cb18-708" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb18-709"><a href="#cb18-709" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb18-710"><a href="#cb18-710" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="cn">NA</span>) ) <span class="sc">+</span></span>
<span id="cb18-711"><a href="#cb18-711" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb18-712"><a href="#cb18-712" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">6</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb18-713"><a href="#cb18-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb18-714"><a href="#cb18-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">"Tax Burden as a Share of AV </span><span class="sc">\n</span><span class="st">(25th Percentile)"</span>, <span class="at">x=</span><span class="st">"Tax Burden as a Share of AV </span><span class="sc">\n</span><span class="st">(75th Percentile)"</span>, <span class="at">subtitle =</span> <span class="st">"Current Tax System, GHE = 10,000 EAV"</span>) <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span>
<span id="cb18-715"><a href="#cb18-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-716"><a href="#cb18-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-719"><a href="#cb18-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-720"><a href="#cb18-720" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pindistribution</span></span>
<span id="cb18-721"><a href="#cb18-721" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "**Distribution of Assessed Values: Class 2 Properties vs Single-Family Properties** There is a difference in the assessed values depending on if you use all 200 level properties or only a subset of them. All figures and tables were created for both options when writing the report as a robustness check."</span></span>
<span id="cb18-722"><a href="#cb18-722" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: 50% </span></span>
<span id="cb18-723"><a href="#cb18-723" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb18-724"><a href="#cb18-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-725"><a href="#cb18-725" aria-hidden="true" tabindex="-1"></a>cook_pins <span class="sc">%&gt;%</span></span>
<span id="cb18-726"><a href="#cb18-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(av <span class="sc">&lt;</span> <span class="dv">300000</span>) <span class="sc">%&gt;%</span> <span class="co"># just to see the histogram better</span></span>
<span id="cb18-727"><a href="#cb18-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>av)) <span class="sc">+</span></span>
<span id="cb18-728"><a href="#cb18-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>)  <span class="sc">+</span></span>
<span id="cb18-729"><a href="#cb18-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb18-730"><a href="#cb18-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook County Class 2 Residential PIN Distribution of AV"</span>, </span>
<span id="cb18-731"><a href="#cb18-731" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Assessed Value ($)"</span>, <span class="at">y=</span><span class="st">"# of Pins"</span>, </span>
<span id="cb18-732"><a href="#cb18-732" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Dropped PINs with AVs over $300,000 for better visual of histogram bins."</span>) <span class="sc">+</span></span>
<span id="cb18-733"><a href="#cb18-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb18-734"><a href="#cb18-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma)</span>
<span id="cb18-735"><a href="#cb18-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-736"><a href="#cb18-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-737"><a href="#cb18-737" aria-hidden="true" tabindex="-1"></a>singfam_pins <span class="sc">%&gt;%</span></span>
<span id="cb18-738"><a href="#cb18-738" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(av <span class="sc">&lt;</span> <span class="dv">300000</span>) <span class="sc">%&gt;%</span> <span class="co"># just to see the histogram better</span></span>
<span id="cb18-739"><a href="#cb18-739" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-740"><a href="#cb18-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>av)) <span class="sc">+</span></span>
<span id="cb18-741"><a href="#cb18-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>)  <span class="sc">+</span></span>
<span id="cb18-742"><a href="#cb18-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb18-743"><a href="#cb18-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook County Single-Family PIN Distribution of AV"</span>, </span>
<span id="cb18-744"><a href="#cb18-744" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Assessed Value ($)"</span>, <span class="at">y=</span><span class="st">"# of Pins"</span>, </span>
<span id="cb18-745"><a href="#cb18-745" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Dropped PINs with AVs over $300,000 for better visual of histogram bins."</span></span>
<span id="cb18-746"><a href="#cb18-746" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb18-747"><a href="#cb18-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>dollar)<span class="sc">+</span></span>
<span id="cb18-748"><a href="#cb18-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma)</span>
<span id="cb18-749"><a href="#cb18-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-750"><a href="#cb18-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-751"><a href="#cb18-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-752"><a href="#cb18-752" aria-hidden="true" tabindex="-1"></a><span class="fu">## What would happen if the GHE value were increased?</span></span>
<span id="cb18-753"><a href="#cb18-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-754"><a href="#cb18-754" aria-hidden="true" tabindex="-1"></a><span class="fu">### Figure 4. Effect of Changing the GHE on Progressivity</span></span>
<span id="cb18-755"><a href="#cb18-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-756"><a href="#cb18-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudies-inred-MC2props}</span></span>
<span id="cb18-757"><a href="#cb18-757" aria-hidden="true" tabindex="-1"></a><span class="in">#| layout-ncol: 3</span></span>
<span id="cb18-758"><a href="#cb18-758" aria-hidden="true" tabindex="-1"></a><span class="in">#| layout-nrow: 2</span></span>
<span id="cb18-759"><a href="#cb18-759" aria-hidden="true" tabindex="-1"></a><span class="in">#| column: page</span></span>
<span id="cb18-760"><a href="#cb18-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-761"><a href="#cb18-761" aria-hidden="true" tabindex="-1"></a><span class="in">ratios &lt;- munis_billchange %&gt;% </span></span>
<span id="cb18-762"><a href="#cb18-762" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(has_HO_exe == 1 &amp;  !is.na(rank)) %&gt;% # claimed exemption in 2021</span></span>
<span id="cb18-763"><a href="#cb18-763" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(currbill_to_AV_25 = ifelse(rank == "q25", mean_bill_neg10/median_AV, NA)) %&gt;%</span></span>
<span id="cb18-764"><a href="#cb18-764" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(currbill_to_AV_75 = ifelse(rank == "q75", mean_bill_neg10/median_AV, NA)) %&gt;% </span></span>
<span id="cb18-765"><a href="#cb18-765" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(clean_name) %&gt;%</span></span>
<span id="cb18-766"><a href="#cb18-766" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(GHE_0_bill_to_AV_25 = max(currbill_to_AV_25, na.rm=TRUE),</span></span>
<span id="cb18-767"><a href="#cb18-767" aria-hidden="true" tabindex="-1"></a><span class="in">            GHE_0_bill_to_AV_75 = max(currbill_to_AV_75, na.rm=TRUE)) %&gt;%</span></span>
<span id="cb18-768"><a href="#cb18-768" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(muni_ratio_25to75 = GHE_0_bill_to_AV_25/GHE_0_bill_to_AV_75) </span></span>
<span id="cb18-769"><a href="#cb18-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-770"><a href="#cb18-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-771"><a href="#cb18-771" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = ratios, aes(y = GHE_0_bill_to_AV_25, x = GHE_0_bill_to_AV_75, label = clean_name)) + </span></span>
<span id="cb18-772"><a href="#cb18-772" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_abline(intercept = 0, slope = 1) +</span></span>
<span id="cb18-773"><a href="#cb18-773" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(alpha = .5)) + </span></span>
<span id="cb18-774"><a href="#cb18-774" aria-hidden="true" tabindex="-1"></a><span class="in">  ggrepel::geom_label_repel(data = (ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = GHE_0_bill_to_AV_25, x = GHE_0_bill_to_AV_75, label = clean_name), size = 3)+</span></span>
<span id="cb18-775"><a href="#cb18-775" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(data = (ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = GHE_0_bill_to_AV_25, x = GHE_0_bill_to_AV_75, color = "red"), size = 2)+</span></span>
<span id="cb18-776"><a href="#cb18-776" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic() + </span></span>
<span id="cb18-777"><a href="#cb18-777" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-778"><a href="#cb18-778" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-779"><a href="#cb18-779" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none") +</span></span>
<span id="cb18-780"><a href="#cb18-780" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "GHE = $0 EAV", x = "", y = "")</span></span>
<span id="cb18-781"><a href="#cb18-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-782"><a href="#cb18-782" aria-hidden="true" tabindex="-1"></a><span class="in">ratios&lt;- munis_billchange %&gt;% </span></span>
<span id="cb18-783"><a href="#cb18-783" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(has_HO_exe == 1 &amp;  !is.na(rank)) %&gt;% # claimed exemption in 2021</span></span>
<span id="cb18-784"><a href="#cb18-784" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(currbill_to_AV_25 = ifelse(rank == "q25", mean_bill_cur/median_AV, NA)) %&gt;%</span></span>
<span id="cb18-785"><a href="#cb18-785" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(currbill_to_AV_75 = ifelse(rank == "q75", mean_bill_cur/median_AV, NA)) %&gt;% </span></span>
<span id="cb18-786"><a href="#cb18-786" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(clean_name) %&gt;%</span></span>
<span id="cb18-787"><a href="#cb18-787" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(currbill_to_AV_25 = max(currbill_to_AV_25, na.rm=TRUE),</span></span>
<span id="cb18-788"><a href="#cb18-788" aria-hidden="true" tabindex="-1"></a><span class="in">            currbill_to_AV_75 = max(currbill_to_AV_75, na.rm=TRUE)) %&gt;%</span></span>
<span id="cb18-789"><a href="#cb18-789" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(muni_ratio_25to75 = currbill_to_AV_25/currbill_to_AV_75) %&gt;% filter(muni_ratio_25to75 &gt; 0.01)</span></span>
<span id="cb18-790"><a href="#cb18-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-791"><a href="#cb18-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-792"><a href="#cb18-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-793"><a href="#cb18-793" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = ratios, aes(y = currbill_to_AV_25, x = currbill_to_AV_75, label = clean_name)) + </span></span>
<span id="cb18-794"><a href="#cb18-794" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_abline(intercept = 0, slope = 1) +</span></span>
<span id="cb18-795"><a href="#cb18-795" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = ratios, aes(alpha = .5)) + </span></span>
<span id="cb18-796"><a href="#cb18-796" aria-hidden="true" tabindex="-1"></a><span class="in">  ggrepel::geom_label_repel(data = (ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = currbill_to_AV_25, x = currbill_to_AV_75), size = 3, max.overlaps = Inf, point.padding = 0, # additional padding around each point</span></span>
<span id="cb18-797"><a href="#cb18-797" aria-hidden="true" tabindex="-1"></a><span class="in">    min.segment.length = 0, # draw all line segments</span></span>
<span id="cb18-798"><a href="#cb18-798" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb18-799"><a href="#cb18-799" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(data = (ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = currbill_to_AV_25, x = currbill_to_AV_75, color = "red"), size = 2)+</span></span>
<span id="cb18-800"><a href="#cb18-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-801"><a href="#cb18-801" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic() +</span></span>
<span id="cb18-802"><a href="#cb18-802" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-803"><a href="#cb18-803" aria-hidden="true" tabindex="-1"></a><span class="in">   scale_x_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-804"><a href="#cb18-804" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none") +</span></span>
<span id="cb18-805"><a href="#cb18-805" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "GHE = $10,000 EAV (Current)", x="", y="")</span></span>
<span id="cb18-806"><a href="#cb18-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-807"><a href="#cb18-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-808"><a href="#cb18-808" aria-hidden="true" tabindex="-1"></a><span class="in">new_ratios&lt;- munis_billchange %&gt;% </span></span>
<span id="cb18-809"><a href="#cb18-809" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(has_HO_exe == 1 &amp;  !is.na(rank)) %&gt;% # claimed exemption in 2021</span></span>
<span id="cb18-810"><a href="#cb18-810" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(newbill_to_AV_25 = ifelse(rank == "q25", mean_bill_plus10/median_AV, NA)) %&gt;%</span></span>
<span id="cb18-811"><a href="#cb18-811" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(newbill_to_AV_75 = ifelse(rank == "q75", mean_bill_plus10/median_AV, NA)) %&gt;% </span></span>
<span id="cb18-812"><a href="#cb18-812" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(clean_name) %&gt;%</span></span>
<span id="cb18-813"><a href="#cb18-813" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(newbill_to_AV_25 = max(newbill_to_AV_25, na.rm=TRUE),</span></span>
<span id="cb18-814"><a href="#cb18-814" aria-hidden="true" tabindex="-1"></a><span class="in">            newbill_to_AV_75 = max(newbill_to_AV_75, na.rm=TRUE)) %&gt;%</span></span>
<span id="cb18-815"><a href="#cb18-815" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(muni_ratio_25to75 = newbill_to_AV_25/newbill_to_AV_75) %&gt;% </span></span>
<span id="cb18-816"><a href="#cb18-816" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(muni_ratio_25to75 &gt; 0.01)</span></span>
<span id="cb18-817"><a href="#cb18-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-818"><a href="#cb18-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-819"><a href="#cb18-819" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = new_ratios, aes(y = newbill_to_AV_25, x = newbill_to_AV_75, label = clean_name)) + </span></span>
<span id="cb18-820"><a href="#cb18-820" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_abline(intercept = 0, slope = 1) +</span></span>
<span id="cb18-821"><a href="#cb18-821" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(data = new_ratios, aes(alpha = .5)) + </span></span>
<span id="cb18-822"><a href="#cb18-822" aria-hidden="true" tabindex="-1"></a><span class="in">  ggrepel::geom_label_repel(data = (new_ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = newbill_to_AV_25, x = newbill_to_AV_75), size = 3, max.overlaps = Inf, point.padding = 0, # additional padding around each point</span></span>
<span id="cb18-823"><a href="#cb18-823" aria-hidden="true" tabindex="-1"></a><span class="in">    min.segment.length = 0, # draw all line segments</span></span>
<span id="cb18-824"><a href="#cb18-824" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb18-825"><a href="#cb18-825" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(data = (new_ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = newbill_to_AV_25, x = newbill_to_AV_75, color = "red"), size = 2)+</span></span>
<span id="cb18-826"><a href="#cb18-826" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic() + </span></span>
<span id="cb18-827"><a href="#cb18-827" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-828"><a href="#cb18-828" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-829"><a href="#cb18-829" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none") + </span></span>
<span id="cb18-830"><a href="#cb18-830" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "GHE = $20,000 EAV", x= "", y="")</span></span>
<span id="cb18-831"><a href="#cb18-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-832"><a href="#cb18-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-833"><a href="#cb18-833" aria-hidden="true" tabindex="-1"></a><span class="in">new_ratios&lt;- munis_billchange %&gt;% </span></span>
<span id="cb18-834"><a href="#cb18-834" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(has_HO_exe == 1 &amp;  !is.na(rank)) %&gt;% # claimed exemption in 2021</span></span>
<span id="cb18-835"><a href="#cb18-835" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(newbill_to_AV_25 = ifelse(rank == "q25", mean_bill_plus20/median_AV, NA)) %&gt;%</span></span>
<span id="cb18-836"><a href="#cb18-836" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(newbill_to_AV_75 = ifelse(rank == "q75", mean_bill_plus20/median_AV, NA)) %&gt;% </span></span>
<span id="cb18-837"><a href="#cb18-837" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(clean_name) %&gt;%</span></span>
<span id="cb18-838"><a href="#cb18-838" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(newbill_to_AV_25 = max(newbill_to_AV_25, na.rm=TRUE),</span></span>
<span id="cb18-839"><a href="#cb18-839" aria-hidden="true" tabindex="-1"></a><span class="in">            newbill_to_AV_75 = max(newbill_to_AV_75, na.rm=TRUE)) %&gt;%</span></span>
<span id="cb18-840"><a href="#cb18-840" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(muni_ratio_25to75 = newbill_to_AV_25/newbill_to_AV_75) %&gt;% </span></span>
<span id="cb18-841"><a href="#cb18-841" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb18-842"><a href="#cb18-842" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(muni_ratio_25to75 &gt; 0.01)</span></span>
<span id="cb18-843"><a href="#cb18-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-844"><a href="#cb18-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-845"><a href="#cb18-845" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = new_ratios, aes(y = newbill_to_AV_25, x = newbill_to_AV_75, label = clean_name)) + </span></span>
<span id="cb18-846"><a href="#cb18-846" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_abline(intercept = 0, slope = 1) +</span></span>
<span id="cb18-847"><a href="#cb18-847" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(alpha = .5)) + </span></span>
<span id="cb18-848"><a href="#cb18-848" aria-hidden="true" tabindex="-1"></a><span class="in">  ggrepel::geom_label_repel(data = (new_ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = newbill_to_AV_25, x = newbill_to_AV_75), size = 3, max.overlaps = Inf, point.padding = 0, # additional padding around each point</span></span>
<span id="cb18-849"><a href="#cb18-849" aria-hidden="true" tabindex="-1"></a><span class="in">    min.segment.length = 0, # draw all line segments</span></span>
<span id="cb18-850"><a href="#cb18-850" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb18-851"><a href="#cb18-851" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(data = (new_ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = newbill_to_AV_25, x = newbill_to_AV_75, color = "red"), size = 2)+</span></span>
<span id="cb18-852"><a href="#cb18-852" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic() + </span></span>
<span id="cb18-853"><a href="#cb18-853" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-854"><a href="#cb18-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-855"><a href="#cb18-855" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-856"><a href="#cb18-856" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none") + </span></span>
<span id="cb18-857"><a href="#cb18-857" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "GHE = $30,000 EAV",</span></span>
<span id="cb18-858"><a href="#cb18-858" aria-hidden="true" tabindex="-1"></a><span class="in">                                        x = "", y = "")</span></span>
<span id="cb18-859"><a href="#cb18-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-860"><a href="#cb18-860" aria-hidden="true" tabindex="-1"></a><span class="in">new_ratios&lt;- munis_billchange %&gt;% </span></span>
<span id="cb18-861"><a href="#cb18-861" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(has_HO_exe == 1 &amp;  !is.na(rank)) %&gt;% # claimed exemption in 2021</span></span>
<span id="cb18-862"><a href="#cb18-862" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(newbill_to_AV_25 = ifelse(rank == "q25", mean_bill_plus30/median_AV, NA)) %&gt;%</span></span>
<span id="cb18-863"><a href="#cb18-863" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(newbill_to_AV_75 = ifelse(rank == "q75", mean_bill_plus30/median_AV, NA)) %&gt;% </span></span>
<span id="cb18-864"><a href="#cb18-864" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(clean_name) %&gt;%</span></span>
<span id="cb18-865"><a href="#cb18-865" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(newbill_to_AV_25 = max(newbill_to_AV_25, na.rm=TRUE),</span></span>
<span id="cb18-866"><a href="#cb18-866" aria-hidden="true" tabindex="-1"></a><span class="in">            newbill_to_AV_75 = max(newbill_to_AV_75, na.rm=TRUE)) %&gt;%</span></span>
<span id="cb18-867"><a href="#cb18-867" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(muni_ratio_25to75 = newbill_to_AV_25/newbill_to_AV_75) %&gt;% </span></span>
<span id="cb18-868"><a href="#cb18-868" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(muni_ratio_25to75 &gt; 0.01)</span></span>
<span id="cb18-869"><a href="#cb18-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-870"><a href="#cb18-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-871"><a href="#cb18-871" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = new_ratios, aes(y = newbill_to_AV_25, x = newbill_to_AV_75, label = clean_name)) + </span></span>
<span id="cb18-872"><a href="#cb18-872" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_abline(intercept = 0, slope = 1) +</span></span>
<span id="cb18-873"><a href="#cb18-873" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(alpha = .5)) + </span></span>
<span id="cb18-874"><a href="#cb18-874" aria-hidden="true" tabindex="-1"></a><span class="in">  ggrepel::geom_label_repel(data = (new_ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = newbill_to_AV_25, x = newbill_to_AV_75), size = 3, max.overlaps = Inf, point.padding = 0, # additional padding around each point</span></span>
<span id="cb18-875"><a href="#cb18-875" aria-hidden="true" tabindex="-1"></a><span class="in">    min.segment.length = 0, # draw all line segments</span></span>
<span id="cb18-876"><a href="#cb18-876" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb18-877"><a href="#cb18-877" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(data = (new_ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = newbill_to_AV_25, x = newbill_to_AV_75, color = "red"), size = 2)+</span></span>
<span id="cb18-878"><a href="#cb18-878" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic() + </span></span>
<span id="cb18-879"><a href="#cb18-879" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-880"><a href="#cb18-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-881"><a href="#cb18-881" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-882"><a href="#cb18-882" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none") + </span></span>
<span id="cb18-883"><a href="#cb18-883" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "GHE = $40,000 EAV", </span></span>
<span id="cb18-884"><a href="#cb18-884" aria-hidden="true" tabindex="-1"></a><span class="in">                                     x= "", y = "")</span></span>
<span id="cb18-885"><a href="#cb18-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-886"><a href="#cb18-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-887"><a href="#cb18-887" aria-hidden="true" tabindex="-1"></a><span class="in">new_ratios&lt;- munis_billchange %&gt;% </span></span>
<span id="cb18-888"><a href="#cb18-888" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(has_HO_exe == 1 &amp;  !is.na(rank)) %&gt;% # claimed exemption in 2021</span></span>
<span id="cb18-889"><a href="#cb18-889" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(newbill_to_AV_25 = ifelse(rank == "q25", mean_bill_plus40/median_AV, NA)) %&gt;%</span></span>
<span id="cb18-890"><a href="#cb18-890" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(newbill_to_AV_75 = ifelse(rank == "q75", mean_bill_plus40/median_AV, NA)) %&gt;% </span></span>
<span id="cb18-891"><a href="#cb18-891" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(clean_name) %&gt;%</span></span>
<span id="cb18-892"><a href="#cb18-892" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(newbill_to_AV_25 = max(newbill_to_AV_25, na.rm=TRUE),</span></span>
<span id="cb18-893"><a href="#cb18-893" aria-hidden="true" tabindex="-1"></a><span class="in">            newbill_to_AV_75 = max(newbill_to_AV_75, na.rm=TRUE)) %&gt;%</span></span>
<span id="cb18-894"><a href="#cb18-894" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(muni_ratio_25to75 = newbill_to_AV_25/newbill_to_AV_75) %&gt;% filter(muni_ratio_25to75 &gt; 0.01)</span></span>
<span id="cb18-895"><a href="#cb18-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-896"><a href="#cb18-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-897"><a href="#cb18-897" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = new_ratios, aes(y = newbill_to_AV_25, x = newbill_to_AV_75, label = clean_name)) + </span></span>
<span id="cb18-898"><a href="#cb18-898" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_abline(intercept = 0, slope = 1) +</span></span>
<span id="cb18-899"><a href="#cb18-899" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(alpha = .5)) + </span></span>
<span id="cb18-900"><a href="#cb18-900" aria-hidden="true" tabindex="-1"></a><span class="in">  ggrepel::geom_label_repel(data = (new_ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = newbill_to_AV_25, x = newbill_to_AV_75), size = 3, max.overlaps = Inf, point.padding = 0, # additional padding around each point</span></span>
<span id="cb18-901"><a href="#cb18-901" aria-hidden="true" tabindex="-1"></a><span class="in">    min.segment.length = 0, # draw all line segments</span></span>
<span id="cb18-902"><a href="#cb18-902" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb18-903"><a href="#cb18-903" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(data = (new_ratios %&gt;% filter(clean_name %in% c("Park Forest", "Chicago", "Winnetka", "Glencoe", "Riverdale", "Dolton", "Markham", "Chicago Heights", "Hazel Crest", "Phoenix"))), aes(y = newbill_to_AV_25, x = newbill_to_AV_75, color = "red"), size = 2)+</span></span>
<span id="cb18-904"><a href="#cb18-904" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic() + </span></span>
<span id="cb18-905"><a href="#cb18-905" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-906"><a href="#cb18-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-907"><a href="#cb18-907" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(limits = c(0, .6), expand = c(0,0))+</span></span>
<span id="cb18-908"><a href="#cb18-908" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none") + labs(title = "GHE = $50,000", </span></span>
<span id="cb18-909"><a href="#cb18-909" aria-hidden="true" tabindex="-1"></a><span class="in">                                      x = "", y = "")</span></span>
<span id="cb18-910"><a href="#cb18-910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-911"><a href="#cb18-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-912"><a href="#cb18-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-913"><a href="#cb18-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-914"><a href="#cb18-914" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 3. Revenue Neutral Tax Rates</span></span>
<span id="cb18-915"><a href="#cb18-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-916"><a href="#cb18-916" aria-hidden="true" tabindex="-1"></a>**Revenue Neutral Tax Rates (Percent) for Select Municipalities as a Function of GHE Value**</span>
<span id="cb18-917"><a href="#cb18-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-920"><a href="#cb18-920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-921"><a href="#cb18-921" aria-hidden="true" tabindex="-1"></a>scenario_taxrates <span class="sc">%&gt;%</span> </span>
<span id="cb18-922"><a href="#cb18-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>, <span class="st">"Dolton"</span>, <span class="st">"Glencoe"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-923"><a href="#cb18-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Municipality =</span> clean_name,</span>
<span id="cb18-924"><a href="#cb18-924" aria-hidden="true" tabindex="-1"></a>         <span class="st">"0 GHE"</span> <span class="ot">=</span> tr_neg10,</span>
<span id="cb18-925"><a href="#cb18-925" aria-hidden="true" tabindex="-1"></a>         <span class="st">"10,000 GHE (Current)"</span> <span class="ot">=</span> tr_nochange,</span>
<span id="cb18-926"><a href="#cb18-926" aria-hidden="true" tabindex="-1"></a>         <span class="st">"20,000 GHE"</span> <span class="ot">=</span> tr_plus10,</span>
<span id="cb18-927"><a href="#cb18-927" aria-hidden="true" tabindex="-1"></a>         <span class="st">"30,000 GHE"</span> <span class="ot">=</span> tr_plus20,</span>
<span id="cb18-928"><a href="#cb18-928" aria-hidden="true" tabindex="-1"></a>         <span class="st">"40,000 GHE"</span> <span class="ot">=</span> tr_plus30,</span>
<span id="cb18-929"><a href="#cb18-929" aria-hidden="true" tabindex="-1"></a>         <span class="st">"50,000 GHE"</span> <span class="ot">=</span> tr_plus40)</span>
<span id="cb18-930"><a href="#cb18-930" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-931"><a href="#cb18-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-932"><a href="#cb18-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-933"><a href="#cb18-933" aria-hidden="true" tabindex="-1"></a><span class="fu">### Figure 5. GHE Value and Revenue Neutral Tax Rates</span></span>
<span id="cb18-934"><a href="#cb18-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-935"><a href="#cb18-935" aria-hidden="true" tabindex="-1"></a>**Relationship of GHE Value and Revenue Neutral Tax Rates in Chicago, Dolton, and Glencoe**</span>
<span id="cb18-936"><a href="#cb18-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-937"><a href="#cb18-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-940"><a href="#cb18-940" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-941"><a href="#cb18-941" aria-hidden="true" tabindex="-1"></a>scenario_taxrates <span class="sc">%&gt;%</span> </span>
<span id="cb18-942"><a href="#cb18-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Chicago"</span>, <span class="st">"Dolton"</span>, <span class="st">"Glencoe"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-943"><a href="#cb18-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Municipality =</span> clean_name,</span>
<span id="cb18-944"><a href="#cb18-944" aria-hidden="true" tabindex="-1"></a>         <span class="st">"0 GHE"</span> <span class="ot">=</span> tr_neg10,</span>
<span id="cb18-945"><a href="#cb18-945" aria-hidden="true" tabindex="-1"></a>         <span class="st">"10,000 GHE</span><span class="sc">\n</span><span class="st">(Current)"</span> <span class="ot">=</span> tr_nochange,</span>
<span id="cb18-946"><a href="#cb18-946" aria-hidden="true" tabindex="-1"></a>         <span class="st">"20,000 GHE"</span> <span class="ot">=</span> tr_plus10,</span>
<span id="cb18-947"><a href="#cb18-947" aria-hidden="true" tabindex="-1"></a>         <span class="st">"30,000 GHE"</span> <span class="ot">=</span> tr_plus20,</span>
<span id="cb18-948"><a href="#cb18-948" aria-hidden="true" tabindex="-1"></a>         <span class="st">"40,000 GHE"</span> <span class="ot">=</span> tr_plus30,</span>
<span id="cb18-949"><a href="#cb18-949" aria-hidden="true" tabindex="-1"></a>         <span class="st">"50,000 GHE"</span> <span class="ot">=</span> tr_plus40) <span class="sc">%&gt;%</span></span>
<span id="cb18-950"><a href="#cb18-950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">0 GHE</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">50,000 GHE</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Scenarios"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-951"><a href="#cb18-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-952"><a href="#cb18-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-953"><a href="#cb18-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Scenarios, <span class="at">y =</span> value, <span class="at">group =</span> Municipality, <span class="at">color =</span> Municipality)) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb18-954"><a href="#cb18-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tax Rates for GHE Scenarios"</span>, <span class="at">x =</span> <span class="st">"GHE Amount"</span>, <span class="at">y =</span> <span class="st">"Tax Rate"</span>) <span class="sc">+</span></span>
<span id="cb18-955"><a href="#cb18-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>percent)</span>
<span id="cb18-956"><a href="#cb18-956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-957"><a href="#cb18-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-958"><a href="#cb18-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-959"><a href="#cb18-959" aria-hidden="true" tabindex="-1"></a><span class="fu">## Paying for the inequitable effects of exemptions</span></span>
<span id="cb18-960"><a href="#cb18-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-961"><a href="#cb18-961" aria-hidden="true" tabindex="-1"></a><span class="fu">### Figure 6. Exemptions by Value in Class 8 Municipalities</span></span>
<span id="cb18-962"><a href="#cb18-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-965"><a href="#cb18-965" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-966"><a href="#cb18-966" aria-hidden="true" tabindex="-1"></a>cook_pins <span class="sc">%&gt;%</span> </span>
<span id="cb18-967"><a href="#cb18-967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span> </span>
<span id="cb18-968"><a href="#cb18-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb18-969"><a href="#cb18-969" aria-hidden="true" tabindex="-1"></a>    <span class="at">Homeowner =</span> <span class="fu">sum</span>(exe_homeowner),</span>
<span id="cb18-970"><a href="#cb18-970" aria-hidden="true" tabindex="-1"></a>    <span class="at">Senior =</span> <span class="fu">sum</span>(exe_senior),</span>
<span id="cb18-971"><a href="#cb18-971" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Senior Freeze</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(exe_freeze),</span>
<span id="cb18-972"><a href="#cb18-972" aria-hidden="true" tabindex="-1"></a>   <span class="co"># exe_longtime_homeowner = sum(exe_longtime_homeowner),</span></span>
<span id="cb18-973"><a href="#cb18-973" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other =</span> <span class="fu">sum</span>(exe_disabled),</span>
<span id="cb18-974"><a href="#cb18-974" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-975"><a href="#cb18-975" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-976"><a href="#cb18-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Blue Island"</span>, <span class="st">"Markham"</span>, <span class="st">"Matteson"</span>, <span class="st">"Park Forest"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-977"><a href="#cb18-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Homeowner<span class="sc">:</span>Other), <span class="at">names_to =</span> <span class="st">"Exemption Type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-978"><a href="#cb18-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb18-979"><a href="#cb18-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>clean_name, <span class="at">y =</span> value, <span class="at">fill =</span> <span class="st">`</span><span class="at">Exemption Type</span><span class="st">`</span>), <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb18-980"><a href="#cb18-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="st">"Exempt EAV"</span>)</span>
<span id="cb18-981"><a href="#cb18-981" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb18-982"><a href="#cb18-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-983"><a href="#cb18-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-984"><a href="#cb18-984" aria-hidden="true" tabindex="-1"></a><span class="fu">### Figure 7. Exemption Share in Class 8 Municipalities</span></span>
<span id="cb18-985"><a href="#cb18-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-988"><a href="#cb18-988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb18-989"><a href="#cb18-989" aria-hidden="true" tabindex="-1"></a>cook_pins <span class="sc">%&gt;%</span> </span>
<span id="cb18-990"><a href="#cb18-990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clean_name) <span class="sc">%&gt;%</span> </span>
<span id="cb18-991"><a href="#cb18-991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb18-992"><a href="#cb18-992" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_exemptions =</span> <span class="fu">sum</span>(all_exemptions),</span>
<span id="cb18-993"><a href="#cb18-993" aria-hidden="true" tabindex="-1"></a>    <span class="at">eq_av =</span> <span class="fu">sum</span>(av_clerk<span class="sc">*</span>eq_factor),</span>
<span id="cb18-994"><a href="#cb18-994" aria-hidden="true" tabindex="-1"></a>    <span class="at">tif_increment_eav =</span> <span class="fu">sum</span>(tif_increment_eav)</span>
<span id="cb18-995"><a href="#cb18-995" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-996"><a href="#cb18-996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">taxable_eav =</span> eq_av <span class="sc">-</span> tif_increment_eav <span class="sc">-</span> all_exemptions) <span class="sc">|&gt;</span></span>
<span id="cb18-997"><a href="#cb18-997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clean_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Blue Island"</span>, <span class="st">"Markham"</span>, <span class="st">"Matteson"</span>, <span class="st">"Park Forest"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-998"><a href="#cb18-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(all_exemptions<span class="sc">:</span>taxable_eav), <span class="at">names_to =</span> <span class="st">"exe_type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-999"><a href="#cb18-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(exe_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"taxable_eav"</span>, <span class="st">"all_exemptions"</span>))<span class="sc">|&gt;</span></span>
<span id="cb18-1000"><a href="#cb18-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb18-1001"><a href="#cb18-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>clean_name, <span class="at">y =</span> value, <span class="at">fill =</span> exe_type), <span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb18-1002"><a href="#cb18-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span> </span>
<span id="cb18-1003"><a href="#cb18-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb18-1004"><a href="#cb18-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="at">y =</span> <span class="st">"Non-TIF Increment EAV in Municipality"</span>)</span>
<span id="cb18-1005"><a href="#cb18-1005" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>